<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module     : Data.Ini.Config
Copyright  : (c) Getty Ritter, 2017
License    : BSD
Maintainer : Getty Ritter &lt;config-ini@infinitenegativeutility.com&gt;
Stability  : experimental

The 'config-ini' library exports some simple monadic functions to
make parsing INI-like configuration easier. INI files have a
two-level structure: the top-level named chunks of configuration,
and the individual key-value pairs contained within those chunks.
For example, the following INI file has two sections, @NETWORK@
and @LOCAL@, and each contains its own key-value pairs. Comments,
which begin with @#@ or @;@, are ignored:

&gt; [NETWORK]
&gt; host = example.com
&gt; port = 7878
&gt;
&gt; # here is a comment
&gt; [LOCAL]
&gt; user = terry

The combinators provided here are designed to write quick and
idiomatic parsers for files of this form. Sections are parsed by
'IniParser' computations, like 'section' and its variations,
while the fields within sections are parsed by 'SectionParser'
computations, like 'field' and its variations. If we want to
parse an INI file like the one above, treating the entire
@LOCAL@ section as optional, we can write it like this:

&gt; data Config = Config
&gt;   { cfNetwork :: NetworkConfig, cfLocal :: Maybe LocalConfig }
&gt;     deriving (Eq, Show)
&gt;
&gt; data NetworkConfig = NetworkConfig
&gt;   { netHost :: String, netPort :: Int }
&gt;     deriving (Eq, Show)
&gt;
&gt; data LocalConfig = LocalConfig
&gt;   { localUser :: Text }
&gt;     deriving (Eq, Show)
&gt;
&gt; configParser :: IniParser Config
&gt; configParser = do
&gt;   netCf &lt;- section &quot;NETWORK&quot; $ do
&gt;     host &lt;- fieldOf &quot;host&quot; string
&gt;     port &lt;- fieldOf &quot;port&quot; number
&gt;     return NetworkConfig { netHost = host, netPort = port }
&gt;   locCf &lt;- sectionMb &quot;LOCAL&quot; $
&gt;     LocalConfig &lt;$&gt; field &quot;user&quot;
&gt;   return Config { cfNetwork = netCf, cfLocal = locCf }


We can run our computation with 'parseIniFile', which,
when run on our example file above, would produce the
following:

&gt;&gt;&gt; parseIniFile example configParser
Right (Config {cfNetwork = NetworkConfig {netHost = &quot;example.com&quot;, netPort = 7878}, cfLocal = Just (LocalConfig {localUser = &quot;terry&quot;})})

-}</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-65"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-66"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Ini.Config</span><span>
</span><span id="line-69"></span><span class="hs-special">(</span><span>
</span><span id="line-70"></span><span class="annot"><span class="hs-comment">-- * Parsing Files</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="Data.Ini.Config.html#parseIniFile"><span class="hs-identifier">parseIniFile</span></a></span><span>
</span><span id="line-72"></span><span class="annot"><span class="hs-comment">-- * Parser Types</span></span><span>
</span><span id="line-73"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier">IniParser</span></a></span><span>
</span><span id="line-74"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier">SectionParser</span></a></span><span>
</span><span id="line-75"></span><span class="annot"><span class="hs-comment">-- * Section-Level Parsing</span></span><span>
</span><span id="line-76"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#section"><span class="hs-identifier">section</span></a></span><span>
</span><span id="line-77"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#sections"><span class="hs-identifier">sections</span></a></span><span>
</span><span id="line-78"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#sectionOf"><span class="hs-identifier">sectionOf</span></a></span><span>
</span><span id="line-79"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#sectionsOf"><span class="hs-identifier">sectionsOf</span></a></span><span>
</span><span id="line-80"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#sectionMb"><span class="hs-identifier">sectionMb</span></a></span><span>
</span><span id="line-81"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#sectionDef"><span class="hs-identifier">sectionDef</span></a></span><span>
</span><span id="line-82"></span><span class="annot"><span class="hs-comment">-- * Field-Level Parsing</span></span><span>
</span><span id="line-83"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#field"><span class="hs-identifier">field</span></a></span><span>
</span><span id="line-84"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#fieldOf"><span class="hs-identifier">fieldOf</span></a></span><span>
</span><span id="line-85"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#fieldMb"><span class="hs-identifier">fieldMb</span></a></span><span>
</span><span id="line-86"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#fieldMbOf"><span class="hs-identifier">fieldMbOf</span></a></span><span>
</span><span id="line-87"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#fieldDef"><span class="hs-identifier">fieldDef</span></a></span><span>
</span><span id="line-88"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#fieldDefOf"><span class="hs-identifier">fieldDefOf</span></a></span><span>
</span><span id="line-89"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#fieldFlag"><span class="hs-identifier">fieldFlag</span></a></span><span>
</span><span id="line-90"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#fieldFlagDef"><span class="hs-identifier">fieldFlagDef</span></a></span><span>
</span><span id="line-91"></span><span class="annot"><span class="hs-comment">-- * Reader Functions</span></span><span>
</span><span id="line-92"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#readable"><span class="hs-identifier">readable</span></a></span><span>
</span><span id="line-93"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#number"><span class="hs-identifier">number</span></a></span><span>
</span><span id="line-94"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#string"><span class="hs-identifier">string</span></a></span><span>
</span><span id="line-95"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#flag"><span class="hs-identifier">flag</span></a></span><span>
</span><span id="line-96"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#listWithSeparator"><span class="hs-identifier">listWithSeparator</span></a></span><span>
</span><span id="line-97"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Alternative</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Ini.Config.Raw.html"><span class="hs-identifier">Data.Ini.Config.Raw</span></a></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">typeRep</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsList</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679055360"><span class="annot"><a href="Data.Ini.Config.html#lkp"><span class="hs-identifier hs-type">lkp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679055360"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679055360"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-112"></span><span id="lkp"><span class="annot"><span class="annottext">lkp :: NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.html#lkp"><span class="hs-identifier hs-var hs-var">lkp</span></a></span></span><span> </span><span id="local-6989586621679055289"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055289"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, a) -&gt; Maybe a
forall a. ViewL (NormalizedText, a) -&gt; Maybe a
</span><a href="#local-6989586621679055288"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(ViewL (NormalizedText, a) -&gt; Maybe a)
-&gt; (Seq (NormalizedText, a) -&gt; ViewL (NormalizedText, a))
-&gt; Seq (NormalizedText, a)
-&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, a) -&gt; ViewL (NormalizedText, a)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679055288"><span class="annot"><span class="annottext">go :: ViewL (NormalizedText, a) -&gt; Maybe a
</span><a href="#local-6989586621679055288"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679055285"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055285"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055284"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055284"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">Seq.:&lt;</span></span><span> </span><span id="local-6989586621679055282"><span class="annot"><span class="annottext">Seq (NormalizedText, a)
</span><a href="#local-6989586621679055282"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055289"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; NormalizedText -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055285"><span class="hs-identifier hs-var">t'</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055284"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-115"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, a) -&gt; Maybe a
</span><a href="#local-6989586621679055288"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, a) -&gt; ViewL (NormalizedText, a)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, a)
</span><a href="#local-6989586621679055282"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="#local-6989586621679055288"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, a)
</span><span class="hs-identifier hs-var">Seq.EmptyL</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span id="local-6989586621679055333"><span id="local-6989586621679055334"><span class="annot"><a href="Data.Ini.Config.html#addLineInformation"><span class="hs-identifier hs-type">addLineInformation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055334"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055334"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055333"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-119"></span><span id="addLineInformation"><span class="annot"><span class="annottext">addLineInformation :: Int -&gt; Text -&gt; StParser s a -&gt; StParser s a
</span><a href="Data.Ini.Config.html#addLineInformation"><span class="hs-identifier hs-var hs-var">addLineInformation</span></a></span></span><span> </span><span id="local-6989586621679055279"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055279"><span class="hs-identifier hs-var">lineNo</span></a></span></span><span> </span><span id="local-6989586621679055278"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055278"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; StParser s a -&gt; StParser s a
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><span class="hs-identifier hs-var">withExceptT</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621679055276"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679055276"><span class="annot"><span class="annottext">go :: [Char] -&gt; [Char]
</span><a href="#local-6989586621679055276"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679055275"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055275"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Line &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055279"><span class="hs-identifier hs-var">lineNo</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-121"></span><span>               </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, in section &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055278"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-122"></span><span>               </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055275"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">type</span><span> </span><span id="StParser"><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-var">StParser</span></a></span></span><span> </span><span id="local-6989586621679055273"><span class="annot"><a href="#local-6989586621679055273"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679055272"><span class="annot"><a href="#local-6989586621679055272"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679055273"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679055272"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | An 'IniParser' value represents a computation for parsing entire</span><span>
</span><span id="line-127"></span><span class="hs-comment">--   INI-format files.</span><span>
</span><span id="line-128"></span><span class="hs-keyword">newtype</span><span> </span><span id="IniParser"><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-var">IniParser</span></a></span></span><span> </span><span id="local-6989586621679055367"><span class="annot"><a href="#local-6989586621679055367"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IniParser"><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-var">IniParser</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055367"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679055266"><span id="local-6989586621679055268"><span class="annot"><span class="annottext">a -&gt; IniParser b -&gt; IniParser a
(a -&gt; b) -&gt; IniParser a -&gt; IniParser b
(forall a b. (a -&gt; b) -&gt; IniParser a -&gt; IniParser b)
-&gt; (forall a b. a -&gt; IniParser b -&gt; IniParser a)
-&gt; Functor IniParser
forall a b. a -&gt; IniParser b -&gt; IniParser a
forall a b. (a -&gt; b) -&gt; IniParser a -&gt; IniParser b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; IniParser b -&gt; IniParser a
$c&lt;$ :: forall a b. a -&gt; IniParser b -&gt; IniParser a
fmap :: (a -&gt; b) -&gt; IniParser a -&gt; IniParser b
$cfmap :: forall a b. (a -&gt; b) -&gt; IniParser a -&gt; IniParser b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055254"><span id="local-6989586621679055256"><span id="local-6989586621679055258"><span id="local-6989586621679055260"><span id="local-6989586621679055262"><span class="annot"><span class="annottext">Functor IniParser
a -&gt; IniParser a
Functor IniParser
-&gt; (forall a. a -&gt; IniParser a)
-&gt; (forall a b. IniParser (a -&gt; b) -&gt; IniParser a -&gt; IniParser b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; IniParser a -&gt; IniParser b -&gt; IniParser c)
-&gt; (forall a b. IniParser a -&gt; IniParser b -&gt; IniParser b)
-&gt; (forall a b. IniParser a -&gt; IniParser b -&gt; IniParser a)
-&gt; Applicative IniParser
IniParser a -&gt; IniParser b -&gt; IniParser b
IniParser a -&gt; IniParser b -&gt; IniParser a
IniParser (a -&gt; b) -&gt; IniParser a -&gt; IniParser b
(a -&gt; b -&gt; c) -&gt; IniParser a -&gt; IniParser b -&gt; IniParser c
forall a. a -&gt; IniParser a
forall a b. IniParser a -&gt; IniParser b -&gt; IniParser a
forall a b. IniParser a -&gt; IniParser b -&gt; IniParser b
forall a b. IniParser (a -&gt; b) -&gt; IniParser a -&gt; IniParser b
forall a b c.
(a -&gt; b -&gt; c) -&gt; IniParser a -&gt; IniParser b -&gt; IniParser c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: IniParser a -&gt; IniParser b -&gt; IniParser a
$c&lt;* :: forall a b. IniParser a -&gt; IniParser b -&gt; IniParser a
*&gt; :: IniParser a -&gt; IniParser b -&gt; IniParser b
$c*&gt; :: forall a b. IniParser a -&gt; IniParser b -&gt; IniParser b
liftA2 :: (a -&gt; b -&gt; c) -&gt; IniParser a -&gt; IniParser b -&gt; IniParser c
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; IniParser a -&gt; IniParser b -&gt; IniParser c
&lt;*&gt; :: IniParser (a -&gt; b) -&gt; IniParser a -&gt; IniParser b
$c&lt;*&gt; :: forall a b. IniParser (a -&gt; b) -&gt; IniParser a -&gt; IniParser b
pure :: a -&gt; IniParser a
$cpure :: forall a. a -&gt; IniParser a
$cp1Applicative :: Functor IniParser
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055244"><span id="local-6989586621679055246"><span id="local-6989586621679055248"><span id="local-6989586621679055250"><span class="annot"><span class="annottext">Applicative IniParser
IniParser a
Applicative IniParser
-&gt; (forall a. IniParser a)
-&gt; (forall a. IniParser a -&gt; IniParser a -&gt; IniParser a)
-&gt; (forall a. IniParser a -&gt; IniParser [a])
-&gt; (forall a. IniParser a -&gt; IniParser [a])
-&gt; Alternative IniParser
IniParser a -&gt; IniParser a -&gt; IniParser a
IniParser a -&gt; IniParser [a]
IniParser a -&gt; IniParser [a]
forall a. IniParser a
forall a. IniParser a -&gt; IniParser [a]
forall a. IniParser a -&gt; IniParser a -&gt; IniParser a
forall (f :: * -&gt; *).
Applicative f
-&gt; (forall a. f a)
-&gt; (forall a. f a -&gt; f a -&gt; f a)
-&gt; (forall a. f a -&gt; f [a])
-&gt; (forall a. f a -&gt; f [a])
-&gt; Alternative f
many :: IniParser a -&gt; IniParser [a]
$cmany :: forall a. IniParser a -&gt; IniParser [a]
some :: IniParser a -&gt; IniParser [a]
$csome :: forall a. IniParser a -&gt; IniParser [a]
&lt;|&gt; :: IniParser a -&gt; IniParser a -&gt; IniParser a
$c&lt;|&gt; :: forall a. IniParser a -&gt; IniParser a -&gt; IniParser a
empty :: IniParser a
$cempty :: forall a. IniParser a
$cp1Alternative :: Applicative IniParser
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Alternative</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055236"><span id="local-6989586621679055238"><span id="local-6989586621679055240"><span class="annot"><span class="annottext">Applicative IniParser
a -&gt; IniParser a
Applicative IniParser
-&gt; (forall a b. IniParser a -&gt; (a -&gt; IniParser b) -&gt; IniParser b)
-&gt; (forall a b. IniParser a -&gt; IniParser b -&gt; IniParser b)
-&gt; (forall a. a -&gt; IniParser a)
-&gt; Monad IniParser
IniParser a -&gt; (a -&gt; IniParser b) -&gt; IniParser b
IniParser a -&gt; IniParser b -&gt; IniParser b
forall a. a -&gt; IniParser a
forall a b. IniParser a -&gt; IniParser b -&gt; IniParser b
forall a b. IniParser a -&gt; (a -&gt; IniParser b) -&gt; IniParser b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; IniParser a
$creturn :: forall a. a -&gt; IniParser a
&gt;&gt; :: IniParser a -&gt; IniParser b -&gt; IniParser b
$c&gt;&gt; :: forall a b. IniParser a -&gt; IniParser b -&gt; IniParser b
&gt;&gt;= :: IniParser a -&gt; (a -&gt; IniParser b) -&gt; IniParser b
$c&gt;&gt;= :: forall a b. IniParser a -&gt; (a -&gt; IniParser b) -&gt; IniParser b
$cp1Monad :: Applicative IniParser
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | A 'SectionParser' value represents a computation for parsing a single</span><span>
</span><span id="line-132"></span><span class="hs-comment">--   section of an INI-format file.</span><span>
</span><span id="line-133"></span><span class="hs-keyword">newtype</span><span> </span><span id="SectionParser"><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-var">SectionParser</span></a></span></span><span> </span><span id="local-6989586621679055336"><span class="annot"><a href="#local-6989586621679055336"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SectionParser"><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-var">SectionParser</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055336"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679055230"><span id="local-6989586621679055232"><span class="annot"><span class="annottext">a -&gt; SectionParser b -&gt; SectionParser a
(a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b
(forall a b. (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b)
-&gt; (forall a b. a -&gt; SectionParser b -&gt; SectionParser a)
-&gt; Functor SectionParser
forall a b. a -&gt; SectionParser b -&gt; SectionParser a
forall a b. (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; SectionParser b -&gt; SectionParser a
$c&lt;$ :: forall a b. a -&gt; SectionParser b -&gt; SectionParser a
fmap :: (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b
$cfmap :: forall a b. (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055219"><span id="local-6989586621679055221"><span id="local-6989586621679055223"><span id="local-6989586621679055225"><span id="local-6989586621679055227"><span class="annot"><span class="annottext">Functor SectionParser
a -&gt; SectionParser a
Functor SectionParser
-&gt; (forall a. a -&gt; SectionParser a)
-&gt; (forall a b.
    SectionParser (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; SectionParser a -&gt; SectionParser b -&gt; SectionParser c)
-&gt; (forall a b.
    SectionParser a -&gt; SectionParser b -&gt; SectionParser b)
-&gt; (forall a b.
    SectionParser a -&gt; SectionParser b -&gt; SectionParser a)
-&gt; Applicative SectionParser
SectionParser a -&gt; SectionParser b -&gt; SectionParser b
SectionParser a -&gt; SectionParser b -&gt; SectionParser a
SectionParser (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b
(a -&gt; b -&gt; c)
-&gt; SectionParser a -&gt; SectionParser b -&gt; SectionParser c
forall a. a -&gt; SectionParser a
forall a b. SectionParser a -&gt; SectionParser b -&gt; SectionParser a
forall a b. SectionParser a -&gt; SectionParser b -&gt; SectionParser b
forall a b.
SectionParser (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; SectionParser a -&gt; SectionParser b -&gt; SectionParser c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: SectionParser a -&gt; SectionParser b -&gt; SectionParser a
$c&lt;* :: forall a b. SectionParser a -&gt; SectionParser b -&gt; SectionParser a
*&gt; :: SectionParser a -&gt; SectionParser b -&gt; SectionParser b
$c*&gt; :: forall a b. SectionParser a -&gt; SectionParser b -&gt; SectionParser b
liftA2 :: (a -&gt; b -&gt; c)
-&gt; SectionParser a -&gt; SectionParser b -&gt; SectionParser c
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c)
-&gt; SectionParser a -&gt; SectionParser b -&gt; SectionParser c
&lt;*&gt; :: SectionParser (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b
$c&lt;*&gt; :: forall a b.
SectionParser (a -&gt; b) -&gt; SectionParser a -&gt; SectionParser b
pure :: a -&gt; SectionParser a
$cpure :: forall a. a -&gt; SectionParser a
$cp1Applicative :: Functor SectionParser
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055210"><span id="local-6989586621679055212"><span id="local-6989586621679055214"><span id="local-6989586621679055216"><span class="annot"><span class="annottext">Applicative SectionParser
SectionParser a
Applicative SectionParser
-&gt; (forall a. SectionParser a)
-&gt; (forall a.
    SectionParser a -&gt; SectionParser a -&gt; SectionParser a)
-&gt; (forall a. SectionParser a -&gt; SectionParser [a])
-&gt; (forall a. SectionParser a -&gt; SectionParser [a])
-&gt; Alternative SectionParser
SectionParser a -&gt; SectionParser a -&gt; SectionParser a
SectionParser a -&gt; SectionParser [a]
SectionParser a -&gt; SectionParser [a]
forall a. SectionParser a
forall a. SectionParser a -&gt; SectionParser [a]
forall a. SectionParser a -&gt; SectionParser a -&gt; SectionParser a
forall (f :: * -&gt; *).
Applicative f
-&gt; (forall a. f a)
-&gt; (forall a. f a -&gt; f a -&gt; f a)
-&gt; (forall a. f a -&gt; f [a])
-&gt; (forall a. f a -&gt; f [a])
-&gt; Alternative f
many :: SectionParser a -&gt; SectionParser [a]
$cmany :: forall a. SectionParser a -&gt; SectionParser [a]
some :: SectionParser a -&gt; SectionParser [a]
$csome :: forall a. SectionParser a -&gt; SectionParser [a]
&lt;|&gt; :: SectionParser a -&gt; SectionParser a -&gt; SectionParser a
$c&lt;|&gt; :: forall a. SectionParser a -&gt; SectionParser a -&gt; SectionParser a
empty :: SectionParser a
$cempty :: forall a. SectionParser a
$cp1Alternative :: Applicative SectionParser
</span><a href="#local-6989586621679055210"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Alternative</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055203"><span id="local-6989586621679055205"><span id="local-6989586621679055207"><span class="annot"><span class="annottext">Applicative SectionParser
a -&gt; SectionParser a
Applicative SectionParser
-&gt; (forall a b.
    SectionParser a -&gt; (a -&gt; SectionParser b) -&gt; SectionParser b)
-&gt; (forall a b.
    SectionParser a -&gt; SectionParser b -&gt; SectionParser b)
-&gt; (forall a. a -&gt; SectionParser a)
-&gt; Monad SectionParser
SectionParser a -&gt; (a -&gt; SectionParser b) -&gt; SectionParser b
SectionParser a -&gt; SectionParser b -&gt; SectionParser b
forall a. a -&gt; SectionParser a
forall a b. SectionParser a -&gt; SectionParser b -&gt; SectionParser b
forall a b.
SectionParser a -&gt; (a -&gt; SectionParser b) -&gt; SectionParser b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; SectionParser a
$creturn :: forall a. a -&gt; SectionParser a
&gt;&gt; :: SectionParser a -&gt; SectionParser b -&gt; SectionParser b
$c&gt;&gt; :: forall a b. SectionParser a -&gt; SectionParser b -&gt; SectionParser b
&gt;&gt;= :: SectionParser a -&gt; (a -&gt; SectionParser b) -&gt; SectionParser b
$c&gt;&gt;= :: forall a b.
SectionParser a -&gt; (a -&gt; SectionParser b) -&gt; SectionParser b
$cp1Monad :: Applicative SectionParser
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Parse a 'Text' value as an INI file and run an 'IniParser' over it</span><span>
</span><span id="line-137"></span><span id="local-6989586621679055202"><span class="annot"><a href="Data.Ini.Config.html#parseIniFile"><span class="hs-identifier hs-type">parseIniFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-type">IniParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055202"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679055202"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-138"></span><span id="parseIniFile"><span class="annot"><span class="annottext">parseIniFile :: Text -&gt; IniParser a -&gt; Either [Char] a
</span><a href="Data.Ini.Config.html#parseIniFile"><span class="hs-identifier hs-var hs-var">parseIniFile</span></a></span></span><span> </span><span id="local-6989586621679055201"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055201"><span class="hs-identifier hs-var">text</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-type">IniParser</span></a></span><span> </span><span id="local-6989586621679055200"><span class="annot"><span class="annottext">StParser RawIni a
</span><a href="#local-6989586621679055200"><span class="hs-identifier hs-var">mote</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621679055199"><span class="annot"><span class="annottext">RawIni
</span><a href="#local-6989586621679055199"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] RawIni
</span><a href="Data.Ini.Config.Raw.html#parseRawIni"><span class="hs-identifier hs-var">parseRawIni</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055201"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">StParser RawIni a -&gt; RawIni -&gt; Either [Char] a
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">StParser RawIni a
</span><a href="#local-6989586621679055200"><span class="hs-identifier hs-var">mote</span></a></span><span> </span><span class="annot"><span class="annottext">RawIni
</span><a href="#local-6989586621679055199"><span class="hs-identifier hs-var">ini</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Find a named section in the INI file and parse it with the provided</span><span>
</span><span id="line-143"></span><span class="hs-comment">--   section parser, failing if the section does not exist. In order to</span><span>
</span><span id="line-144"></span><span class="hs-comment">--   support classic INI files with capitalized section names, section</span><span>
</span><span id="line-145"></span><span class="hs-comment">--   lookup is __case-insensitive__.</span><span>
</span><span id="line-146"></span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[ONE]\nx = hello\n&quot; $ section &quot;ONE&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-148"></span><span class="hs-comment">--   Right &quot;hello&quot;</span><span>
</span><span id="line-149"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[ONE]\nx = hello\n&quot; $ section &quot;TWO&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-150"></span><span class="hs-comment">--   Left &quot;No top-level section named \&quot;TWO\&quot;&quot;</span><span>
</span><span id="line-151"></span><span id="local-6989586621679055196"><span class="annot"><a href="Data.Ini.Config.html#section"><span class="hs-identifier hs-type">section</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055196"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-type">IniParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055196"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-152"></span><span id="section"><span class="annot"><span class="annottext">section :: Text -&gt; SectionParser a -&gt; IniParser a
</span><a href="Data.Ini.Config.html#section"><span class="hs-identifier hs-var hs-var">section</span></a></span></span><span> </span><span id="local-6989586621679055195"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055195"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span id="local-6989586621679055194"><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055194"><span class="hs-identifier hs-var">thunk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser RawIni a -&gt; IniParser a
forall a. StParser RawIni a -&gt; IniParser a
</span><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-var">IniParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser RawIni a -&gt; IniParser a)
-&gt; StParser RawIni a -&gt; IniParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a)
-&gt; (RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span id="local-6989586621679055191"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055191"><span class="hs-identifier hs-var">ini</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NormalizedText
-&gt; Seq (NormalizedText, IniSection) -&gt; Maybe IniSection
forall a. NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.html#lkp"><span class="hs-identifier hs-var">lkp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NormalizedText
</span><a href="Data.Ini.Config.Raw.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055195"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055191"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">Maybe IniSection
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No top-level section named &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055195"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055189"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055189"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StParser IniSection a -&gt; IniSection -&gt; Either [Char] a
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055194"><span class="hs-identifier hs-var">thunk</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055189"><span class="hs-identifier hs-var">sec</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Find multiple named sections in the INI file and parse them all</span><span>
</span><span id="line-158"></span><span class="hs-comment">--   with the provided section parser. In order to support classic INI</span><span>
</span><span id="line-159"></span><span class="hs-comment">--   files with capitalized section names, section lookup is</span><span>
</span><span id="line-160"></span><span class="hs-comment">--   __case-insensitive__.</span><span>
</span><span id="line-161"></span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[ONE]\nx = hello\n[ONE]\nx = goodbye\n&quot; $ sections &quot;ONE&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-163"></span><span class="hs-comment">--   Right (fromList [&quot;hello&quot;,&quot;goodbye&quot;])</span><span>
</span><span id="line-164"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[ONE]\nx = hello\n&quot; $ sections &quot;TWO&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-165"></span><span class="hs-comment">--   Right (fromList [])</span><span>
</span><span id="line-166"></span><span id="local-6989586621679055188"><span class="annot"><a href="Data.Ini.Config.html#sections"><span class="hs-identifier hs-type">sections</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055188"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-type">IniParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679055188"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-167"></span><span id="sections"><span class="annot"><span class="annottext">sections :: Text -&gt; SectionParser a -&gt; IniParser (Seq a)
</span><a href="Data.Ini.Config.html#sections"><span class="hs-identifier hs-var hs-var">sections</span></a></span></span><span> </span><span id="local-6989586621679055187"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055187"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span id="local-6989586621679055186"><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055186"><span class="hs-identifier hs-var">thunk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser RawIni (Seq a) -&gt; IniParser (Seq a)
forall a. StParser RawIni a -&gt; IniParser a
</span><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-var">IniParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser RawIni (Seq a) -&gt; IniParser (Seq a))
-&gt; StParser RawIni (Seq a) -&gt; IniParser (Seq a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RawIni -&gt; Either [Char] (Seq a)) -&gt; StParser RawIni (Seq a)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((RawIni -&gt; Either [Char] (Seq a)) -&gt; StParser RawIni (Seq a))
-&gt; (RawIni -&gt; Either [Char] (Seq a)) -&gt; StParser RawIni (Seq a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span id="local-6989586621679055185"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055185"><span class="hs-identifier hs-var">ini</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679055184"><span class="annot"><span class="annottext">name' :: NormalizedText
</span><a href="#local-6989586621679055184"><span class="hs-identifier hs-var hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; NormalizedText
</span><a href="Data.Ini.Config.Raw.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055187"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">((NormalizedText, IniSection) -&gt; Either [Char] a)
-&gt; Seq (NormalizedText, IniSection) -&gt; Either [Char] (Seq a)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StParser IniSection a -&gt; IniSection -&gt; Either [Char] a
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055186"><span class="hs-identifier hs-var">thunk</span></a></span><span> </span><span class="annot"><span class="annottext">(IniSection -&gt; Either [Char] a)
-&gt; ((NormalizedText, IniSection) -&gt; IniSection)
-&gt; (NormalizedText, IniSection)
-&gt; Either [Char] a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniSection) -&gt; IniSection
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((NormalizedText, IniSection) -&gt; Bool)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Seq (NormalizedText, IniSection)
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679055181"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055181"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniSection
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055181"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; NormalizedText -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055184"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055185"><span class="hs-identifier hs-var">ini</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | A call to @sectionOf f@ will apply @f@ to each section name and,</span><span>
</span><span id="line-173"></span><span class="hs-comment">--   if @f@ produces a &quot;Just&quot; value, pass the extracted value in order</span><span>
</span><span id="line-174"></span><span class="hs-comment">--   to get the &quot;SectionParser&quot; to use for that section. This will</span><span>
</span><span id="line-175"></span><span class="hs-comment">--   find at most one section, and will produce an error if no section</span><span>
</span><span id="line-176"></span><span class="hs-comment">--   exists.</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[FOO]\nx = hello\n&quot; $ sectionOf (T.stripSuffix &quot;OO&quot;) (\ l -&gt; fmap ((,) l) (field &quot;x&quot;))</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   Right (&quot;F&quot;,&quot;hello&quot;)</span><span>
</span><span id="line-180"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[BAR]\nx = hello\n&quot; $ sectionOf (T.stripSuffix &quot;OO&quot;) (\ l -&gt; fmap ((,) l) (field &quot;x&quot;))</span><span>
</span><span id="line-181"></span><span class="hs-comment">--   Left &quot;No matching top-level section&quot;</span><span>
</span><span id="line-182"></span><span id="local-6989586621679055179"><span id="local-6989586621679055180"><span class="annot"><a href="Data.Ini.Config.html#sectionOf"><span class="hs-identifier hs-type">sectionOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679055180"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679055180"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055179"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-type">IniParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055179"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-183"></span><span id="sectionOf"><span class="annot"><span class="annottext">sectionOf :: (Text -&gt; Maybe b) -&gt; (b -&gt; SectionParser a) -&gt; IniParser a
</span><a href="Data.Ini.Config.html#sectionOf"><span class="hs-identifier hs-var hs-var">sectionOf</span></a></span></span><span> </span><span id="local-6989586621679055178"><span class="annot"><span class="annottext">Text -&gt; Maybe b
</span><a href="#local-6989586621679055178"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679055177"><span class="annot"><span class="annottext">b -&gt; SectionParser a
</span><a href="#local-6989586621679055177"><span class="hs-identifier hs-var">sectionParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser RawIni a -&gt; IniParser a
forall a. StParser RawIni a -&gt; IniParser a
</span><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-var">IniParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser RawIni a -&gt; IniParser a)
-&gt; StParser RawIni a -&gt; IniParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a)
-&gt; (RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span id="local-6989586621679055176"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055176"><span class="hs-identifier hs-var">ini</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679055175"><span class="annot"><span class="annottext">go :: ViewL (NormalizedText, IniSection) -&gt; Either [Char] a
</span><a href="#local-6989586621679055175"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniSection)
</span><span class="hs-identifier hs-var">Seq.EmptyL</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No matching top-level section&quot;</span></span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><a href="#local-6989586621679055175"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679055174"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055174"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055173"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055173"><span class="hs-identifier hs-var">sec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">Seq.:&lt;</span></span><span> </span><span id="local-6989586621679055172"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055172"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055171"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679055171"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe b
</span><a href="#local-6989586621679055178"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#actualText"><span class="hs-identifier hs-var hs-var">actualText</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055174"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span id="local-6989586621679055169"><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055169"><span class="hs-identifier hs-var">thunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; SectionParser a
</span><a href="#local-6989586621679055177"><span class="hs-identifier hs-var">sectionParser</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679055171"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-188"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">StParser IniSection a -&gt; IniSection -&gt; Either [Char] a
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055169"><span class="hs-identifier hs-var">thunk</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055173"><span class="hs-identifier hs-var">sec</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniSection) -&gt; Either [Char] a
</span><a href="#local-6989586621679055175"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; ViewL (NormalizedText, IniSection)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055172"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniSection) -&gt; Either [Char] a
</span><a href="#local-6989586621679055175"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; ViewL (NormalizedText, IniSection)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055176"><span class="hs-identifier hs-var">ini</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | A call to @sectionsOf f@ will apply @f@ to each section name and,</span><span>
</span><span id="line-194"></span><span class="hs-comment">--   if @f@ produces a @Just@ value, pass the extracted value in order</span><span>
</span><span id="line-195"></span><span class="hs-comment">--   to get the &quot;SectionParser&quot; to use for that section. This will</span><span>
</span><span id="line-196"></span><span class="hs-comment">--   return every section for which the call to @f@ produces a &quot;Just&quot;</span><span>
</span><span id="line-197"></span><span class="hs-comment">--   value.</span><span>
</span><span id="line-198"></span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[FOO]\nx = hello\n[BOO]\nx = goodbye\n&quot; $ sectionsOf (T.stripSuffix &quot;OO&quot;) (\ l -&gt; fmap ((,) l) (field &quot;x&quot;))</span><span>
</span><span id="line-200"></span><span class="hs-comment">--   Right (fromList [(&quot;F&quot;,&quot;hello&quot;),(&quot;B&quot;,&quot;goodbye&quot;)])</span><span>
</span><span id="line-201"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[BAR]\nx = hello\n&quot; $ sectionsOf (T.stripSuffix &quot;OO&quot;) (\ l -&gt; fmap ((,) l) (field &quot;x&quot;))</span><span>
</span><span id="line-202"></span><span class="hs-comment">--   Right (fromList [])</span><span>
</span><span id="line-203"></span><span id="local-6989586621679055167"><span id="local-6989586621679055168"><span class="annot"><a href="Data.Ini.Config.html#sectionsOf"><span class="hs-identifier hs-type">sectionsOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679055168"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679055168"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055167"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-type">IniParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679055167"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-204"></span><span id="sectionsOf"><span class="annot"><span class="annottext">sectionsOf :: (Text -&gt; Maybe b) -&gt; (b -&gt; SectionParser a) -&gt; IniParser (Seq a)
</span><a href="Data.Ini.Config.html#sectionsOf"><span class="hs-identifier hs-var hs-var">sectionsOf</span></a></span></span><span> </span><span id="local-6989586621679055166"><span class="annot"><span class="annottext">Text -&gt; Maybe b
</span><a href="#local-6989586621679055166"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679055165"><span class="annot"><span class="annottext">b -&gt; SectionParser a
</span><a href="#local-6989586621679055165"><span class="hs-identifier hs-var">sectionParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser RawIni (Seq a) -&gt; IniParser (Seq a)
forall a. StParser RawIni a -&gt; IniParser a
</span><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-var">IniParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser RawIni (Seq a) -&gt; IniParser (Seq a))
-&gt; StParser RawIni (Seq a) -&gt; IniParser (Seq a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RawIni -&gt; Either [Char] (Seq a)) -&gt; StParser RawIni (Seq a)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((RawIni -&gt; Either [Char] (Seq a)) -&gt; StParser RawIni (Seq a))
-&gt; (RawIni -&gt; Either [Char] (Seq a)) -&gt; StParser RawIni (Seq a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span id="local-6989586621679055164"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055164"><span class="hs-identifier hs-var">ini</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679055163"><span class="annot"><span class="annottext">go :: ViewL (NormalizedText, IniSection) -&gt; Either [Char] (Seq a)
</span><a href="#local-6989586621679055163"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniSection)
</span><span class="hs-identifier hs-var">Seq.EmptyL</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq a -&gt; Either [Char] (Seq a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Seq a
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-206"></span><span>      </span><span class="annot"><a href="#local-6989586621679055163"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679055161"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055161"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055160"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055160"><span class="hs-identifier hs-var">sec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">Seq.:&lt;</span></span><span> </span><span id="local-6989586621679055159"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055159"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055158"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679055158"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe b
</span><a href="#local-6989586621679055166"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#actualText"><span class="hs-identifier hs-var hs-var">actualText</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679055161"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span id="local-6989586621679055157"><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055157"><span class="hs-identifier hs-var">thunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; SectionParser a
</span><a href="#local-6989586621679055165"><span class="hs-identifier hs-var">sectionParser</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679055158"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-209"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>              </span><span id="local-6989586621679055156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055156"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StParser IniSection a -&gt; IniSection -&gt; Either [Char] a
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055157"><span class="hs-identifier hs-var">thunk</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055160"><span class="hs-identifier hs-var">sec</span></a></span><span>
</span><span id="line-211"></span><span>              </span><span id="local-6989586621679055155"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679055155"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniSection) -&gt; Either [Char] (Seq a)
</span><a href="#local-6989586621679055163"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; ViewL (NormalizedText, IniSection)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055159"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>              </span><span class="annot"><span class="annottext">Seq a -&gt; Either [Char] (Seq a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055156"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Seq a -&gt; Seq a
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">Seq.&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679055155"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniSection) -&gt; Either [Char] (Seq a)
</span><a href="#local-6989586621679055163"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; ViewL (NormalizedText, IniSection)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055159"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniSection) -&gt; Either [Char] (Seq a)
</span><a href="#local-6989586621679055163"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; ViewL (NormalizedText, IniSection)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055164"><span class="hs-identifier hs-var">ini</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Find a named section in the INI file and parse it with the provided</span><span>
</span><span id="line-217"></span><span class="hs-comment">--   section parser, returning 'Nothing' if the section does not exist.</span><span>
</span><span id="line-218"></span><span class="hs-comment">--   In order to</span><span>
</span><span id="line-219"></span><span class="hs-comment">--   support classic INI files with capitalized section names, section</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   lookup is __case-insensitive__.</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[ONE]\nx = hello\n&quot; $ sectionMb &quot;ONE&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-223"></span><span class="hs-comment">--   Right (Just &quot;hello&quot;)</span><span>
</span><span id="line-224"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[ONE]\nx = hello\n&quot; $ sectionMb &quot;TWO&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-225"></span><span class="hs-comment">--   Right Nothing</span><span>
</span><span id="line-226"></span><span id="local-6989586621679055153"><span class="annot"><a href="Data.Ini.Config.html#sectionMb"><span class="hs-identifier hs-type">sectionMb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055153"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-type">IniParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679055153"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-227"></span><span id="sectionMb"><span class="annot"><span class="annottext">sectionMb :: Text -&gt; SectionParser a -&gt; IniParser (Maybe a)
</span><a href="Data.Ini.Config.html#sectionMb"><span class="hs-identifier hs-var hs-var">sectionMb</span></a></span></span><span> </span><span id="local-6989586621679055152"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055152"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span id="local-6989586621679055151"><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055151"><span class="hs-identifier hs-var">thunk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser RawIni (Maybe a) -&gt; IniParser (Maybe a)
forall a. StParser RawIni a -&gt; IniParser a
</span><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-var">IniParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser RawIni (Maybe a) -&gt; IniParser (Maybe a))
-&gt; StParser RawIni (Maybe a) -&gt; IniParser (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RawIni -&gt; Either [Char] (Maybe a)) -&gt; StParser RawIni (Maybe a)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((RawIni -&gt; Either [Char] (Maybe a)) -&gt; StParser RawIni (Maybe a))
-&gt; (RawIni -&gt; Either [Char] (Maybe a)) -&gt; StParser RawIni (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span id="local-6989586621679055150"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055150"><span class="hs-identifier hs-var">ini</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NormalizedText
-&gt; Seq (NormalizedText, IniSection) -&gt; Maybe IniSection
forall a. NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.html#lkp"><span class="hs-identifier hs-var">lkp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NormalizedText
</span><a href="Data.Ini.Config.Raw.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055152"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055150"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">Maybe IniSection
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Either [Char] (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055149"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055149"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; Either [Char] a -&gt; Either [Char] (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">StParser IniSection a -&gt; IniSection -&gt; Either [Char] a
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055151"><span class="hs-identifier hs-var">thunk</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055149"><span class="hs-identifier hs-var">sec</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Find a named section in the INI file and parse it with the provided</span><span>
</span><span id="line-233"></span><span class="hs-comment">--   section parser, returning a default value if the section does not exist.</span><span>
</span><span id="line-234"></span><span class="hs-comment">--   In order to</span><span>
</span><span id="line-235"></span><span class="hs-comment">--   support classic INI files with capitalized section names, section</span><span>
</span><span id="line-236"></span><span class="hs-comment">--   lookup is __case-insensitive__.</span><span>
</span><span id="line-237"></span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[ONE]\nx = hello\n&quot; $ sectionDef &quot;ONE&quot; &quot;def&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-239"></span><span class="hs-comment">--   Right &quot;hello&quot;</span><span>
</span><span id="line-240"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[ONE]\nx = hello\n&quot; $ sectionDef &quot;TWO&quot; &quot;def&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-241"></span><span class="hs-comment">--   Right &quot;def&quot;</span><span>
</span><span id="line-242"></span><span id="local-6989586621679055148"><span class="annot"><a href="Data.Ini.Config.html#sectionDef"><span class="hs-identifier hs-type">sectionDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679055148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-type">IniParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055148"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-243"></span><span id="sectionDef"><span class="annot"><span class="annottext">sectionDef :: Text -&gt; a -&gt; SectionParser a -&gt; IniParser a
</span><a href="Data.Ini.Config.html#sectionDef"><span class="hs-identifier hs-var hs-var">sectionDef</span></a></span></span><span> </span><span id="local-6989586621679055147"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055147"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679055146"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055146"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span id="local-6989586621679055145"><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055145"><span class="hs-identifier hs-var">thunk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser RawIni a -&gt; IniParser a
forall a. StParser RawIni a -&gt; IniParser a
</span><a href="Data.Ini.Config.html#IniParser"><span class="hs-identifier hs-var">IniParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser RawIni a -&gt; IniParser a)
-&gt; StParser RawIni a -&gt; IniParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a)
-&gt; (RawIni -&gt; Either [Char] a) -&gt; StParser RawIni a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span id="local-6989586621679055144"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055144"><span class="hs-identifier hs-var">ini</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NormalizedText
-&gt; Seq (NormalizedText, IniSection) -&gt; Maybe IniSection
forall a. NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.html#lkp"><span class="hs-identifier hs-var">lkp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NormalizedText
</span><a href="Data.Ini.Config.Raw.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055147"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679055144"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">Maybe IniSection
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either [Char] a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055146"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055143"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055143"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StParser IniSection a -&gt; IniSection -&gt; Either [Char] a
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">StParser IniSection a
</span><a href="#local-6989586621679055145"><span class="hs-identifier hs-var">thunk</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055143"><span class="hs-identifier hs-var">sec</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">---</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span id="local-6989586621679055337"><span id="local-6989586621679055338"><span class="annot"><a href="Data.Ini.Config.html#throw"><span class="hs-identifier hs-type">throw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055338"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055337"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-251"></span><span id="throw"><span class="annot"><span class="annottext">throw :: [Char] -&gt; StParser s a
</span><a href="Data.Ini.Config.html#throw"><span class="hs-identifier hs-var hs-var">throw</span></a></span></span><span> </span><span id="local-6989586621679055141"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055141"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; Either [Char] a) -&gt; StParser s a
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((s -&gt; Either [Char] a) -&gt; StParser s a)
-&gt; (s -&gt; Either [Char] a) -&gt; StParser s a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055141"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><a href="Data.Ini.Config.html#getSectionName"><span class="hs-identifier hs-type">getSectionName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-254"></span><span id="getSectionName"><span class="annot"><span class="annottext">getSectionName :: StParser IniSection Text
</span><a href="Data.Ini.Config.html#getSectionName"><span class="hs-identifier hs-var hs-var">getSectionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IniSection -&gt; Either [Char] Text) -&gt; StParser IniSection Text
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((IniSection -&gt; Either [Char] Text) -&gt; StParser IniSection Text)
-&gt; (IniSection -&gt; Either [Char] Text) -&gt; StParser IniSection Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679055139"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055139"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniSection -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#isName"><span class="hs-identifier hs-var hs-var">isName</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055139"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Data.Ini.Config.html#rawFieldMb"><span class="hs-identifier hs-type">rawFieldMb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span id="rawFieldMb"><span class="annot"><span class="annottext">rawFieldMb :: Text -&gt; StParser IniSection (Maybe IniValue)
</span><a href="Data.Ini.Config.html#rawFieldMb"><span class="hs-identifier hs-var hs-var">rawFieldMb</span></a></span></span><span> </span><span id="local-6989586621679055136"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055136"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IniSection -&gt; Either [Char] (Maybe IniValue))
-&gt; StParser IniSection (Maybe IniValue)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((IniSection -&gt; Either [Char] (Maybe IniValue))
 -&gt; StParser IniSection (Maybe IniValue))
-&gt; (IniSection -&gt; Either [Char] (Maybe IniValue))
-&gt; StParser IniSection (Maybe IniValue)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679055135"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055135"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">Maybe IniValue -&gt; Either [Char] (Maybe IniValue)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (NormalizedText, IniValue) -&gt; Maybe IniValue
forall a. NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.html#lkp"><span class="hs-identifier hs-var">lkp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NormalizedText
</span><a href="Data.Ini.Config.Raw.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055136"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniSection -&gt; Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Raw.html#isVals"><span class="hs-identifier hs-var hs-var">isVals</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055135"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><a href="Data.Ini.Config.html#rawField"><span class="hs-identifier hs-type">rawField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#StParser"><span class="hs-identifier hs-type">StParser</span></a></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span>
</span><span id="line-261"></span><span id="rawField"><span class="annot"><span class="annottext">rawField :: Text -&gt; StParser IniSection IniValue
</span><a href="Data.Ini.Config.html#rawField"><span class="hs-identifier hs-var hs-var">rawField</span></a></span></span><span> </span><span id="local-6989586621679055132"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055132"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679055131"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055131"><span class="hs-identifier hs-var">sec</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StParser IniSection Text
</span><a href="Data.Ini.Config.html#getSectionName"><span class="hs-identifier hs-var">getSectionName</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679055130"><span class="annot"><span class="annottext">Maybe IniValue
</span><a href="#local-6989586621679055130"><span class="hs-identifier hs-var">valMb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; StParser IniSection (Maybe IniValue)
</span><a href="Data.Ini.Config.html#rawFieldMb"><span class="hs-identifier hs-var">rawFieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055132"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe IniValue
</span><a href="#local-6989586621679055130"><span class="hs-identifier hs-var">valMb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><span class="annottext">Maybe IniValue
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; StParser IniSection IniValue
forall s a. [Char] -&gt; StParser s a
</span><a href="Data.Ini.Config.html#throw"><span class="hs-identifier hs-var">throw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Missing field &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055132"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-266"></span><span>                      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; in section &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055131"><span class="hs-identifier hs-var">sec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055129"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055129"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IniValue -&gt; StParser IniSection IniValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055129"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="annot"><a href="Data.Ini.Config.html#getVal"><span class="hs-identifier hs-type">getVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-270"></span><span id="getVal"><span class="annot"><span class="annottext">getVal :: IniValue -&gt; Text
</span><a href="Data.Ini.Config.html#getVal"><span class="hs-identifier hs-var hs-var">getVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (IniValue -&gt; Text) -&gt; IniValue -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var hs-var">vValue</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Retrieve a field, failing if it doesn't exist, and return its raw value.</span><span>
</span><span id="line-273"></span><span class="hs-comment">--</span><span>
</span><span id="line-274"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (field &quot;x&quot;)</span><span>
</span><span id="line-275"></span><span class="hs-comment">--   Right &quot;hello&quot;</span><span>
</span><span id="line-276"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (field &quot;y&quot;)</span><span>
</span><span id="line-277"></span><span class="hs-comment">--   Left &quot;Missing field \&quot;y\&quot; in section \&quot;MAIN\&quot;&quot;</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Data.Ini.Config.html#field"><span class="hs-identifier hs-type">field</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-279"></span><span id="field"><span class="annot"><span class="annottext">field :: Text -&gt; SectionParser Text
</span><a href="Data.Ini.Config.html#field"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span id="local-6989586621679055125"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055125"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser IniSection Text -&gt; SectionParser Text
forall a. StParser IniSection a -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-var">SectionParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser IniSection Text -&gt; SectionParser Text)
-&gt; StParser IniSection Text -&gt; SectionParser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.html#getVal"><span class="hs-identifier hs-var">getVal</span></a></span><span> </span><span class="annot"><span class="annottext">(IniValue -&gt; Text)
-&gt; StParser IniSection IniValue -&gt; StParser IniSection Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; StParser IniSection IniValue
</span><a href="Data.Ini.Config.html#rawField"><span class="hs-identifier hs-var">rawField</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055125"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Retrieve a field and use the supplied parser to parse it as a value,</span><span>
</span><span id="line-282"></span><span class="hs-comment">--   failing if the field does not exist, or if the parser fails to</span><span>
</span><span id="line-283"></span><span class="hs-comment">--   produce a value.</span><span>
</span><span id="line-284"></span><span class="hs-comment">--</span><span>
</span><span id="line-285"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = 72\n&quot; $ section &quot;MAIN&quot; (fieldOf &quot;x&quot; number)</span><span>
</span><span id="line-286"></span><span class="hs-comment">--   Right 72</span><span>
</span><span id="line-287"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (fieldOf &quot;x&quot; number)</span><span>
</span><span id="line-288"></span><span class="hs-comment">--   Left &quot;Line 2, in section \&quot;MAIN\&quot;: Unable to parse \&quot;hello\&quot; as a value of type Integer&quot;</span><span>
</span><span id="line-289"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = 72\n&quot; $ section &quot;MAIN&quot; (fieldOf &quot;y&quot; number)</span><span>
</span><span id="line-290"></span><span class="hs-comment">--   Left &quot;Missing field \&quot;y\&quot; in section \&quot;MAIN\&quot;&quot;</span><span>
</span><span id="line-291"></span><span id="local-6989586621679055330"><span class="annot"><a href="Data.Ini.Config.html#fieldOf"><span class="hs-identifier hs-type">fieldOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679055330"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055330"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-292"></span><span id="fieldOf"><span class="annot"><span class="annottext">fieldOf :: Text -&gt; (Text -&gt; Either [Char] a) -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#fieldOf"><span class="hs-identifier hs-var hs-var">fieldOf</span></a></span></span><span> </span><span id="local-6989586621679055124"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055124"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679055123"><span class="annot"><span class="annottext">Text -&gt; Either [Char] a
</span><a href="#local-6989586621679055123"><span class="hs-identifier hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser IniSection a -&gt; SectionParser a
forall a. StParser IniSection a -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-var">SectionParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser IniSection a -&gt; SectionParser a)
-&gt; StParser IniSection a -&gt; SectionParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679055122"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055122"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StParser IniSection Text
</span><a href="Data.Ini.Config.html#getSectionName"><span class="hs-identifier hs-var">getSectionName</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679055121"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055121"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; StParser IniSection IniValue
</span><a href="Data.Ini.Config.html#rawField"><span class="hs-identifier hs-var">rawField</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055124"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] a
</span><a href="#local-6989586621679055123"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.html#getVal"><span class="hs-identifier hs-var">getVal</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055121"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679055120"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055120"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; StParser IniSection a -&gt; StParser IniSection a
forall s a. Int -&gt; Text -&gt; StParser s a -&gt; StParser s a
</span><a href="Data.Ini.Config.html#addLineInformation"><span class="hs-identifier hs-var">addLineInformation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Int
</span><a href="Data.Ini.Config.Raw.html#vLineNo"><span class="hs-identifier hs-var hs-var">vLineNo</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055121"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055122"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; StParser IniSection a
forall s a. [Char] -&gt; StParser s a
</span><a href="Data.Ini.Config.html#throw"><span class="hs-identifier hs-var">throw</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055120"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679055118"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055118"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; StParser IniSection a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055118"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | Retrieve a field, returning a @Nothing@ value if it does not exist.</span><span>
</span><span id="line-300"></span><span class="hs-comment">--</span><span>
</span><span id="line-301"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (fieldMb &quot;x&quot;)</span><span>
</span><span id="line-302"></span><span class="hs-comment">--   Right (Just &quot;hello&quot;)</span><span>
</span><span id="line-303"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (fieldMb &quot;y&quot;)</span><span>
</span><span id="line-304"></span><span class="hs-comment">--   Right Nothing</span><span>
</span><span id="line-305"></span><span class="annot"><a href="Data.Ini.Config.html#fieldMb"><span class="hs-identifier hs-type">fieldMb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span id="fieldMb"><span class="annot"><span class="annottext">fieldMb :: Text -&gt; SectionParser (Maybe Text)
</span><a href="Data.Ini.Config.html#fieldMb"><span class="hs-identifier hs-var hs-var">fieldMb</span></a></span></span><span> </span><span id="local-6989586621679055117"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055117"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser IniSection (Maybe Text) -&gt; SectionParser (Maybe Text)
forall a. StParser IniSection a -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-var">SectionParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser IniSection (Maybe Text) -&gt; SectionParser (Maybe Text))
-&gt; StParser IniSection (Maybe Text) -&gt; SectionParser (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(IniValue -&gt; Text) -&gt; Maybe IniValue -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.html#getVal"><span class="hs-identifier hs-var">getVal</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe IniValue -&gt; Maybe Text)
-&gt; StParser IniSection (Maybe IniValue)
-&gt; StParser IniSection (Maybe Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; StParser IniSection (Maybe IniValue)
</span><a href="Data.Ini.Config.html#rawFieldMb"><span class="hs-identifier hs-var">rawFieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055117"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | Retrieve a field and parse it according to the given parser, returning</span><span>
</span><span id="line-309"></span><span class="hs-comment">--   @Nothing@ if it does not exist. If the parser fails, then this will</span><span>
</span><span id="line-310"></span><span class="hs-comment">--   fail.</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = 72\n&quot; $ section &quot;MAIN&quot; (fieldMbOf &quot;x&quot; number)</span><span>
</span><span id="line-313"></span><span class="hs-comment">--   Right (Just 72)</span><span>
</span><span id="line-314"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (fieldMbOf &quot;x&quot; number)</span><span>
</span><span id="line-315"></span><span class="hs-comment">--   Left &quot;Line 2, in section \&quot;MAIN\&quot;: Unable to parse \&quot;hello\&quot; as a value of type Integer&quot;</span><span>
</span><span id="line-316"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = 72\n&quot; $ section &quot;MAIN&quot; (fieldMbOf &quot;y&quot; number)</span><span>
</span><span id="line-317"></span><span class="hs-comment">--   Right Nothing</span><span>
</span><span id="line-318"></span><span id="local-6989586621679055116"><span class="annot"><a href="Data.Ini.Config.html#fieldMbOf"><span class="hs-identifier hs-type">fieldMbOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679055116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679055116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-319"></span><span id="fieldMbOf"><span class="annot"><span class="annottext">fieldMbOf :: Text -&gt; (Text -&gt; Either [Char] a) -&gt; SectionParser (Maybe a)
</span><a href="Data.Ini.Config.html#fieldMbOf"><span class="hs-identifier hs-var hs-var">fieldMbOf</span></a></span></span><span> </span><span id="local-6989586621679055115"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055115"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679055114"><span class="annot"><span class="annottext">Text -&gt; Either [Char] a
</span><a href="#local-6989586621679055114"><span class="hs-identifier hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser IniSection (Maybe a) -&gt; SectionParser (Maybe a)
forall a. StParser IniSection a -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-var">SectionParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser IniSection (Maybe a) -&gt; SectionParser (Maybe a))
-&gt; StParser IniSection (Maybe a) -&gt; SectionParser (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679055113"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055113"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StParser IniSection Text
</span><a href="Data.Ini.Config.html#getSectionName"><span class="hs-identifier hs-var">getSectionName</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679055112"><span class="annot"><span class="annottext">Maybe IniValue
</span><a href="#local-6989586621679055112"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; StParser IniSection (Maybe IniValue)
</span><a href="Data.Ini.Config.html#rawFieldMb"><span class="hs-identifier hs-var">rawFieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055115"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe IniValue
</span><a href="#local-6989586621679055112"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">Maybe IniValue
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; StParser IniSection (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055111"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055111"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] a
</span><a href="#local-6989586621679055114"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.html#getVal"><span class="hs-identifier hs-var">getVal</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055111"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679055110"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055110"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Text
-&gt; StParser IniSection (Maybe a)
-&gt; StParser IniSection (Maybe a)
forall s a. Int -&gt; Text -&gt; StParser s a -&gt; StParser s a
</span><a href="Data.Ini.Config.html#addLineInformation"><span class="hs-identifier hs-var">addLineInformation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Int
</span><a href="Data.Ini.Config.Raw.html#vLineNo"><span class="hs-identifier hs-var hs-var">vLineNo</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055111"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055113"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; StParser IniSection (Maybe a)
forall s a. [Char] -&gt; StParser s a
</span><a href="Data.Ini.Config.html#throw"><span class="hs-identifier hs-var">throw</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055110"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679055109"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055109"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; StParser IniSection (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055109"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | Retrieve a field and supply a default value for if it doesn't exist.</span><span>
</span><span id="line-329"></span><span class="hs-comment">--</span><span>
</span><span id="line-330"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (fieldDef &quot;x&quot; &quot;def&quot;)</span><span>
</span><span id="line-331"></span><span class="hs-comment">--   Right &quot;hello&quot;</span><span>
</span><span id="line-332"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (fieldDef &quot;y&quot; &quot;def&quot;)</span><span>
</span><span id="line-333"></span><span class="hs-comment">--   Right &quot;def&quot;</span><span>
</span><span id="line-334"></span><span class="annot"><a href="Data.Ini.Config.html#fieldDef"><span class="hs-identifier hs-type">fieldDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-335"></span><span id="fieldDef"><span class="annot"><span class="annottext">fieldDef :: Text -&gt; Text -&gt; SectionParser Text
</span><a href="Data.Ini.Config.html#fieldDef"><span class="hs-identifier hs-var hs-var">fieldDef</span></a></span></span><span> </span><span id="local-6989586621679055108"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055108"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679055107"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055107"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser IniSection Text -&gt; SectionParser Text
forall a. StParser IniSection a -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-var">SectionParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser IniSection Text -&gt; SectionParser Text)
-&gt; StParser IniSection Text -&gt; SectionParser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(IniSection -&gt; Either [Char] Text) -&gt; StParser IniSection Text
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">((IniSection -&gt; Either [Char] Text) -&gt; StParser IniSection Text)
-&gt; (IniSection -&gt; Either [Char] Text) -&gt; StParser IniSection Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679055106"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055106"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (NormalizedText, IniValue) -&gt; Maybe IniValue
forall a. NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.html#lkp"><span class="hs-identifier hs-var">lkp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NormalizedText
</span><a href="Data.Ini.Config.Raw.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055108"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniSection -&gt; Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Raw.html#isVals"><span class="hs-identifier hs-var hs-var">isVals</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679055106"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><span class="annottext">Maybe IniValue
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055107"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055105"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055105"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.html#getVal"><span class="hs-identifier hs-var">getVal</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055105"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Retrieve a field, parsing it according to the given parser, and returning</span><span>
</span><span id="line-341"></span><span class="hs-comment">--   a default value if it does not exist. If the parser fails, then this will</span><span>
</span><span id="line-342"></span><span class="hs-comment">--   fail.</span><span>
</span><span id="line-343"></span><span class="hs-comment">--</span><span>
</span><span id="line-344"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = 72\n&quot; $ section &quot;MAIN&quot; (fieldDefOf &quot;x&quot; number 99)</span><span>
</span><span id="line-345"></span><span class="hs-comment">--   Right 72</span><span>
</span><span id="line-346"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (fieldDefOf &quot;x&quot; number 99)</span><span>
</span><span id="line-347"></span><span class="hs-comment">--   Left &quot;Line 2, in section \&quot;MAIN\&quot;: Unable to parse \&quot;hello\&quot; as a value of type Integer&quot;</span><span>
</span><span id="line-348"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = 72\n&quot; $ section &quot;MAIN&quot; (fieldDefOf &quot;y&quot; number 99)</span><span>
</span><span id="line-349"></span><span class="hs-comment">--   Right 99</span><span>
</span><span id="line-350"></span><span id="local-6989586621679055329"><span class="annot"><a href="Data.Ini.Config.html#fieldDefOf"><span class="hs-identifier hs-type">fieldDefOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679055329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679055329"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055329"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-351"></span><span id="fieldDefOf"><span class="annot"><span class="annottext">fieldDefOf :: Text -&gt; (Text -&gt; Either [Char] a) -&gt; a -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#fieldDefOf"><span class="hs-identifier hs-var hs-var">fieldDefOf</span></a></span></span><span> </span><span id="local-6989586621679055104"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055104"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679055103"><span class="annot"><span class="annottext">Text -&gt; Either [Char] a
</span><a href="#local-6989586621679055103"><span class="hs-identifier hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679055102"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055102"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StParser IniSection a -&gt; SectionParser a
forall a. StParser IniSection a -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-var">SectionParser</span></a></span><span> </span><span class="annot"><span class="annottext">(StParser IniSection a -&gt; SectionParser a)
-&gt; StParser IniSection a -&gt; SectionParser a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621679055101"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055101"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StParser IniSection Text
</span><a href="Data.Ini.Config.html#getSectionName"><span class="hs-identifier hs-var">getSectionName</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679055100"><span class="annot"><span class="annottext">Maybe IniValue
</span><a href="#local-6989586621679055100"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; StParser IniSection (Maybe IniValue)
</span><a href="Data.Ini.Config.html#rawFieldMb"><span class="hs-identifier hs-var">rawFieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055104"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe IniValue
</span><a href="#local-6989586621679055100"><span class="hs-identifier hs-var">mb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">Maybe IniValue
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; StParser IniSection a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055102"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055099"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055099"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] a
</span><a href="#local-6989586621679055103"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.html#getVal"><span class="hs-identifier hs-var">getVal</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055099"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-357"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679055098"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055098"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; StParser IniSection a -&gt; StParser IniSection a
forall s a. Int -&gt; Text -&gt; StParser s a -&gt; StParser s a
</span><a href="Data.Ini.Config.html#addLineInformation"><span class="hs-identifier hs-var">addLineInformation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Int
</span><a href="Data.Ini.Config.Raw.html#vLineNo"><span class="hs-identifier hs-var hs-var">vLineNo</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679055099"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055101"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; StParser IniSection a
forall s a. [Char] -&gt; StParser s a
</span><a href="Data.Ini.Config.html#throw"><span class="hs-identifier hs-var">throw</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055098"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679055097"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055097"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; StParser IniSection a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055097"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | Retrieve a field and treat it as a boolean, failing if it</span><span>
</span><span id="line-361"></span><span class="hs-comment">--   does not exist.</span><span>
</span><span id="line-362"></span><span class="hs-comment">--</span><span>
</span><span id="line-363"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = yes\n&quot; $ section &quot;MAIN&quot; (fieldFlag &quot;x&quot;)</span><span>
</span><span id="line-364"></span><span class="hs-comment">--   Right True</span><span>
</span><span id="line-365"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = yes\n&quot; $ section &quot;MAIN&quot; (fieldFlag &quot;y&quot;)</span><span>
</span><span id="line-366"></span><span class="hs-comment">--   Left &quot;Missing field \&quot;y\&quot; in section \&quot;MAIN\&quot;&quot;</span><span>
</span><span id="line-367"></span><span class="annot"><a href="Data.Ini.Config.html#fieldFlag"><span class="hs-identifier hs-type">fieldFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-368"></span><span id="fieldFlag"><span class="annot"><span class="annottext">fieldFlag :: Text -&gt; SectionParser Bool
</span><a href="Data.Ini.Config.html#fieldFlag"><span class="hs-identifier hs-var hs-var">fieldFlag</span></a></span></span><span> </span><span id="local-6989586621679055096"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055096"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Text -&gt; Either [Char] Bool) -&gt; SectionParser Bool
forall a. Text -&gt; (Text -&gt; Either [Char] a) -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#fieldOf"><span class="hs-identifier hs-var">fieldOf</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055096"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] Bool
</span><a href="Data.Ini.Config.html#flag"><span class="hs-identifier hs-var">flag</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-comment">-- | Retrieve a field and treat it as a boolean, subsituting</span><span>
</span><span id="line-371"></span><span class="hs-comment">--   a default value if it doesn't exist.</span><span>
</span><span id="line-372"></span><span class="hs-comment">--</span><span>
</span><span id="line-373"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = yes\n&quot; $ section &quot;MAIN&quot; (fieldFlagDef &quot;x&quot; False)</span><span>
</span><span id="line-374"></span><span class="hs-comment">--   Right True</span><span>
</span><span id="line-375"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = hello\n&quot; $ section &quot;MAIN&quot; (fieldFlagDef &quot;x&quot; False)</span><span>
</span><span id="line-376"></span><span class="hs-comment">--   Left &quot;Line 2, in section \&quot;MAIN\&quot;: Unable to parse \&quot;hello\&quot; as a boolean&quot;</span><span>
</span><span id="line-377"></span><span class="hs-comment">--   &gt;&gt;&gt; parseIniFile &quot;[MAIN]\nx = yes\n&quot; $ section &quot;MAIN&quot; (fieldFlagDef &quot;y&quot; False)</span><span>
</span><span id="line-378"></span><span class="hs-comment">--   Right False</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Data.Ini.Config.html#fieldFlagDef"><span class="hs-identifier hs-type">fieldFlagDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.html#SectionParser"><span class="hs-identifier hs-type">SectionParser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-380"></span><span id="fieldFlagDef"><span class="annot"><span class="annottext">fieldFlagDef :: Text -&gt; Bool -&gt; SectionParser Bool
</span><a href="Data.Ini.Config.html#fieldFlagDef"><span class="hs-identifier hs-var hs-var">fieldFlagDef</span></a></span></span><span> </span><span id="local-6989586621679055095"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055095"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679055094"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679055094"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Text -&gt; Either [Char] Bool) -&gt; Bool -&gt; SectionParser Bool
forall a. Text -&gt; (Text -&gt; Either [Char] a) -&gt; a -&gt; SectionParser a
</span><a href="Data.Ini.Config.html#fieldDefOf"><span class="hs-identifier hs-var">fieldDefOf</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055095"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] Bool
</span><a href="Data.Ini.Config.html#flag"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679055094"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">---</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | Try to use the &quot;Read&quot; instance for a type to parse a value, failing</span><span>
</span><span id="line-385"></span><span class="hs-comment">--   with a human-readable error message if reading fails.</span><span>
</span><span id="line-386"></span><span class="hs-comment">--</span><span>
</span><span id="line-387"></span><span class="hs-comment">--   &gt;&gt;&gt; readable &quot;(5, 7)&quot; :: Either String (Int, Int)</span><span>
</span><span id="line-388"></span><span class="hs-comment">--   Right (5,7)</span><span>
</span><span id="line-389"></span><span class="hs-comment">--   &gt;&gt;&gt; readable &quot;hello&quot; :: Either String (Int, Int)</span><span>
</span><span id="line-390"></span><span class="hs-comment">--   Left &quot;Unable to parse \&quot;hello\&quot; as a value of type (Int,Int)&quot;</span><span>
</span><span id="line-391"></span><span class="annot"><a href="Data.Ini.Config.html#readable"><span class="hs-identifier hs-type">readable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679055318"><span class="annot"><a href="#local-6989586621679055318"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679055318"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679055318"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679055318"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-392"></span><span id="readable"><span class="annot"><span class="annottext">readable :: Text -&gt; Either [Char] a
</span><a href="Data.Ini.Config.html#readable"><span class="hs-identifier hs-var hs-var">readable</span></a></span></span><span> </span><span id="local-6989586621679055093"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055093"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe a
forall a. Read a =&gt; [Char] -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055092"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679055091"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055091"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either [Char] a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055091"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unable to parse &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679055092"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-395"></span><span>                   </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; as a value of type &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TypeRep
</span><a href="#local-6989586621679055090"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679055092"><span class="annot"><span class="annottext">str :: [Char]
</span><a href="#local-6989586621679055092"><span class="hs-identifier hs-var hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055093"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-397"></span><span>        </span><span id="local-6989586621679055090"><span class="annot"><span class="annottext">typ :: TypeRep
</span><a href="#local-6989586621679055090"><span class="hs-identifier hs-var hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; TypeRep
forall k (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><span class="hs-identifier hs-var">typeRep</span></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679055088"><span class="hs-identifier hs-var">prx</span></a></span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><a href="#local-6989586621679055088"><span class="hs-identifier hs-type">prx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679055318"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-399"></span><span>        </span><span id="local-6989586621679055088"><span class="annot"><span class="annottext">prx :: Proxy a
</span><a href="#local-6989586621679055088"><span class="hs-identifier hs-var hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Try to use the &quot;Read&quot; instance for a numeric type to parse a value,</span><span>
</span><span id="line-402"></span><span class="hs-comment">--   failing with a human-readable error message if reading fails.</span><span>
</span><span id="line-403"></span><span class="hs-comment">--</span><span>
</span><span id="line-404"></span><span class="hs-comment">--   &gt;&gt;&gt; number &quot;5&quot; :: Either String Int</span><span>
</span><span id="line-405"></span><span class="hs-comment">--   Right 5</span><span>
</span><span id="line-406"></span><span class="hs-comment">--   &gt;&gt;&gt; number &quot;hello&quot; :: Either String Int</span><span>
</span><span id="line-407"></span><span class="hs-comment">--   Left &quot;Unable to parse \&quot;hello\&quot; as a value of type Int&quot;</span><span>
</span><span id="line-408"></span><span id="local-6989586621679055086"><span class="annot"><a href="Data.Ini.Config.html#number"><span class="hs-identifier hs-type">number</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679055086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679055086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679055086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679055086"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-409"></span><span id="number"><span class="annot"><span class="annottext">number :: Text -&gt; Either [Char] a
</span><a href="Data.Ini.Config.html#number"><span class="hs-identifier hs-var hs-var">number</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either [Char] a
forall a. (Read a, Typeable a) =&gt; Text -&gt; Either [Char] a
</span><a href="Data.Ini.Config.html#readable"><span class="hs-identifier hs-var">readable</span></a></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- | Convert a textual value to the appropriate string type. This will</span><span>
</span><span id="line-412"></span><span class="hs-comment">--   never fail.</span><span>
</span><span id="line-413"></span><span class="hs-comment">--</span><span>
</span><span id="line-414"></span><span class="hs-comment">--   &gt;&gt;&gt; string &quot;foo&quot; :: Either String String</span><span>
</span><span id="line-415"></span><span class="hs-comment">--   Right &quot;foo&quot;</span><span>
</span><span id="line-416"></span><span id="local-6989586621679055085"><span class="annot"><a href="Data.Ini.Config.html#string"><span class="hs-identifier hs-type">string</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="#local-6989586621679055085"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679055085"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-417"></span><span id="string"><span class="annot"><span class="annottext">string :: Text -&gt; Either [Char] a
</span><a href="Data.Ini.Config.html#string"><span class="hs-identifier hs-var hs-var">string</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either [Char] a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either [Char] a) -&gt; (Text -&gt; a) -&gt; Text -&gt; Either [Char] a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; (Text -&gt; [Char]) -&gt; Text -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">-- | Convert a string that represents a boolean to a proper boolean. This</span><span>
</span><span id="line-420"></span><span class="hs-comment">--   is case-insensitive, and matches the words @true@, @false@, @yes@,</span><span>
</span><span id="line-421"></span><span class="hs-comment">--   @no@, as well as single-letter abbreviations for all of the above.</span><span>
</span><span id="line-422"></span><span class="hs-comment">--   If the input does not match, then this will fail with a human-readable</span><span>
</span><span id="line-423"></span><span class="hs-comment">--   error message.</span><span>
</span><span id="line-424"></span><span class="hs-comment">--</span><span>
</span><span id="line-425"></span><span class="hs-comment">--   &gt;&gt;&gt; flag &quot;TRUE&quot;</span><span>
</span><span id="line-426"></span><span class="hs-comment">--   Right True</span><span>
</span><span id="line-427"></span><span class="hs-comment">--   &gt;&gt;&gt; flag &quot;y&quot;</span><span>
</span><span id="line-428"></span><span class="hs-comment">--   Right True</span><span>
</span><span id="line-429"></span><span class="hs-comment">--   &gt;&gt;&gt; flag &quot;no&quot;</span><span>
</span><span id="line-430"></span><span class="hs-comment">--   Right False</span><span>
</span><span id="line-431"></span><span class="hs-comment">--   &gt;&gt;&gt; flag &quot;F&quot;</span><span>
</span><span id="line-432"></span><span class="hs-comment">--   Right False</span><span>
</span><span id="line-433"></span><span class="hs-comment">--   &gt;&gt;&gt; flag &quot;That's a secret!&quot;</span><span>
</span><span id="line-434"></span><span class="hs-comment">--   Left &quot;Unable to parse \&quot;That's a secret!\&quot; as a boolean&quot;</span><span>
</span><span id="line-435"></span><span class="annot"><a href="Data.Ini.Config.html#flag"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-436"></span><span id="flag"><span class="annot"><span class="annottext">flag :: Text -&gt; Either [Char] Bool
</span><a href="Data.Ini.Config.html#flag"><span class="hs-identifier hs-var hs-var">flag</span></a></span></span><span> </span><span id="local-6989586621679055084"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055084"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055084"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;true&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either [Char] Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;yes&quot;</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either [Char] Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either [Char] Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-440"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;y&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either [Char] Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either [Char] Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;no&quot;</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either [Char] Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;f&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either [Char] Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;n&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either [Char] Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unable to parse &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055084"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; as a boolean&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- | Convert a reader for a value into a reader for a list of those</span><span>
</span><span id="line-448"></span><span class="hs-comment">--   values, separated by a chosen separator. This will split apart</span><span>
</span><span id="line-449"></span><span class="hs-comment">--   the string on that separator, get rid of leading and trailing</span><span>
</span><span id="line-450"></span><span class="hs-comment">--   whitespace on the individual chunks, and then attempt to parse</span><span>
</span><span id="line-451"></span><span class="hs-comment">--   each of them according to the function provided, turning the</span><span>
</span><span id="line-452"></span><span class="hs-comment">--   result into a list.</span><span>
</span><span id="line-453"></span><span class="hs-comment">--</span><span>
</span><span id="line-454"></span><span class="hs-comment">--   This is overloaded with the &quot;IsList&quot; typeclass, so it can be</span><span>
</span><span id="line-455"></span><span class="hs-comment">--   used transparently to parse other list-like types.</span><span>
</span><span id="line-456"></span><span class="hs-comment">--</span><span>
</span><span id="line-457"></span><span class="hs-comment">--   &gt;&gt;&gt; listWithSeparator &quot;,&quot; number &quot;2, 3, 4&quot; :: Either String [Int]</span><span>
</span><span id="line-458"></span><span class="hs-comment">--   Right [2,3,4]</span><span>
</span><span id="line-459"></span><span class="hs-comment">--   &gt;&gt;&gt; listWithSeparator &quot; &quot; number &quot;7 8 9&quot; :: Either String [Int]</span><span>
</span><span id="line-460"></span><span class="hs-comment">--   Right [7,8,9]</span><span>
</span><span id="line-461"></span><span class="hs-comment">--   &gt;&gt;&gt; listWithSeparator &quot;:&quot; string &quot;/bin:/usr/bin&quot; :: Either String [FilePath]</span><span>
</span><span id="line-462"></span><span class="hs-comment">--   Right [&quot;/bin&quot;,&quot;/usr/bin&quot;]</span><span>
</span><span id="line-463"></span><span class="hs-comment">--   &gt;&gt;&gt; listWithSeparator &quot;,&quot; number &quot;7 8 9&quot; :: Either String [Int]</span><span>
</span><span id="line-464"></span><span class="hs-comment">--   Left &quot;Unable to parse \&quot;7 8 9\&quot; as a value of type Int&quot;</span><span>
</span><span id="line-465"></span><span id="local-6989586621679055082"><span class="annot"><a href="Data.Ini.Config.html#listWithSeparator"><span class="hs-identifier hs-type">listWithSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679055082"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-467"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679055082"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679055082"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-469"></span><span id="listWithSeparator"><span class="annot"><span class="annottext">listWithSeparator :: Text -&gt; (Text -&gt; Either [Char] (Item l)) -&gt; Text -&gt; Either [Char] l
</span><a href="Data.Ini.Config.html#listWithSeparator"><span class="hs-identifier hs-var hs-var">listWithSeparator</span></a></span></span><span> </span><span id="local-6989586621679055081"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055081"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span id="local-6989586621679055080"><span class="annot"><span class="annottext">Text -&gt; Either [Char] (Item l)
</span><a href="#local-6989586621679055080"><span class="hs-identifier hs-var">rd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><span class="annottext">([Item l] -&gt; l) -&gt; Either [Char] [Item l] -&gt; Either [Char] l
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Item l] -&gt; l
forall l. IsList l =&gt; [Item l] -&gt; l
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">(Either [Char] [Item l] -&gt; Either [Char] l)
-&gt; (Text -&gt; Either [Char] [Item l]) -&gt; Text -&gt; Either [Char] l
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either [Char] (Item l))
-&gt; [Text] -&gt; Either [Char] [Item l]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Either [Char] (Item l)
</span><a href="#local-6989586621679055080"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either [Char] (Item l))
-&gt; (Text -&gt; Text) -&gt; Text -&gt; Either [Char] (Item l)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Either [Char] [Item l])
-&gt; (Text -&gt; [Text]) -&gt; Text -&gt; Either [Char] [Item l]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.splitOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679055081"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-473"></span><span class="hs-comment">--</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- data NetworkConfig = NetworkConfig</span><span>
</span><span id="line-476"></span><span class="hs-comment">--    { netHost :: String, netPort :: Int }</span><span>
</span><span id="line-477"></span><span class="hs-comment">--     deriving (Eq, Show)</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- &gt;&gt;&gt; :}</span><span>
</span><span id="line-479"></span><span class="hs-comment">--</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- data LocalConfig = LocalConfig</span><span>
</span><span id="line-482"></span><span class="hs-comment">--   { localUser :: Text }</span><span>
</span><span id="line-483"></span><span class="hs-comment">--     deriving (Eq, Show)</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- &gt;&gt;&gt; :}</span><span>
</span><span id="line-485"></span><span class="hs-comment">--</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- data Config = Config</span><span>
</span><span id="line-488"></span><span class="hs-comment">--   { cfNetwork :: NetworkConfig, cfLocal :: Maybe LocalConfig }</span><span>
</span><span id="line-489"></span><span class="hs-comment">--     deriving (Eq, Show)</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- &gt;&gt;&gt; :}</span><span>
</span><span id="line-491"></span><span class="hs-comment">--</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- let configParser = do</span><span>
</span><span id="line-494"></span><span class="hs-comment">--       netCf &lt;- section &quot;NETWORK&quot; $ do</span><span>
</span><span id="line-495"></span><span class="hs-comment">--         host &lt;- fieldOf &quot;host&quot; string</span><span>
</span><span id="line-496"></span><span class="hs-comment">--         port &lt;- fieldOf &quot;port&quot; number</span><span>
</span><span id="line-497"></span><span class="hs-comment">--         return NetworkConfig { netHost = host, netPort = port }</span><span>
</span><span id="line-498"></span><span class="hs-comment">--       locCf &lt;- sectionMb &quot;LOCAL&quot; $</span><span>
</span><span id="line-499"></span><span class="hs-comment">--         LocalConfig &lt;$&gt; field &quot;user&quot;</span><span>
</span><span id="line-500"></span><span class="hs-comment">--       return Config { cfNetwork = netCf, cfLocal = locCf }</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- &gt;&gt;&gt; :}</span><span>
</span><span id="line-502"></span><span class="hs-comment">--</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-504"></span><span class="hs-comment">--    let example = &quot;[NETWORK]\nhost = example.com\nport = 7878\n\n# here is a comment\n[LOCAL]\nuser = terry\n&quot;</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- &gt;&gt;&gt; :}</span><span>
</span><span id="line-506"></span></pre></body></html>