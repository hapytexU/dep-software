<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module     : Data.Ini.Config.Bidir
Copyright  : (c) Getty Ritter, 2017
License    : BSD
Maintainer : Getty Ritter &lt;config-ini@infinitenegativeutility.com&gt;
Stability  : experimental

This module presents an alternate API for parsing INI files.  Unlike
the standard API, it is bidirectional: the same declarative structure
can be used to parse an INI file to a value, serialize an INI file
from a value, or even /update/ an INI file by comparing it against a
value and serializing in a way that minimizes the differences between
revisions of the file.

This API does make some extra assumptions about your configuration
type and the way you interact with it: in particular, it assumes that
you have lenses for all the fields you're parsing and that you have
some kind of sensible default value of that configuration
type. Instead of providing combinators which can extract and parse a
field of an INI file into a value, the bidirectional API allows you to
declaratively associate a lens into your structure with a field of the
INI file.

Consider the following example INI file:

&gt; [NETWORK]
&gt; host = example.com
&gt; port = 7878
&gt;
&gt; [LOCAL]
&gt; user = terry

We'd like to parse this INI file into a @Config@ type which we've
defined like this, using
&lt;https://hackage.haskell.org/package/lens lens&gt; or a similar library
to provide lenses:

&gt; data Config = Config
&gt;   { _cfHost :: String
&gt;   , _cfPort :: Int
&gt;   , _cfUser :: Maybe Text
&gt;   } deriving (Eq, Show)
&gt;
&gt; ''makeLenses Config

We can now define a basic specification of the type @'IniSpec' Config
()@ by using the provided operations to declare our top-level
sections, and then within those sections we can associate fields with
@Config@ lenses.

@
'configSpec' :: 'IniSpec' Config ()
'configSpec' = do
  'section' \&quot;NETWORK\&quot; $ do
    cfHost '.=' 'field' \&quot;host\&quot; 'string'
    cfPost '.=' 'field' \&quot;port\&quot; 'number'
  'sectionOpt' \&quot;LOCAL\&quot; $ do
    cfUser '.=?' 'field' \&quot;user\&quot; 'text'
@

There are two operators used to associate lenses with fields:

['.='] Associates a lens of type @Lens' s a@ with a field description
       of type @FieldDescription a@. By default, this will raise an
       error when parsing if the field described is missing, but we
       can mark it as optional, as we'll see.

['.=?'] Associates a lens of type @Lens' s (Maybe a)@ with a field
        description of type @FieldDescription a@. During parsing, if
        the value does not appear in an INI file, then the lens will
        be set to 'Nothing'; similarly, during serializing, if the
        value is 'Nothing', then the field will not be serialized in
        the file.

Each field must include the field's name as well as a 'FieldValue',
which describes how to both parse and serialize a value of a given
type. Several built-in 'FieldValue' descriptions are provided, but you
can always build your own by providing parsing and serialization
functions for individual fields.

We can also provide extra metadata about a field, allowing it to be
skipped durin parsing, or to provide an explicit default value, or to
include an explanatory comment for that value to be used when we
serialize an INI file. These are conventionally applied to the field
using the '&amp;' operator:

@
configSpec :: 'IniSpec' Config ()
configSpec = do
  'section' \&quot;NETWORK\&quot; $ do
    cfHost '.=' 'field' \&quot;host\&quot; 'string'
                &amp; 'comment' [\&quot;The desired hostname (optional)\&quot;]
                &amp; 'optional'
    cfPost '.=' 'field' \&quot;port\&quot; 'number'
                &amp; 'comment' [\&quot;The port number\&quot;]
  'sectionOpt' \&quot;LOCAL\&quot; $ do
    cfUser '.=?' 'field' \&quot;user\&quot; 'text'
@

When we want to use this specification, we need to create a value of
type 'Ini', which is an abstract representation of an INI
specification. To create an 'Ini' value, we need to use the 'ini'
function, which combines the spec with the default version of our
configuration value.

Once we have a value of type 'Ini', we can use it for three basic
operations:

* We can parse a textual INI file with 'parseIni', which will
  systematically walk the spec and use the provided lens/field
  associations to create a parsed configuration file. This will give
  us a new value of type 'Ini' that represents the parsed
  configuration, and we can extract the actual configuration value
  with 'getIniValue'.

* We can update the value contained in an 'Ini' value. If the 'Ini'
  value is the result of a previous call to 'parseIni', then this
  update will attempt to retain as much of the incidental structure of
  the parsed file as it can: for example, it will attempt to retain
  comments, whitespace, and ordering. The general strategy is to make
  the resulting INI file &quot;diff-minimal&quot;: the diff between the older
  INI file and the updated INI file should contain as little noise as
  possible. Small cosmetic choices such as how to treat generated
  comments are controlled by a configurable 'UpdatePolicy' value.

* We can serialize an 'Ini' value to a textual INI file. This will
  produce the specified INI file (either a default fresh INI, or a
  modified existing INI) as a textual value.

-}</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-133"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-134"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-135"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-136"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-137"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-138"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Ini.Config.Bidir</span><span>
</span><span id="line-141"></span><span class="hs-special">(</span><span>
</span><span id="line-142"></span><span class="annot"><span class="hs-comment">-- * Parsing, Serializing, and Updating Files</span></span><span>
</span><span id="line-143"></span><span class="annot"><span class="hs-comment">-- $using</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier">Ini</span></a></span><span>
</span><span id="line-145"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#ini"><span class="hs-identifier">ini</span></a></span><span>
</span><span id="line-146"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#getIniValue"><span class="hs-identifier">getIniValue</span></a></span><span>
</span><span id="line-147"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#iniValueL"><span class="hs-identifier">iniValueL</span></a></span><span>
</span><span id="line-148"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#getRawIni"><span class="hs-identifier">getRawIni</span></a></span><span>
</span><span id="line-149"></span><span class="annot"><span class="hs-comment">-- ** Parsing INI files</span></span><span>
</span><span id="line-150"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#parseIni"><span class="hs-identifier">parseIni</span></a></span><span>
</span><span id="line-151"></span><span class="annot"><span class="hs-comment">-- ** Serializing INI files</span></span><span>
</span><span id="line-152"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#serializeIni"><span class="hs-identifier">serializeIni</span></a></span><span>
</span><span id="line-153"></span><span class="annot"><span class="hs-comment">-- ** Updating INI Files</span></span><span>
</span><span id="line-154"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#updateIni"><span class="hs-identifier">updateIni</span></a></span><span>
</span><span id="line-155"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#setIniUpdatePolicy"><span class="hs-identifier">setIniUpdatePolicy</span></a></span><span>
</span><span id="line-156"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier">UpdatePolicy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdateCommentPolicy"><span class="hs-identifier">UpdateCommentPolicy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#defaultUpdatePolicy"><span class="hs-identifier">defaultUpdatePolicy</span></a></span><span>
</span><span id="line-159"></span><span class="annot"><span class="hs-comment">-- * Bidirectional Parser Types</span></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">-- $types</span></span><span>
</span><span id="line-161"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier">IniSpec</span></a></span><span>
</span><span id="line-162"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier">SectionSpec</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><span class="hs-comment">-- * Section-Level Parsing</span></span><span>
</span><span id="line-165"></span><span class="annot"><span class="hs-comment">-- $sections</span></span><span>
</span><span id="line-166"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#section"><span class="hs-identifier">section</span></a></span><span>
</span><span id="line-167"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#allOptional"><span class="hs-identifier">allOptional</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- * Field-Level Parsing</span></span><span>
</span><span id="line-170"></span><span class="annot"><span class="hs-comment">-- $fields</span></span><span>
</span><span id="line-171"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier">FieldDescription</span></a></span><span>
</span><span id="line-172"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#.%3D"><span class="hs-operator">(.=)</span></a></span><span>
</span><span id="line-173"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#.%3D%3F"><span class="hs-operator">(.=?)</span></a></span><span>
</span><span id="line-174"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#field"><span class="hs-identifier">field</span></a></span><span>
</span><span id="line-175"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#flag"><span class="hs-identifier">flag</span></a></span><span>
</span><span id="line-176"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#comment"><span class="hs-identifier">comment</span></a></span><span>
</span><span id="line-177"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#placeholderValue"><span class="hs-identifier">placeholderValue</span></a></span><span>
</span><span id="line-178"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#optional"><span class="hs-identifier">optional</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><span class="hs-comment">-- * FieldValues</span></span><span>
</span><span id="line-181"></span><span class="annot"><span class="hs-comment">-- $fieldvalues</span></span><span>
</span><span id="line-182"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier">FieldValue</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#text"><span class="hs-identifier">text</span></a></span><span>
</span><span id="line-184"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#string"><span class="hs-identifier">string</span></a></span><span>
</span><span id="line-185"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#number"><span class="hs-identifier">number</span></a></span><span>
</span><span id="line-186"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#bool"><span class="hs-identifier">bool</span></a></span><span>
</span><span id="line-187"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#readable"><span class="hs-identifier">readable</span></a></span><span>
</span><span id="line-188"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#listWithSeparator"><span class="hs-identifier">listWithSeparator</span></a></span><span>
</span><span id="line-189"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#pairWithSeparator"><span class="hs-identifier">pairWithSeparator</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><span class="hs-comment">-- * Miscellaneous Helpers</span></span><span>
</span><span id="line-192"></span><span class="annot"><span class="hs-comment">-- $misc</span></span><span>
</span><span id="line-193"></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span>
</span><span id="line-194"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier">Lens</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runState</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-200"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 710
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ViewL</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ViewR</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-207"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-209"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-210"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">typeRep</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsList</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Ini.Config.Raw.html"><span class="hs-identifier">Data.Ini.Config.Raw</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- * Utility functions + lens stuffs</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | This is a</span><span>
</span><span id="line-219"></span><span class="hs-comment">--   &lt;https://hackage.haskell.org/package/lens lens&gt;-compatible</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   type alias</span><span>
</span><span id="line-221"></span><span class="hs-keyword">type</span><span> </span><span id="Lens"><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-var">Lens</span></a></span></span><span> </span><span id="local-6989586621679054739"><span class="annot"><a href="#local-6989586621679054739"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679054738"><span class="annot"><a href="#local-6989586621679054738"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679054737"><span class="annot"><a href="#local-6989586621679054737"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679054736"><span class="annot"><a href="#local-6989586621679054736"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679054735"><span class="annot"><a href="#local-6989586621679054735"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679054735"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054737"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054735"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054736"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054739"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054735"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054738"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- These are some inline reimplementations of &quot;lens&quot; operators. We</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- need the identity functor to implement 'set':</span><span>
</span><span id="line-225"></span><span class="hs-keyword">newtype</span><span> </span><span id="I"><span class="annot"><a href="Data.Ini.Config.Bidir.html#I"><span class="hs-identifier hs-var">I</span></a></span></span><span> </span><span id="local-6989586621679055067"><span class="annot"><a href="#local-6989586621679055067"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="I"><span class="annot"><a href="Data.Ini.Config.Bidir.html#I"><span class="hs-identifier hs-var">I</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fromI"><span class="annot"><span class="annottext">I a -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#fromI"><span class="hs-identifier hs-var hs-var">fromI</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055067"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-226"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054730"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#I"><span class="hs-identifier hs-type">I</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054728"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; I a -&gt; I b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679054727"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679054727"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621679054726"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054726"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; I b
forall a. a -&gt; I a
</span><a href="Data.Ini.Config.Bidir.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679054727"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054726"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span id="local-6989586621679054821"><span id="local-6989586621679054822"><span id="local-6989586621679054823"><span id="local-6989586621679054824"><span class="annot"><a href="Data.Ini.Config.Bidir.html#set"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054824"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054823"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054821"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054821"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054824"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054823"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-229"></span><span id="set"><span class="annot"><span class="annottext">set :: Lens s t a b -&gt; b -&gt; s -&gt; t
</span><a href="Data.Ini.Config.Bidir.html#set"><span class="hs-identifier hs-var hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679054724"><span class="annot"><span class="annottext">Lens s t a b
</span><a href="#local-6989586621679054724"><span class="hs-identifier hs-var">lns</span></a></span></span><span> </span><span id="local-6989586621679054723"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679054723"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054722"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054722"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I t -&gt; t
forall a. I a -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#fromI"><span class="hs-identifier hs-var hs-var">fromI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; I b) -&gt; s -&gt; I t
Lens s t a b
</span><a href="#local-6989586621679054724"><span class="hs-identifier hs-var">lns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">I b -&gt; a -&gt; I b
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; I b
forall a. a -&gt; I a
</span><a href="Data.Ini.Config.Bidir.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679054723"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054722"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- ... and we need the const functor to implement 'get':</span><span>
</span><span id="line-232"></span><span class="hs-keyword">newtype</span><span> </span><span id="C"><span class="annot"><a href="Data.Ini.Config.Bidir.html#C"><span class="hs-identifier hs-var">C</span></a></span></span><span> </span><span id="local-6989586621679055051"><span class="annot"><a href="#local-6989586621679055051"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679055050"><span class="annot"><a href="#local-6989586621679055050"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="C"><span class="annot"><a href="Data.Ini.Config.Bidir.html#C"><span class="hs-identifier hs-var">C</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fromC"><span class="annot"><span class="annottext">C a b -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#fromC"><span class="hs-identifier hs-var hs-var">fromC</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-233"></span><span id="local-6989586621679054718"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679054715"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#C"><span class="hs-identifier hs-type">C</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054718"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054714"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; C a a -&gt; C a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#C"><span class="hs-identifier hs-type">C</span></a></span><span> </span><span id="local-6989586621679054713"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054713"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; C a b
forall a b. a -&gt; C a b
</span><a href="Data.Ini.Config.Bidir.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054713"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span id="local-6989586621679054810"><span id="local-6989586621679054811"><span id="local-6989586621679054812"><span id="local-6989586621679054813"><span class="annot"><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054813"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054812"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054811"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054810"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054813"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054811"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-236"></span><span id="get"><span class="annot"><span class="annottext">get :: Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621679054711"><span class="annot"><span class="annottext">Lens s t a b
</span><a href="#local-6989586621679054711"><span class="hs-identifier hs-var">lns</span></a></span></span><span> </span><span id="local-6989586621679054710"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054710"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">C a t -&gt; a
forall a b. C a b -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#fromC"><span class="hs-identifier hs-var hs-var">fromC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; C a b) -&gt; s -&gt; C a t
Lens s t a b
</span><a href="#local-6989586621679054711"><span class="hs-identifier hs-var">lns</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; C a b
forall a b. a -&gt; C a b
</span><a href="Data.Ini.Config.Bidir.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054710"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span id="local-6989586621679054829"><span class="annot"><a href="Data.Ini.Config.Bidir.html#lkp"><span class="hs-identifier hs-type">lkp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054829"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679054829"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-239"></span><span id="lkp"><span class="annot"><span class="annottext">lkp :: NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.Bidir.html#lkp"><span class="hs-identifier hs-var hs-var">lkp</span></a></span></span><span> </span><span id="local-6989586621679054708"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054708"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((NormalizedText, a) -&gt; a) -&gt; Maybe (NormalizedText, a) -&gt; Maybe a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(NormalizedText, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (NormalizedText, a) -&gt; Maybe a)
-&gt; (Seq (NormalizedText, a) -&gt; Maybe (NormalizedText, a))
-&gt; Seq (NormalizedText, a)
-&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((NormalizedText, a) -&gt; Bool)
-&gt; Seq (NormalizedText, a) -&gt; Maybe (NormalizedText, a)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">F.find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054705"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054705"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054705"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; NormalizedText -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054708"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span id="local-6989586621679054776"><span class="annot"><a href="Data.Ini.Config.Bidir.html#rmv"><span class="hs-identifier hs-type">rmv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054776"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054776"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-242"></span><span id="rmv"><span class="annot"><span class="annottext">rmv :: NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
</span><a href="Data.Ini.Config.Bidir.html#rmv"><span class="hs-identifier hs-var hs-var">rmv</span></a></span></span><span> </span><span id="local-6989586621679054703"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054703"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Field s -&gt; Bool) -&gt; Seq (Field s) -&gt; Seq (Field s)
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679054701"><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054701"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Field s -&gt; NormalizedText
forall s. Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054701"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; NormalizedText -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054703"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- The &amp; operator is really useful here, but it didn't show up in</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- earlier versions, so it gets redefined here.</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 710
</span><span class="hs-comment">{- | '&amp;' is a reverse application operator. This provides notational
     convenience. Its precedence is one higher than that of the
     forward application operator '$', which allows '&amp;' to be nested
     in '$'. -}</span><span>
</span><span id="line-251"></span><span class="hs-special">(</span><span class="hs-operator">&amp;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-252"></span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&amp;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-253"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&amp;</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- * The 'Ini' type</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | An 'Ini' is an abstract representation of an INI file, including</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- both its textual representation and the Haskell value it</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- represents.</span><span>
</span><span id="line-261"></span><span class="hs-keyword">data</span><span> </span><span id="Ini"><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-var">Ini</span></a></span></span><span> </span><span id="local-6989586621679055017"><span class="annot"><a href="#local-6989586621679055017"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Ini"><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-var">Ini</span></a></span></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="iniSpec"><span class="annot"><span class="annottext">Ini s -&gt; Spec s
</span><a href="Data.Ini.Config.Bidir.html#iniSpec"><span class="hs-identifier hs-var hs-var">iniSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055017"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="iniCurr"><span class="annot"><span class="annottext">Ini s -&gt; s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var hs-var">iniCurr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055017"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="iniDef"><span class="annot"><span class="annottext">Ini s -&gt; s
</span><a href="Data.Ini.Config.Bidir.html#iniDef"><span class="hs-identifier hs-var hs-var">iniDef</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055017"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="iniLast"><span class="annot"><span class="annottext">Ini s -&gt; Maybe RawIni
</span><a href="Data.Ini.Config.Bidir.html#iniLast"><span class="hs-identifier hs-var hs-var">iniLast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="iniPol"><span class="annot"><span class="annottext">Ini s -&gt; UpdatePolicy
</span><a href="Data.Ini.Config.Bidir.html#iniPol"><span class="hs-identifier hs-var hs-var">iniPol</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-type">UpdatePolicy</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Create a basic 'Ini' value from a default value and a spec.</span><span>
</span><span id="line-270"></span><span id="local-6989586621679054692"><span class="annot"><a href="Data.Ini.Config.Bidir.html#ini"><span class="hs-identifier hs-type">ini</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054692"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-type">IniSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054692"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054692"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-271"></span><span id="ini"><span class="annot"><span class="annottext">ini :: s -&gt; IniSpec s () -&gt; Ini s
</span><a href="Data.Ini.Config.Bidir.html#ini"><span class="hs-identifier hs-var hs-var">ini</span></a></span></span><span> </span><span id="local-6989586621679054691"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054691"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-type">IniSpec</span></a></span><span> </span><span id="local-6989586621679054689"><span class="annot"><span class="annottext">BidirM (Section s) ()
</span><a href="#local-6989586621679054689"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ini :: forall s. Spec s -&gt; s -&gt; s -&gt; Maybe RawIni -&gt; UpdatePolicy -&gt; Ini s
</span><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniSpec :: Spec s
</span><a href="Data.Ini.Config.Bidir.html#iniSpec"><span class="hs-identifier hs-var">iniSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BidirM (Section s) () -&gt; Spec s
forall s a. BidirM s a -&gt; Seq s
</span><a href="Data.Ini.Config.Bidir.html#runBidirM"><span class="hs-identifier hs-var">runBidirM</span></a></span><span> </span><span class="annot"><span class="annottext">BidirM (Section s) ()
</span><a href="#local-6989586621679054689"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniCurr :: s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var">iniCurr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054691"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniDef :: s
</span><a href="Data.Ini.Config.Bidir.html#iniDef"><span class="hs-identifier hs-var">iniDef</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054691"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniLast :: Maybe RawIni
</span><a href="Data.Ini.Config.Bidir.html#iniLast"><span class="hs-identifier hs-var">iniLast</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe RawIni
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniPol :: UpdatePolicy
</span><a href="Data.Ini.Config.Bidir.html#iniPol"><span class="hs-identifier hs-var">iniPol</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="Data.Ini.Config.Bidir.html#defaultUpdatePolicy"><span class="hs-identifier hs-var">defaultUpdatePolicy</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Get the underlying Haskell value associated with the 'Ini'.</span><span>
</span><span id="line-280"></span><span id="local-6989586621679054687"><span class="annot"><a href="Data.Ini.Config.Bidir.html#getIniValue"><span class="hs-identifier hs-type">getIniValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054687"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054687"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-281"></span><span id="getIniValue"><span class="annot"><span class="annottext">getIniValue :: Ini s -&gt; s
</span><a href="Data.Ini.Config.Bidir.html#getIniValue"><span class="hs-identifier hs-var hs-var">getIniValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ini s -&gt; s
forall s. Ini s -&gt; s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var hs-var">iniCurr</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span id="local-6989586621679055006"><span id="local-6989586621679055007"><span class="annot"><a href="Data.Ini.Config.Bidir.html#mkLens"><span class="hs-identifier hs-type">mkLens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679055007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679055006"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679055006"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679055007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679055007"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055006"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055006"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-284"></span><span id="mkLens"><span class="annot"><span class="annottext">mkLens :: (a -&gt; b) -&gt; (b -&gt; a -&gt; a) -&gt; Lens a a b b
</span><a href="Data.Ini.Config.Bidir.html#mkLens"><span class="hs-identifier hs-var hs-var">mkLens</span></a></span></span><span> </span><span id="local-6989586621679054685"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679054685"><span class="hs-identifier hs-var">get'</span></a></span></span><span> </span><span id="local-6989586621679054684"><span class="annot"><span class="annottext">b -&gt; a -&gt; a
</span><a href="#local-6989586621679054684"><span class="hs-identifier hs-var">set'</span></a></span></span><span> </span><span id="local-6989586621679054683"><span class="annot"><span class="annottext">b -&gt; f b
</span><a href="#local-6989586621679054683"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679054682"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054682"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; a -&gt; a
</span><a href="#local-6989586621679054684"><span class="hs-operator hs-var">`set'`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054682"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b -&gt; a) -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; f b
</span><a href="#local-6989586621679054683"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679054685"><span class="hs-identifier hs-var">get'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054682"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | The lens equivalent of 'getIniValue'</span><span>
</span><span id="line-287"></span><span id="local-6989586621679054681"><span class="annot"><a href="Data.Ini.Config.Bidir.html#iniValueL"><span class="hs-identifier hs-type">iniValueL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054681"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054681"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679054681"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054681"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-288"></span><span id="iniValueL"><span class="annot"><span class="annottext">iniValueL :: (s -&gt; f s) -&gt; Ini s -&gt; f (Ini s)
</span><a href="Data.Ini.Config.Bidir.html#iniValueL"><span class="hs-identifier hs-var hs-var">iniValueL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ini s -&gt; s) -&gt; (s -&gt; Ini s -&gt; Ini s) -&gt; Lens (Ini s) (Ini s) s s
forall a b. (a -&gt; b) -&gt; (b -&gt; a -&gt; a) -&gt; Lens a a b b
</span><a href="Data.Ini.Config.Bidir.html#mkLens"><span class="hs-identifier hs-var">mkLens</span></a></span><span> </span><span class="annot"><span class="annottext">Ini s -&gt; s
forall s. Ini s -&gt; s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var hs-var">iniCurr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679054680"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054680"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679054679"><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniCurr :: s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var">iniCurr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054680"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Get the textual representation of an 'Ini' value. If this 'Ini'</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- value is the result of 'parseIni', then it will attempt to retain</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- the textual characteristics of the parsed version as much as</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- possible (e.g. by retaining comments, ordering, and whitespace in a</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- way that will minimize the overall diff footprint.) If the 'Ini'</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- value was created directly from a value and a specification, then</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- it will pretty-print an initial version of the file with the</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- comments and placeholder text specified in the spec.</span><span>
</span><span id="line-298"></span><span id="local-6989586621679054678"><span class="annot"><a href="Data.Ini.Config.Bidir.html#serializeIni"><span class="hs-identifier hs-type">serializeIni</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054678"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span></span><span>
</span><span id="line-299"></span><span id="serializeIni"><span class="annot"><span class="annottext">serializeIni :: Ini s -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#serializeIni"><span class="hs-identifier hs-var hs-var">serializeIni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawIni -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#printRawIni"><span class="hs-identifier hs-var">printRawIni</span></a></span><span> </span><span class="annot"><span class="annottext">(RawIni -&gt; Text) -&gt; (Ini s -&gt; RawIni) -&gt; Ini s -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ini s -&gt; RawIni
forall s. Ini s -&gt; RawIni
</span><a href="Data.Ini.Config.Bidir.html#getRawIni"><span class="hs-identifier hs-var">getRawIni</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-comment">-- | Get the underlying 'RawIni' value for the file.</span><span>
</span><span id="line-302"></span><span id="local-6989586621679055003"><span class="annot"><a href="Data.Ini.Config.Bidir.html#getRawIni"><span class="hs-identifier hs-type">getRawIni</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055003"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span></span><span>
</span><span id="line-303"></span><span id="getRawIni"><span class="annot"><span class="annottext">getRawIni :: Ini s -&gt; RawIni
</span><a href="Data.Ini.Config.Bidir.html#getRawIni"><span class="hs-identifier hs-var hs-var">getRawIni</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniLast :: forall s. Ini s -&gt; Maybe RawIni
</span><a href="Data.Ini.Config.Bidir.html#iniLast"><span class="hs-identifier hs-var">iniLast</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054676"><span class="annot"><span class="annottext">RawIni
</span><a href="#local-6989586621679054676"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawIni
</span><a href="#local-6989586621679054676"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#getRawIni"><span class="hs-identifier hs-var">getRawIni</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniCurr :: forall s. Ini s -&gt; s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var">iniCurr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054675"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054675"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-305"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniSpec :: forall s. Ini s -&gt; Spec s
</span><a href="Data.Ini.Config.Bidir.html#iniSpec"><span class="hs-identifier hs-var">iniSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054674"><span class="annot"><span class="annottext">Spec s
</span><a href="#local-6989586621679054674"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-306"></span><span>               </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; Spec s -&gt; RawIni
forall s. s -&gt; Spec s -&gt; RawIni
</span><a href="Data.Ini.Config.Bidir.html#emitIniFile"><span class="hs-identifier hs-var">emitIniFile</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054675"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Spec s
</span><a href="#local-6989586621679054674"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | Parse a textual representation of an 'Ini' file. If the file is</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- malformed or if an obligatory field is not found, this will produce</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- a human-readable error message. If an optional field is not found,</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- then it will fall back on the existing value contained in the</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- provided 'Ini' structure.</span><span>
</span><span id="line-313"></span><span id="local-6989586621679054672"><span class="annot"><a href="Data.Ini.Config.Bidir.html#parseIni"><span class="hs-identifier hs-type">parseIni</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-314"></span><span id="parseIni"><span class="annot"><span class="annottext">parseIni :: Text -&gt; Ini s -&gt; Either String (Ini s)
</span><a href="Data.Ini.Config.Bidir.html#parseIni"><span class="hs-identifier hs-var hs-var">parseIni</span></a></span></span><span> </span><span id="local-6989586621679054671"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054671"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679054670"><span class="annot"><span class="annottext">i :: Ini s
</span><a href="#local-6989586621679054670"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniSpec :: forall s. Ini s -&gt; Spec s
</span><a href="Data.Ini.Config.Bidir.html#iniSpec"><span class="hs-identifier hs-var">iniSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054669"><span class="annot"><span class="annottext">Spec s
</span><a href="#local-6989586621679054669"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-315"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniCurr :: forall s. Ini s -&gt; s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var">iniCurr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054668"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054668"><span class="hs-identifier hs-var">def</span></a></span></span><span>
</span><span id="line-316"></span><span>                 </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span id="local-6989586621679054666"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054666"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String RawIni
</span><a href="Data.Ini.Config.Raw.html#parseRawIni"><span class="hs-identifier hs-var">parseRawIni</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054671"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679054664"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054664"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">s
-&gt; ViewL (Section s)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Either String s
forall s.
s
-&gt; ViewL (Section s)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseSections"><span class="hs-identifier hs-var">parseSections</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054668"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec s -&gt; ViewL (Section s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Spec s
</span><a href="#local-6989586621679054669"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054666"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="annottext">Ini s -&gt; Either String (Ini s)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Ini s -&gt; Either String (Ini s)) -&gt; Ini s -&gt; Either String (Ini s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054670"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniCurr :: s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var">iniCurr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054664"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniLast :: Maybe RawIni
</span><a href="Data.Ini.Config.Bidir.html#iniLast"><span class="hs-identifier hs-var">iniLast</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawIni -&gt; Maybe RawIni
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection) -&gt; RawIni
</span><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-var">RawIni</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054666"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | Update the internal value of an 'Ini' file. If this 'Ini' value</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- is the result of 'parseIni', then the resulting 'Ini' value will</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- attempt to retain the textual characteristics of the parsed version</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- as much as possible (e.g. by retaining comments, ordering, and</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- whitespace in a way that will minimize the overall diff footprint.)</span><span>
</span><span id="line-329"></span><span id="local-6989586621679054661"><span class="annot"><a href="Data.Ini.Config.Bidir.html#updateIni"><span class="hs-identifier hs-type">updateIni</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054661"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054661"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054661"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-330"></span><span id="updateIni"><span class="annot"><span class="annottext">updateIni :: s -&gt; Ini s -&gt; Ini s
</span><a href="Data.Ini.Config.Bidir.html#updateIni"><span class="hs-identifier hs-var hs-var">updateIni</span></a></span></span><span> </span><span id="local-6989586621679054660"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054660"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span id="local-6989586621679054659"><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054659"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">s -&gt; Ini s -&gt; Either String (Ini s)
forall s. s -&gt; Ini s -&gt; Either String (Ini s)
</span><a href="Data.Ini.Config.Bidir.html#doUpdateIni"><span class="hs-identifier hs-var">doUpdateIni</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054660"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054659"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679054657"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054657"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Ini s
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054657"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679054655"><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054655"><span class="hs-identifier hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054655"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | Use the provided 'UpdatePolicy' as a guide when creating future</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- updated versions of the given 'Ini' value.</span><span>
</span><span id="line-337"></span><span id="local-6989586621679054654"><span class="annot"><a href="Data.Ini.Config.Bidir.html#setIniUpdatePolicy"><span class="hs-identifier hs-type">setIniUpdatePolicy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-type">UpdatePolicy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054654"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054654"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-338"></span><span id="setIniUpdatePolicy"><span class="annot"><span class="annottext">setIniUpdatePolicy :: UpdatePolicy -&gt; Ini s -&gt; Ini s
</span><a href="Data.Ini.Config.Bidir.html#setIniUpdatePolicy"><span class="hs-identifier hs-var hs-var">setIniUpdatePolicy</span></a></span></span><span> </span><span id="local-6989586621679054653"><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054653"><span class="hs-identifier hs-var">pol</span></a></span></span><span> </span><span id="local-6989586621679054652"><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054652"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054652"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniPol :: UpdatePolicy
</span><a href="Data.Ini.Config.Bidir.html#iniPol"><span class="hs-identifier hs-var">iniPol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054653"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- * Type definitions</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | A value of type 'FieldValue' packages up a parser and emitter</span><span>
</span><span id="line-343"></span><span class="hs-comment">--   function into a single value. These are used for bidirectional</span><span>
</span><span id="line-344"></span><span class="hs-comment">--   parsing and emitting of the value of a field.</span><span>
</span><span id="line-345"></span><span class="hs-keyword">data</span><span> </span><span id="FieldValue"><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-var">FieldValue</span></a></span></span><span> </span><span id="local-6989586621679054859"><span class="annot"><a href="#local-6989586621679054859"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FieldValue"><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-var">FieldValue</span></a></span></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="fvParse"><span class="annot"><span class="annottext">FieldValue a -&gt; Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var hs-var">fvParse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679054859"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-comment">-- ^ The function to use when parsing the value of a field; if</span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-comment">--   the parser fails, then the string will be shown as an error</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-comment">--   message to the user.</span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fvEmit"><span class="annot"><span class="annottext">FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-comment">-- ^ The function to use when serializing a value into an INI</span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-comment">-- file.</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-comment">-- This is actually being used as a writer monad, but using a state</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- monad lets us avoid the space leaks. Not that those are likely to</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- be a problem in this application, but it's not like it cost us</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- none.</span><span>
</span><span id="line-359"></span><span class="hs-keyword">type</span><span> </span><span id="BidirM"><span class="annot"><a href="Data.Ini.Config.Bidir.html#BidirM"><span class="hs-identifier hs-var">BidirM</span></a></span></span><span> </span><span id="local-6989586621679054648"><span class="annot"><a href="#local-6989586621679054648"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679054647"><span class="annot"><a href="#local-6989586621679054647"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679054648"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679054647"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span id="local-6989586621679055015"><span id="local-6989586621679055016"><span class="annot"><a href="Data.Ini.Config.Bidir.html#runBidirM"><span class="hs-identifier hs-type">runBidirM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#BidirM"><span class="hs-identifier hs-type">BidirM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055016"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679055016"><span class="hs-identifier hs-type">s</span></a></span></span></span><span>
</span><span id="line-362"></span><span id="runBidirM"><span class="annot"><span class="annottext">runBidirM :: BidirM s a -&gt; Seq s
</span><a href="Data.Ini.Config.Bidir.html#runBidirM"><span class="hs-identifier hs-var hs-var">runBidirM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Seq s) -&gt; Seq s
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((a, Seq s) -&gt; Seq s)
-&gt; (BidirM s a -&gt; (a, Seq s)) -&gt; BidirM s a -&gt; Seq s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(BidirM s a -&gt; Seq s -&gt; (a, Seq s))
-&gt; Seq s -&gt; BidirM s a -&gt; (a, Seq s)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">BidirM s a -&gt; Seq s -&gt; (a, Seq s)
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">runState</span></span><span> </span><span class="annot"><span class="annottext">Seq s
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-keyword">type</span><span> </span><span id="Spec"><span class="annot"><a href="Data.Ini.Config.Bidir.html#Spec"><span class="hs-identifier hs-var">Spec</span></a></span></span><span> </span><span id="local-6989586621679054644"><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054644"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | An 'IniSpec' value represents the structure of an entire</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- INI-format file in a declarative way. The @s@ parameter represents</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- the type of a Haskell structure which is being serialized to or</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- from.</span><span>
</span><span id="line-370"></span><span class="hs-keyword">newtype</span><span> </span><span id="IniSpec"><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-var">IniSpec</span></a></span></span><span> </span><span id="local-6989586621679054910"><span class="annot"><a href="#local-6989586621679054910"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679054909"><span class="annot"><a href="#local-6989586621679054909"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IniSpec"><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-var">IniSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#BidirM"><span class="hs-identifier hs-type">BidirM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054910"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679054909"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054640"><span id="local-6989586621679054642"><span class="annot"><span class="annottext">a -&gt; IniSpec s b -&gt; IniSpec s a
(a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
(forall a b. (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b)
-&gt; (forall a b. a -&gt; IniSpec s b -&gt; IniSpec s a)
-&gt; Functor (IniSpec s)
forall a b. a -&gt; IniSpec s b -&gt; IniSpec s a
forall a b. (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
forall s a b. a -&gt; IniSpec s b -&gt; IniSpec s a
forall s a b. (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; IniSpec s b -&gt; IniSpec s a
$c&lt;$ :: forall s a b. a -&gt; IniSpec s b -&gt; IniSpec s a
fmap :: (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
$cfmap :: forall s a b. (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054629"><span id="local-6989586621679054631"><span id="local-6989586621679054633"><span id="local-6989586621679054635"><span id="local-6989586621679054637"><span class="annot"><span class="annottext">Functor (IniSpec s)
a -&gt; IniSpec s a
Functor (IniSpec s)
-&gt; (forall a. a -&gt; IniSpec s a)
-&gt; (forall a b. IniSpec s (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s c)
-&gt; (forall a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b)
-&gt; (forall a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s a)
-&gt; Applicative (IniSpec s)
IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s a
IniSpec s (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
(a -&gt; b -&gt; c) -&gt; IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s c
forall s. Functor (IniSpec s)
forall a. a -&gt; IniSpec s a
forall s a. a -&gt; IniSpec s a
forall a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s a
forall a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
forall a b. IniSpec s (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
forall s a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s a
forall s a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
forall s a b. IniSpec s (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
forall a b c.
(a -&gt; b -&gt; c) -&gt; IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s c
forall s a b c.
(a -&gt; b -&gt; c) -&gt; IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s a
$c&lt;* :: forall s a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s a
*&gt; :: IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
$c*&gt; :: forall s a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
liftA2 :: (a -&gt; b -&gt; c) -&gt; IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s c
$cliftA2 :: forall s a b c.
(a -&gt; b -&gt; c) -&gt; IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s c
&lt;*&gt; :: IniSpec s (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
$c&lt;*&gt; :: forall s a b. IniSpec s (a -&gt; b) -&gt; IniSpec s a -&gt; IniSpec s b
pure :: a -&gt; IniSpec s a
$cpure :: forall s a. a -&gt; IniSpec s a
$cp1Applicative :: forall s. Functor (IniSpec s)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054621"><span id="local-6989586621679054623"><span id="local-6989586621679054625"><span class="annot"><span class="annottext">Applicative (IniSpec s)
a -&gt; IniSpec s a
Applicative (IniSpec s)
-&gt; (forall a b. IniSpec s a -&gt; (a -&gt; IniSpec s b) -&gt; IniSpec s b)
-&gt; (forall a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b)
-&gt; (forall a. a -&gt; IniSpec s a)
-&gt; Monad (IniSpec s)
IniSpec s a -&gt; (a -&gt; IniSpec s b) -&gt; IniSpec s b
IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
forall s. Applicative (IniSpec s)
forall a. a -&gt; IniSpec s a
forall s a. a -&gt; IniSpec s a
forall a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
forall a b. IniSpec s a -&gt; (a -&gt; IniSpec s b) -&gt; IniSpec s b
forall s a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
forall s a b. IniSpec s a -&gt; (a -&gt; IniSpec s b) -&gt; IniSpec s b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; IniSpec s a
$creturn :: forall s a. a -&gt; IniSpec s a
&gt;&gt; :: IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
$c&gt;&gt; :: forall s a b. IniSpec s a -&gt; IniSpec s b -&gt; IniSpec s b
&gt;&gt;= :: IniSpec s a -&gt; (a -&gt; IniSpec s b) -&gt; IniSpec s b
$c&gt;&gt;= :: forall s a b. IniSpec s a -&gt; (a -&gt; IniSpec s b) -&gt; IniSpec s b
$cp1Monad :: forall s. Applicative (IniSpec s)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-comment">-- | A 'SectionSpec' value represents the structure of a single</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- section of an INI-format file in a declarative way. The @s@</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- parameter represents the type of a Haskell structure which is being</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- serialized to or from.</span><span>
</span><span id="line-377"></span><span class="hs-keyword">newtype</span><span> </span><span id="SectionSpec"><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-var">SectionSpec</span></a></span></span><span> </span><span id="local-6989586621679054871"><span class="annot"><a href="#local-6989586621679054871"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679054870"><span class="annot"><a href="#local-6989586621679054870"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SectionSpec"><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-var">SectionSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#BidirM"><span class="hs-identifier hs-type">BidirM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054871"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679054870"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054615"><span id="local-6989586621679054617"><span class="annot"><span class="annottext">a -&gt; SectionSpec s b -&gt; SectionSpec s a
(a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
(forall a b. (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b)
-&gt; (forall a b. a -&gt; SectionSpec s b -&gt; SectionSpec s a)
-&gt; Functor (SectionSpec s)
forall a b. a -&gt; SectionSpec s b -&gt; SectionSpec s a
forall a b. (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
forall s a b. a -&gt; SectionSpec s b -&gt; SectionSpec s a
forall s a b. (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; SectionSpec s b -&gt; SectionSpec s a
$c&lt;$ :: forall s a b. a -&gt; SectionSpec s b -&gt; SectionSpec s a
fmap :: (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
$cfmap :: forall s a b. (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054604"><span id="local-6989586621679054606"><span id="local-6989586621679054608"><span id="local-6989586621679054610"><span id="local-6989586621679054612"><span class="annot"><span class="annottext">Functor (SectionSpec s)
a -&gt; SectionSpec s a
Functor (SectionSpec s)
-&gt; (forall a. a -&gt; SectionSpec s a)
-&gt; (forall a b.
    SectionSpec s (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s c)
-&gt; (forall a b.
    SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b)
-&gt; (forall a b.
    SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s a)
-&gt; Applicative (SectionSpec s)
SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s a
SectionSpec s (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
(a -&gt; b -&gt; c)
-&gt; SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s c
forall s. Functor (SectionSpec s)
forall a. a -&gt; SectionSpec s a
forall s a. a -&gt; SectionSpec s a
forall a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s a
forall a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
forall a b.
SectionSpec s (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
forall s a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s a
forall s a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
forall s a b.
SectionSpec s (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s c
forall s a b c.
(a -&gt; b -&gt; c)
-&gt; SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s a
$c&lt;* :: forall s a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s a
*&gt; :: SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
$c*&gt; :: forall s a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
liftA2 :: (a -&gt; b -&gt; c)
-&gt; SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s c
$cliftA2 :: forall s a b c.
(a -&gt; b -&gt; c)
-&gt; SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s c
&lt;*&gt; :: SectionSpec s (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
$c&lt;*&gt; :: forall s a b.
SectionSpec s (a -&gt; b) -&gt; SectionSpec s a -&gt; SectionSpec s b
pure :: a -&gt; SectionSpec s a
$cpure :: forall s a. a -&gt; SectionSpec s a
$cp1Applicative :: forall s. Functor (SectionSpec s)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054597"><span id="local-6989586621679054599"><span id="local-6989586621679054601"><span class="annot"><span class="annottext">Applicative (SectionSpec s)
a -&gt; SectionSpec s a
Applicative (SectionSpec s)
-&gt; (forall a b.
    SectionSpec s a -&gt; (a -&gt; SectionSpec s b) -&gt; SectionSpec s b)
-&gt; (forall a b.
    SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b)
-&gt; (forall a. a -&gt; SectionSpec s a)
-&gt; Monad (SectionSpec s)
SectionSpec s a -&gt; (a -&gt; SectionSpec s b) -&gt; SectionSpec s b
SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
forall s. Applicative (SectionSpec s)
forall a. a -&gt; SectionSpec s a
forall s a. a -&gt; SectionSpec s a
forall a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
forall a b.
SectionSpec s a -&gt; (a -&gt; SectionSpec s b) -&gt; SectionSpec s b
forall s a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
forall s a b.
SectionSpec s a -&gt; (a -&gt; SectionSpec s b) -&gt; SectionSpec s b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; SectionSpec s a
$creturn :: forall s a. a -&gt; SectionSpec s a
&gt;&gt; :: SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
$c&gt;&gt; :: forall s a b. SectionSpec s a -&gt; SectionSpec s b -&gt; SectionSpec s b
&gt;&gt;= :: SectionSpec s a -&gt; (a -&gt; SectionSpec s b) -&gt; SectionSpec s b
$c&gt;&gt;= :: forall s a b.
SectionSpec s a -&gt; (a -&gt; SectionSpec s b) -&gt; SectionSpec s b
$cp1Monad :: forall s. Applicative (SectionSpec s)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- * Sections</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | Define the specification of a top-level INI section.</span><span>
</span><span id="line-383"></span><span id="local-6989586621679054596"><span class="annot"><a href="Data.Ini.Config.Bidir.html#section"><span class="hs-identifier hs-type">section</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-type">SectionSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-type">IniSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-384"></span><span id="section"><span class="annot"><span class="annottext">section :: Text -&gt; SectionSpec s () -&gt; IniSpec s ()
</span><a href="Data.Ini.Config.Bidir.html#section"><span class="hs-identifier hs-var hs-var">section</span></a></span></span><span> </span><span id="local-6989586621679054595"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054595"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-type">SectionSpec</span></a></span><span> </span><span id="local-6989586621679054594"><span class="annot"><span class="annottext">BidirM (Field s) ()
</span><a href="#local-6989586621679054594"><span class="hs-identifier hs-var">mote</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BidirM (Section s) () -&gt; IniSpec s ()
forall s a. BidirM (Section s) a -&gt; IniSpec s a
</span><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-var">IniSpec</span></a></span><span> </span><span class="annot"><span class="annottext">(BidirM (Section s) () -&gt; IniSpec s ())
-&gt; BidirM (Section s) () -&gt; IniSpec s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054593"><span class="annot"><span class="annottext">fields :: Seq (Field s)
</span><a href="#local-6989586621679054593"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BidirM (Field s) () -&gt; Seq (Field s)
forall s a. BidirM s a -&gt; Seq s
</span><a href="Data.Ini.Config.Bidir.html#runBidirM"><span class="hs-identifier hs-var">runBidirM</span></a></span><span> </span><span class="annot"><span class="annottext">BidirM (Field s) ()
</span><a href="#local-6989586621679054594"><span class="hs-identifier hs-var">mote</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><span class="annottext">(Seq (Section s) -&gt; Seq (Section s)) -&gt; BidirM (Section s) ()
forall (m :: * -&gt; *) s. Monad m =&gt; (s -&gt; s) -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Section s) -&gt; Section s -&gt; Seq (Section s)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">Seq.|&gt;</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (Field s) -&gt; Bool -&gt; Section s
forall s. NormalizedText -&gt; Seq (Field s) -&gt; Bool -&gt; Section s
</span><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NormalizedText
</span><a href="Data.Ini.Config.Raw.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054595"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054593"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; Bool
forall s. Seq (Field s) -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#allFieldsOptional"><span class="hs-identifier hs-var">allFieldsOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054593"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span id="local-6989586621679054903"><span class="annot"><a href="Data.Ini.Config.Bidir.html#allFieldsOptional"><span class="hs-identifier hs-type">allFieldsOptional</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054903"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-389"></span><span id="allFieldsOptional"><span class="annot"><span class="annottext">allFieldsOptional :: Seq (Field s) -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#allFieldsOptional"><span class="hs-identifier hs-var hs-var">allFieldsOptional</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Field s -&gt; Bool) -&gt; Seq (Field s) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Field s -&gt; Bool
forall s. Field s -&gt; Bool
</span><a href="#local-6989586621679054587"><span class="hs-identifier hs-var">isOptional</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054587"><span class="annot"><span class="annottext">isOptional :: Field s -&gt; Bool
</span><a href="#local-6989586621679054587"><span class="hs-identifier hs-var hs-var">isOptional</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span>   </span><span class="annot"><span class="annottext">Lens s s a a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054585"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054585"><span class="hs-identifier hs-var">fd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldDescription a -&gt; Bool
forall t. FieldDescription t -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#fdSkipIfMissing"><span class="hs-identifier hs-var hs-var">fdSkipIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054585"><span class="hs-identifier hs-var">fd</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><a href="#local-6989586621679054587"><span class="hs-identifier hs-var">isOptional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Treat an entire section as containing entirely optional fields.</span><span>
</span><span id="line-394"></span><span id="local-6989586621679054582"><span class="annot"><a href="Data.Ini.Config.Bidir.html#allOptional"><span class="hs-identifier hs-type">allOptional</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-type">SectionSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054582"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-type">IniSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054582"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-type">SectionSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054582"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-type">IniSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054582"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-397"></span><span id="allOptional"><span class="annot"><span class="annottext">allOptional :: (SectionSpec s () -&gt; IniSpec s ())
-&gt; SectionSpec s () -&gt; IniSpec s ()
</span><a href="Data.Ini.Config.Bidir.html#allOptional"><span class="hs-identifier hs-var hs-var">allOptional</span></a></span></span><span> </span><span id="local-6989586621679054581"><span class="annot"><span class="annottext">SectionSpec s () -&gt; IniSpec s ()
</span><a href="#local-6989586621679054581"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679054580"><span class="annot"><span class="annottext">SectionSpec s ()
</span><a href="#local-6989586621679054580"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BidirM (Section s) () -&gt; IniSpec s ()
forall s a. BidirM (Section s) a -&gt; IniSpec s a
</span><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-var">IniSpec</span></a></span><span> </span><span class="annot"><span class="annottext">(BidirM (Section s) () -&gt; IniSpec s ())
-&gt; BidirM (Section s) () -&gt; IniSpec s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#IniSpec"><span class="hs-identifier hs-type">IniSpec</span></a></span><span> </span><span id="local-6989586621679054579"><span class="annot"><span class="annottext">BidirM (Section s) ()
</span><a href="#local-6989586621679054579"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SectionSpec s () -&gt; IniSpec s ()
</span><a href="#local-6989586621679054581"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">SectionSpec s ()
</span><a href="#local-6989586621679054580"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="annottext">BidirM (Section s) ()
</span><a href="#local-6989586621679054579"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><span class="annottext">(Seq (Section s) -&gt; Seq (Section s)) -&gt; BidirM (Section s) ()
forall (m :: * -&gt; *) s. Monad m =&gt; (s -&gt; s) -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679054578"><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054578"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq (Section s) -&gt; ViewR (Section s)
forall a. Seq a -&gt; ViewR a
</span><span class="hs-identifier hs-var">Seq.viewr</span></span><span> </span><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054578"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-401"></span><span>             </span><span class="annot"><span class="annottext">ViewR (Section s)
</span><span class="hs-identifier hs-var">EmptyR</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054578"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-402"></span><span>             </span><span id="local-6989586621679054575"><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054575"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span id="local-6989586621679054573"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054573"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054572"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054572"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>               </span><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054575"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Section s) -&gt; Section s -&gt; Seq (Section s)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">Seq.|&gt;</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (Field s) -&gt; Bool -&gt; Section s
forall s. NormalizedText -&gt; Seq (Field s) -&gt; Bool -&gt; Section s
</span><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054573"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Field s -&gt; Field s) -&gt; Seq (Field s) -&gt; Seq (Field s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Field s -&gt; Field s
forall s. Field s -&gt; Field s
</span><a href="Data.Ini.Config.Bidir.html#makeOptional"><span class="hs-identifier hs-var">makeOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054572"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span id="local-6989586621679054891"><span class="annot"><a href="Data.Ini.Config.Bidir.html#makeOptional"><span class="hs-identifier hs-type">makeOptional</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054891"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054891"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-406"></span><span id="makeOptional"><span class="annot"><span class="annottext">makeOptional :: Field s -&gt; Field s
</span><a href="Data.Ini.Config.Bidir.html#makeOptional"><span class="hs-identifier hs-var hs-var">makeOptional</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span id="local-6989586621679054570"><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054570"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054569"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054569"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens s s a a -&gt; FieldDescription a -&gt; Field s
forall s a. Eq a =&gt; Lens s s a a -&gt; FieldDescription a -&gt; Field s
</span><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054570"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054569"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdSkipIfMissing :: Bool
</span><a href="Data.Ini.Config.Bidir.html#fdSkipIfMissing"><span class="hs-identifier hs-var">fdSkipIfMissing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-407"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#makeOptional"><span class="hs-identifier hs-var">makeOptional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span id="local-6989586621679054568"><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054568"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054567"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054567"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a) -&gt; FieldDescription a -&gt; Field s
forall s a.
Eq a =&gt;
Lens s s (Maybe a) (Maybe a) -&gt; FieldDescription a -&gt; Field s
</span><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-var">FieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054568"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054567"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdSkipIfMissing :: Bool
</span><a href="Data.Ini.Config.Bidir.html#fdSkipIfMissing"><span class="hs-identifier hs-var">fdSkipIfMissing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">data</span><span> </span><span id="Section"><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-var">Section</span></a></span></span><span> </span><span id="local-6989586621679054904"><span class="annot"><a href="#local-6989586621679054904"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Section"><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-var">Section</span></a></span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054904"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- * Fields</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">-- | A &quot;Field&quot; is a description of</span><span>
</span><span id="line-414"></span><span class="hs-keyword">data</span><span> </span><span id="Field"><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-var">Field</span></a></span></span><span> </span><span id="local-6989586621679054887"><span class="annot"><a href="#local-6989586621679054887"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679054888"><span class="annot"><a href="#local-6989586621679054888"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679054888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Field"><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-var">Field</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054887"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054887"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679054885"><span class="annot"><a href="#local-6989586621679054885"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679054885"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="FieldMb"><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-var">FieldMb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054887"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054887"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679054885"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679054885"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054885"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- convenience accessors for things in a Field</span><span>
</span><span id="line-419"></span><span id="local-6989586621679055031"><span class="annot"><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-type">fieldName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055031"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span></span><span>
</span><span id="line-420"></span><span id="fieldName"><span class="annot"><span class="annottext">fieldName :: Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var hs-var">fieldName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdName :: forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var">fdName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054564"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054564"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054564"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-421"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdName :: forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var">fdName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054563"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054563"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054563"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span id="local-6989586621679054773"><span class="annot"><a href="Data.Ini.Config.Bidir.html#fieldComment"><span class="hs-identifier hs-type">fieldComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054773"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span></span><span>
</span><span id="line-424"></span><span id="fieldComment"><span class="annot"><span class="annottext">fieldComment :: Field s -&gt; Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fieldComment"><span class="hs-identifier hs-var hs-var">fieldComment</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdComment :: forall t. FieldDescription t -&gt; Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fdComment"><span class="hs-identifier hs-var">fdComment</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054560"><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054560"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054560"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#fieldComment"><span class="hs-identifier hs-var">fieldComment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdComment :: forall t. FieldDescription t -&gt; Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fdComment"><span class="hs-identifier hs-var">fdComment</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054559"><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054559"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054559"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | A 'FieldDescription' is a declarative representation of the</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- structure of a field. This includes the name of the field and the</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- 'FieldValue' used to parse and serialize values of that field, as</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- well as other metadata that might be needed in the course of</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- parsing or serializing a structure.</span><span>
</span><span id="line-432"></span><span class="hs-keyword">data</span><span> </span><span id="FieldDescription"><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-var">FieldDescription</span></a></span></span><span> </span><span id="local-6989586621679054896"><span class="annot"><a href="#local-6989586621679054896"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FieldDescription"><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-var">FieldDescription</span></a></span></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="fdName"><span class="annot"><span class="annottext">FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fdValue"><span class="annot"><span class="annottext">FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054896"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fdComment"><span class="annot"><span class="annottext">FieldDescription t -&gt; Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fdComment"><span class="hs-identifier hs-var hs-var">fdComment</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fdDummy"><span class="annot"><span class="annottext">FieldDescription t -&gt; Maybe Text
</span><a href="Data.Ini.Config.Bidir.html#fdDummy"><span class="hs-identifier hs-var hs-var">fdDummy</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fdSkipIfMissing"><span class="annot"><span class="annottext">FieldDescription t -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#fdSkipIfMissing"><span class="hs-identifier hs-var hs-var">fdSkipIfMissing</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- ** Field operators</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="hs-comment">{- |
Associate a field description with a field. If this field
is not present when parsing, it will attempt to fall back
on a default, and if no default value is present, it will
fail to parse.

When serializing an INI file, this will produce all the
comments associated with the field description followed
by the value of the field in the.
-}</span><span>
</span><span id="line-452"></span><span id="local-6989586621679054555"><span id="local-6989586621679054556"><span class="annot"><a href="Data.Ini.Config.Bidir.html#.%3D"><span class="hs-operator hs-type">(.=)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679054556"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054555"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054555"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054556"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054556"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054556"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-type">SectionSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054555"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-453"></span><span id="local-6989586621679054554"><span class="annot"><span class="annottext">Lens s s t t
</span><a href="#local-6989586621679054554"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id=".%3D"><span class="annot"><span class="annottext">.= :: Lens s s t t -&gt; FieldDescription t -&gt; SectionSpec s ()
</span><a href="Data.Ini.Config.Bidir.html#.%3D"><span class="hs-operator hs-var hs-var">.=</span></a></span></span><span> </span><span id="local-6989586621679054553"><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054553"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BidirM (Field s) () -&gt; SectionSpec s ()
forall s a. BidirM (Field s) a -&gt; SectionSpec s a
</span><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-var">SectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">(BidirM (Field s) () -&gt; SectionSpec s ())
-&gt; BidirM (Field s) () -&gt; SectionSpec s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Seq (Field s) -&gt; Seq (Field s)) -&gt; BidirM (Field s) ()
forall (m :: * -&gt; *) s. Monad m =&gt; (s -&gt; s) -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; Field s -&gt; Seq (Field s)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">Seq.|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054552"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054552"><span class="annot"><span class="annottext">fd :: Field s
</span><a href="#local-6989586621679054552"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens s s t t -&gt; FieldDescription t -&gt; Field s
forall s a. Eq a =&gt; Lens s s a a -&gt; FieldDescription a -&gt; Field s
</span><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s t t
</span><a href="#local-6989586621679054554"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054553"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-comment">{- |
Associate a field description with a field of type &quot;Maybe a&quot;.
When parsing, this field will be initialized to &quot;Nothing&quot; if
it is not found, and to a &quot;Just&quot; value if it is. When
serializing an INI file, this will try to serialize a value
-}</span><span>
</span><span id="line-462"></span><span id="local-6989586621679054550"><span id="local-6989586621679054551"><span class="annot"><a href="Data.Ini.Config.Bidir.html#.%3D%3F"><span class="hs-operator hs-type">(.=?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679054551"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054550"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054550"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679054551"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679054551"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054551"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-type">SectionSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054550"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-463"></span><span id="local-6989586621679054549"><span class="annot"><span class="annottext">Lens s s (Maybe t) (Maybe t)
</span><a href="#local-6989586621679054549"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id=".%3D%3F"><span class="annot"><span class="annottext">.=? :: Lens s s (Maybe t) (Maybe t)
-&gt; FieldDescription t -&gt; SectionSpec s ()
</span><a href="Data.Ini.Config.Bidir.html#.%3D%3F"><span class="hs-operator hs-var hs-var">.=?</span></a></span></span><span> </span><span id="local-6989586621679054548"><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054548"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BidirM (Field s) () -&gt; SectionSpec s ()
forall s a. BidirM (Field s) a -&gt; SectionSpec s a
</span><a href="Data.Ini.Config.Bidir.html#SectionSpec"><span class="hs-identifier hs-var">SectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">(BidirM (Field s) () -&gt; SectionSpec s ())
-&gt; BidirM (Field s) () -&gt; SectionSpec s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Seq (Field s) -&gt; Seq (Field s)) -&gt; BidirM (Field s) ()
forall (m :: * -&gt; *) s. Monad m =&gt; (s -&gt; s) -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; Field s -&gt; Seq (Field s)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">Seq.|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054547"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054547"><span class="annot"><span class="annottext">fd :: Field s
</span><a href="#local-6989586621679054547"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe t) (Maybe t) -&gt; FieldDescription t -&gt; Field s
forall s a.
Eq a =&gt;
Lens s s (Maybe a) (Maybe a) -&gt; FieldDescription a -&gt; Field s
</span><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-var">FieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe t) (Maybe t)
</span><a href="#local-6989586621679054549"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054548"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- ** Field metadata</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-comment">{- |
Associate a multiline comment with a &quot;FieldDescription&quot;. When
serializing a field that has a comment associated, the comment will
appear before the field.
-}</span><span>
</span><span id="line-473"></span><span id="local-6989586621679054546"><span class="annot"><a href="Data.Ini.Config.Bidir.html#comment"><span class="hs-identifier hs-type">comment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054546"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054546"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-474"></span><span id="comment"><span class="annot"><span class="annottext">comment :: [Text] -&gt; FieldDescription t -&gt; FieldDescription t
</span><a href="Data.Ini.Config.Bidir.html#comment"><span class="hs-identifier hs-var hs-var">comment</span></a></span></span><span> </span><span id="local-6989586621679054545"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679054545"><span class="hs-identifier hs-var">cmt</span></a></span></span><span> </span><span id="local-6989586621679054544"><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054544"><span class="hs-identifier hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054544"><span class="hs-identifier hs-var">fd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdComment :: Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fdComment"><span class="hs-identifier hs-var">fdComment</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Seq Text
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679054545"><span class="hs-identifier hs-var">cmt</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="hs-comment">-- | Choose a placeholder value to be displayed for optional fields.</span><span>
</span><span id="line-477"></span><span class="hs-comment">--   This is used when serializing an optional Ini field: the</span><span>
</span><span id="line-478"></span><span class="hs-comment">--   field will appear commented out in the output using the</span><span>
</span><span id="line-479"></span><span class="hs-comment">--   placeholder text as a value, so a spec that includes</span><span>
</span><span id="line-480"></span><span class="hs-comment">--</span><span>
</span><span id="line-481"></span><span class="hs-comment">--   @</span><span>
</span><span id="line-482"></span><span class="hs-comment">--   myLens .=? field &quot;x&quot; &amp; placeholderValue &quot;\&lt;val\&gt;&quot;</span><span>
</span><span id="line-483"></span><span class="hs-comment">--   @</span><span>
</span><span id="line-484"></span><span class="hs-comment">--</span><span>
</span><span id="line-485"></span><span class="hs-comment">--   will serialize into an INI file that contains the line</span><span>
</span><span id="line-486"></span><span class="hs-comment">--</span><span>
</span><span id="line-487"></span><span class="hs-comment">--   @</span><span>
</span><span id="line-488"></span><span class="hs-comment">--   # x = \&lt;val\&gt;</span><span>
</span><span id="line-489"></span><span class="hs-comment">--   @</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">--   A placeholder value will only appear in the serialized output if</span><span>
</span><span id="line-492"></span><span class="hs-comment">--   the field is optional, but will be preferred over serializing the</span><span>
</span><span id="line-493"></span><span class="hs-comment">--   default value for an optional field. This will not affect INI</span><span>
</span><span id="line-494"></span><span class="hs-comment">--   file updates.</span><span>
</span><span id="line-495"></span><span id="local-6989586621679054542"><span class="annot"><a href="Data.Ini.Config.Bidir.html#placeholderValue"><span class="hs-identifier hs-type">placeholderValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054542"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054542"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-496"></span><span id="placeholderValue"><span class="annot"><span class="annottext">placeholderValue :: Text -&gt; FieldDescription t -&gt; FieldDescription t
</span><a href="Data.Ini.Config.Bidir.html#placeholderValue"><span class="hs-identifier hs-var hs-var">placeholderValue</span></a></span></span><span> </span><span id="local-6989586621679054541"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054541"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679054540"><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054540"><span class="hs-identifier hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054540"><span class="hs-identifier hs-var">fd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdDummy :: Maybe Text
</span><a href="Data.Ini.Config.Bidir.html#fdDummy"><span class="hs-identifier hs-var">fdDummy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054541"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | If the field is not found in parsing, simply skip instead of</span><span>
</span><span id="line-499"></span><span class="hs-comment">--   raising an error or setting anything.</span><span>
</span><span id="line-500"></span><span id="local-6989586621679054539"><span class="annot"><a href="Data.Ini.Config.Bidir.html#optional"><span class="hs-identifier hs-type">optional</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054539"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054539"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-501"></span><span id="optional"><span class="annot"><span class="annottext">optional :: FieldDescription t -&gt; FieldDescription t
</span><a href="Data.Ini.Config.Bidir.html#optional"><span class="hs-identifier hs-var hs-var">optional</span></a></span></span><span> </span><span id="local-6989586621679054538"><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054538"><span class="hs-identifier hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054538"><span class="hs-identifier hs-var">fd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdSkipIfMissing :: Bool
</span><a href="Data.Ini.Config.Bidir.html#fdSkipIfMissing"><span class="hs-identifier hs-var">fdSkipIfMissing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#.%3D"><span class="hs-operator hs-type">.=</span></a></span><span>
</span><span id="line-504"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#.%3D%3F"><span class="hs-operator hs-type">.=?</span></a></span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span class="hs-comment">-- ** Creating fields</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-comment">-- | Create a description of a field by a combination of the name of</span><span>
</span><span id="line-509"></span><span class="hs-comment">--   the field and a &quot;FieldValue&quot; describing how to parse and emit</span><span>
</span><span id="line-510"></span><span class="hs-comment">--   values associated with that field.</span><span>
</span><span id="line-511"></span><span id="local-6989586621679054861"><span class="annot"><a href="Data.Ini.Config.Bidir.html#field"><span class="hs-identifier hs-type">field</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054861"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054861"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-512"></span><span id="field"><span class="annot"><span class="annottext">field :: Text -&gt; FieldValue a -&gt; FieldDescription a
</span><a href="Data.Ini.Config.Bidir.html#field"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span id="local-6989586621679054537"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054537"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054536"><span class="annot"><span class="annottext">FieldValue a
</span><a href="#local-6989586621679054536"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldDescription :: forall t.
NormalizedText
-&gt; FieldValue t
-&gt; Seq Text
-&gt; Maybe Text
-&gt; Bool
-&gt; FieldDescription t
</span><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fdName :: NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var">fdName</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; NormalizedText
</span><a href="Data.Ini.Config.Raw.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054537"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdValue :: FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var">fdValue</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue a
</span><a href="#local-6989586621679054536"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdComment :: Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fdComment"><span class="hs-identifier hs-var">fdComment</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdDummy :: Maybe Text
</span><a href="Data.Ini.Config.Bidir.html#fdDummy"><span class="hs-identifier hs-var">fdDummy</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fdSkipIfMissing :: Bool
</span><a href="Data.Ini.Config.Bidir.html#fdSkipIfMissing"><span class="hs-identifier hs-var">fdSkipIfMissing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="hs-comment">-- | Create a description of a 'Bool'-valued field.</span><span>
</span><span id="line-521"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#flag"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-522"></span><span id="flag"><span class="annot"><span class="annottext">flag :: Text -&gt; FieldDescription Bool
</span><a href="Data.Ini.Config.Bidir.html#flag"><span class="hs-identifier hs-var hs-var">flag</span></a></span></span><span> </span><span id="local-6989586621679054535"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054535"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldValue Bool -&gt; FieldDescription Bool
forall a. Text -&gt; FieldValue a -&gt; FieldDescription a
</span><a href="Data.Ini.Config.Bidir.html#field"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054535"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue Bool
</span><a href="Data.Ini.Config.Bidir.html#bool"><span class="hs-identifier hs-var">bool</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-comment">-- ** FieldValues</span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="hs-comment">-- | A &quot;FieldValue&quot; for parsing and serializing values according to</span><span>
</span><span id="line-527"></span><span class="hs-comment">--   the logic of the &quot;Read&quot; and &quot;Show&quot; instances for that type,</span><span>
</span><span id="line-528"></span><span class="hs-comment">--   providing a convenient human-readable error message if the</span><span>
</span><span id="line-529"></span><span class="hs-comment">--   parsing step fails.</span><span>
</span><span id="line-530"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#readable"><span class="hs-identifier hs-type">readable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679054844"><span class="annot"><a href="#local-6989586621679054844"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679054844"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679054844"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679054844"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054844"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-531"></span><span id="readable"><span class="annot"><span class="annottext">readable :: FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#readable"><span class="hs-identifier hs-var hs-var">readable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue :: forall a. (Text -&gt; Either String a) -&gt; (a -&gt; Text) -&gt; FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fvParse :: Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var">fvParse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String a
forall b. Read b =&gt; Text -&gt; Either String b
</span><a href="#local-6989586621679054534"><span class="hs-identifier hs-var">parse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fvEmit :: a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var">fvEmit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
</span><a href="#local-6989586621679054533"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054533"><span class="annot"><span class="annottext">emit :: a -&gt; Text
</span><a href="#local-6989586621679054533"><span class="hs-identifier hs-var hs-var">emit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (a -&gt; String) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-533"></span><span>        </span><span id="local-6989586621679054534"><span class="annot"><span class="annottext">parse :: Text -&gt; Either String b
</span><a href="#local-6989586621679054534"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679054530"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054530"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe b
forall a. Read a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054530"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-534"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054528"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679054528"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either String b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679054528"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-535"></span><span>          </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unable to parse &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054530"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-536"></span><span>                           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; as a value of type &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TypeRep
</span><a href="#local-6989586621679054527"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>        </span><span id="local-6989586621679054527"><span class="annot"><span class="annottext">typ :: TypeRep
</span><a href="#local-6989586621679054527"><span class="hs-identifier hs-var hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; TypeRep
forall k (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><span class="hs-identifier hs-var">typeRep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679054526"><span class="hs-identifier hs-var">prx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>        </span><span class="annot"><a href="#local-6989586621679054526"><span class="hs-identifier hs-type">prx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679054844"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-539"></span><span>        </span><span id="local-6989586621679054526"><span class="annot"><span class="annottext">prx :: Proxy a
</span><a href="#local-6989586621679054526"><span class="hs-identifier hs-var hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">-- | Represents a numeric field whose value is parsed according to the</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- 'Read' implementation for that type, and is serialized according to</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- the 'Show' implementation for that type.</span><span>
</span><span id="line-544"></span><span id="local-6989586621679054524"><span class="annot"><a href="Data.Ini.Config.Bidir.html#number"><span class="hs-identifier hs-type">number</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679054524"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679054524"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679054524"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679054524"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054524"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-545"></span><span id="number"><span class="annot"><span class="annottext">number :: FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#number"><span class="hs-identifier hs-var hs-var">number</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue a
forall a. (Show a, Read a, Typeable a) =&gt; FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#readable"><span class="hs-identifier hs-var">readable</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-comment">-- | Represents a field whose value is a 'Text' value</span><span>
</span><span id="line-548"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-549"></span><span id="text"><span class="annot"><span class="annottext">text :: FieldValue Text
</span><a href="Data.Ini.Config.Bidir.html#text"><span class="hs-identifier hs-var hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue :: forall a. (Text -&gt; Either String a) -&gt; (a -&gt; Text) -&gt; FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fvParse :: Text -&gt; Either String Text
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var">fvParse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String Text
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fvEmit :: Text -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var">fvEmit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">-- | Represents a field whose value is a 'String' value</span><span>
</span><span id="line-552"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#string"><span class="hs-identifier hs-type">string</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-553"></span><span id="string"><span class="annot"><span class="annottext">string :: FieldValue String
</span><a href="Data.Ini.Config.Bidir.html#string"><span class="hs-identifier hs-var hs-var">string</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue :: forall a. (Text -&gt; Either String a) -&gt; (a -&gt; Text) -&gt; FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fvParse :: Text -&gt; Either String String
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var">fvParse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String String)
-&gt; (Text -&gt; String) -&gt; Text -&gt; Either String String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fvEmit :: String -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var">fvEmit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- | Represents a field whose value is a 'Bool' value. This parser is</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- case-insensitive, and matches the words @true@, @false@, @yes@, and</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- @no@, as well as single-letter abbreviations for all of the</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- above. This will serialize as @true@ for 'True' and @false@ for</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- 'False'.</span><span>
</span><span id="line-560"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#bool"><span class="hs-identifier hs-type">bool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-561"></span><span id="bool"><span class="annot"><span class="annottext">bool :: FieldValue Bool
</span><a href="Data.Ini.Config.Bidir.html#bool"><span class="hs-identifier hs-var hs-var">bool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue :: forall a. (Text -&gt; Either String a) -&gt; (a -&gt; Text) -&gt; FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fvParse :: Text -&gt; Either String Bool
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var">fvParse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String Bool
</span><a href="#local-6989586621679054522"><span class="hs-identifier hs-var">parse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fvEmit :: Bool -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var">fvEmit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text
forall p. IsString p =&gt; Bool -&gt; p
</span><a href="#local-6989586621679054521"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054522"><span class="annot"><span class="annottext">parse :: Text -&gt; Either String Bool
</span><a href="#local-6989586621679054522"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679054520"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054520"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054520"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-563"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;true&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either String Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-564"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;yes&quot;</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either String Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-565"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either String Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-566"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;y&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either String Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-567"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either String Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-568"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;no&quot;</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either String Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-569"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;f&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either String Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-570"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;n&quot;</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either String Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-571"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unable to parse &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054520"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; as a boolean&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>        </span><span id="local-6989586621679054521"><span class="annot"><span class="annottext">emit :: Bool -&gt; p
</span><a href="#local-6989586621679054521"><span class="hs-identifier hs-var hs-var">emit</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-573"></span><span>        </span><span class="annot"><a href="#local-6989586621679054521"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="hs-comment">-- | Represents a field whose value is a sequence of other values</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- which are delimited by a given string, and whose individual values</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- are described by another 'FieldValue' value. This uses GHC's</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- `IsList` typeclass to convert back and forth between sequence</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- types.</span><span>
</span><span id="line-580"></span><span id="local-6989586621679054518"><span class="annot"><a href="Data.Ini.Config.Bidir.html#listWithSeparator"><span class="hs-identifier hs-type">listWithSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679054518"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679054518"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054518"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-581"></span><span id="listWithSeparator"><span class="annot"><span class="annottext">listWithSeparator :: Text -&gt; FieldValue (Item l) -&gt; FieldValue l
</span><a href="Data.Ini.Config.Bidir.html#listWithSeparator"><span class="hs-identifier hs-var hs-var">listWithSeparator</span></a></span></span><span> </span><span id="local-6989586621679054517"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054517"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span id="local-6989586621679054516"><span class="annot"><span class="annottext">FieldValue (Item l)
</span><a href="#local-6989586621679054516"><span class="hs-identifier hs-var">fv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue :: forall a. (Text -&gt; Either String a) -&gt; (a -&gt; Text) -&gt; FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fvParse :: Text -&gt; Either String l
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var">fvParse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Item l] -&gt; l) -&gt; Either String [Item l] -&gt; Either String l
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Item l] -&gt; l
forall l. IsList l =&gt; [Item l] -&gt; l
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">(Either String [Item l] -&gt; Either String l)
-&gt; (Text -&gt; Either String [Item l]) -&gt; Text -&gt; Either String l
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either String (Item l))
-&gt; [Text] -&gt; Either String [Item l]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldValue (Item l) -&gt; Text -&gt; Either String (Item l)
forall a. FieldValue a -&gt; Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var hs-var">fvParse</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue (Item l)
</span><a href="#local-6989586621679054516"><span class="hs-identifier hs-var">fv</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either String (Item l))
-&gt; (Text -&gt; Text) -&gt; Text -&gt; Either String (Item l)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Either String [Item l])
-&gt; (Text -&gt; [Text]) -&gt; Text -&gt; Either String [Item l]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.splitOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054517"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fvEmit :: l -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var">fvEmit</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054517"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; (l -&gt; [Text]) -&gt; l -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Item l -&gt; Text) -&gt; [Item l] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldValue (Item l) -&gt; Item l -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue (Item l)
</span><a href="#local-6989586621679054516"><span class="hs-identifier hs-var">fv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Item l] -&gt; [Text]) -&gt; (l -&gt; [Item l]) -&gt; l -&gt; [Text]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">l -&gt; [Item l]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">-- | Represents a field whose value is a pair of two other values</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- separated by a given string, whose individual values are described</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- by two different 'FieldValue' values.</span><span>
</span><span id="line-589"></span><span id="local-6989586621679054510"><span id="local-6989586621679054511"><span class="annot"><a href="Data.Ini.Config.Bidir.html#pairWithSeparator"><span class="hs-identifier hs-type">pairWithSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054511"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054510"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054511"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679054510"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-590"></span><span id="pairWithSeparator"><span class="annot"><span class="annottext">pairWithSeparator :: FieldValue l -&gt; Text -&gt; FieldValue r -&gt; FieldValue (l, r)
</span><a href="Data.Ini.Config.Bidir.html#pairWithSeparator"><span class="hs-identifier hs-var hs-var">pairWithSeparator</span></a></span></span><span> </span><span id="local-6989586621679054509"><span class="annot"><span class="annottext">FieldValue l
</span><a href="#local-6989586621679054509"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679054508"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054508"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span id="local-6989586621679054507"><span class="annot"><span class="annottext">FieldValue r
</span><a href="#local-6989586621679054507"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue :: forall a. (Text -&gt; Either String a) -&gt; (a -&gt; Text) -&gt; FieldValue a
</span><a href="Data.Ini.Config.Bidir.html#FieldValue"><span class="hs-identifier hs-type">FieldValue</span></a></span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fvParse :: Text -&gt; Either String (l, r)
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var">fvParse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679054506"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054506"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-592"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054505"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054505"><span class="hs-identifier hs-var">leftChunk</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054504"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054504"><span class="hs-identifier hs-var">rightChunk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.breakOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054508"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054506"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-593"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-594"></span><span>        </span><span id="local-6989586621679054502"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679054502"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldValue l -&gt; Text -&gt; Either String l
forall a. FieldValue a -&gt; Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var hs-var">fvParse</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue l
</span><a href="#local-6989586621679054509"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054505"><span class="hs-identifier hs-var">leftChunk</span></a></span><span>
</span><span id="line-595"></span><span>        </span><span id="local-6989586621679054501"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054501"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldValue r -&gt; Text -&gt; Either String r
forall a. FieldValue a -&gt; Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var hs-var">fvParse</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue r
</span><a href="#local-6989586621679054507"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054504"><span class="hs-identifier hs-var">rightChunk</span></a></span><span>
</span><span id="line-596"></span><span>        </span><span class="annot"><span class="annottext">(l, r) -&gt; Either String (l, r)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679054502"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054501"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fvEmit :: (l, r) -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var">fvEmit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054500"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679054500"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054499"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054499"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldValue l -&gt; l -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue l
</span><a href="#local-6989586621679054509"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679054500"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054508"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldValue r -&gt; r -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="annot"><span class="annottext">FieldValue r
</span><a href="#local-6989586621679054507"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679054499"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="hs-comment">-- * Parsing INI files</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="hs-comment">-- Are you reading this source code? It's not even that gross</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- yet. Just you wait. This is just the regular part. 'runSpec' is</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- easy: we walk the spec, and for each section, find the</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- corresponding section in the INI file and call runFields.</span><span>
</span><span id="line-606"></span><span id="local-6989586621679054996"><span class="annot"><a href="Data.Ini.Config.Bidir.html#parseSections"><span class="hs-identifier hs-type">parseSections</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054996"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.ViewL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054996"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679054996"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-611"></span><span id="parseSections"><span class="annot"><span class="annottext">parseSections :: s
-&gt; ViewL (Section s)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseSections"><span class="hs-identifier hs-var hs-var">parseSections</span></a></span></span><span> </span><span id="local-6989586621679054498"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054498"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">ViewL (Section s)
</span><span class="hs-identifier hs-var">Seq.EmptyL</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; Either String s
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054498"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-612"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#parseSections"><span class="hs-identifier hs-var">parseSections</span></a></span><span> </span><span id="local-6989586621679054496"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054496"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span id="local-6989586621679054495"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054495"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054494"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054494"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679054493"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054493"><span class="hs-identifier hs-var">opt</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">Seq.:&lt;</span></span><span> </span><span id="local-6989586621679054491"><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054491"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054490"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054490"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054489"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054489"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NormalizedText
-&gt; Seq (NormalizedText, IniSection) -&gt; Maybe IniSection
forall a. NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.Bidir.html#lkp"><span class="hs-identifier hs-var">lkp</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054495"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054490"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-614"></span><span>      </span><span id="local-6989586621679054488"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054488"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
forall s. s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-var">parseFields</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054496"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054494"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054489"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-615"></span><span>      </span><span class="annot"><span class="annottext">s
-&gt; ViewL (Section s)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Either String s
forall s.
s
-&gt; ViewL (Section s)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseSections"><span class="hs-identifier hs-var">parseSections</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054488"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Section s) -&gt; ViewL (Section s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054491"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054490"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054493"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
-&gt; ViewL (Section s)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Either String s
forall s.
s
-&gt; ViewL (Section s)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseSections"><span class="hs-identifier hs-var">parseSections</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054496"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Section s) -&gt; ViewL (Section s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054491"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054490"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-617"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String s
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unable to find section &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-618"></span><span>                      </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#normalizedText"><span class="hs-identifier hs-var hs-var">normalizedText</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054495"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="hs-comment">-- Now that we've got 'set', we can walk the field descriptions and</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- find them. There's some fiddly logic, but the high-level idea is</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- that we try to look up a field, and if it exists, parse it using</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- the provided parser and use the provided lens to add it to the</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- value. We have to decide what to do if it's not there, which</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- depends on lens metadata and whether it's an optional field or not.</span><span>
</span><span id="line-626"></span><span id="local-6989586621679054828"><span class="annot"><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-type">parseFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054828"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.ViewL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054828"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679054828"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-627"></span><span id="parseFields"><span class="annot"><span class="annottext">parseFields :: s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-var hs-var">parseFields</span></a></span></span><span> </span><span id="local-6989586621679054485"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054485"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">ViewL (Field s)
</span><span class="hs-identifier hs-var">Seq.EmptyL</span></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; Either String s
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054485"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-628"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-var">parseFields</span></a></span><span> </span><span id="local-6989586621679054484"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054484"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span id="local-6989586621679054483"><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054483"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054482"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054482"><span class="hs-identifier hs-var">descr</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">Seq.:&lt;</span></span><span> </span><span id="local-6989586621679054481"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054481"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054480"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054480"><span class="hs-identifier hs-var">sect</span></a></span></span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054479"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054479"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (NormalizedText, IniValue) -&gt; Maybe IniValue
forall a. NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.Bidir.html#lkp"><span class="hs-identifier hs-var">lkp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054482"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniSection -&gt; Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Raw.html#isVals"><span class="hs-identifier hs-var hs-var">isVals</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054480"><span class="hs-identifier hs-var">sect</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-630"></span><span>      </span><span id="local-6989586621679054477"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054477"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldValue a -&gt; Text -&gt; Either String a
forall a. FieldValue a -&gt; Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var hs-var">fvParse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054482"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var hs-var">vValue</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054479"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>      </span><span class="annot"><span class="annottext">s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
forall s. s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-var">parseFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens s s a a -&gt; a -&gt; s -&gt; s
forall s t a b. Lens s t a b -&gt; b -&gt; s -&gt; t
</span><a href="Data.Ini.Config.Bidir.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054483"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054477"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054484"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054481"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054480"><span class="hs-identifier hs-var">sect</span></a></span><span>
</span><span id="line-632"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FieldDescription a -&gt; Bool
forall t. FieldDescription t -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#fdSkipIfMissing"><span class="hs-identifier hs-var hs-var">fdSkipIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054482"><span class="hs-identifier hs-var">descr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-633"></span><span>      </span><span class="annot"><span class="annottext">s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
forall s. s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-var">parseFields</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054484"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054481"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054480"><span class="hs-identifier hs-var">sect</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String s
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unable to find field &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-635"></span><span>                      </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#normalizedText"><span class="hs-identifier hs-var hs-var">normalizedText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054482"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-var">parseFields</span></a></span><span> </span><span id="local-6989586621679054475"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054475"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span id="local-6989586621679054474"><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054474"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054473"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054473"><span class="hs-identifier hs-var">descr</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">Seq.:&lt;</span></span><span> </span><span id="local-6989586621679054472"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054472"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054471"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054471"><span class="hs-identifier hs-var">sect</span></a></span></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054470"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054470"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (NormalizedText, IniValue) -&gt; Maybe IniValue
forall a. NormalizedText -&gt; Seq (NormalizedText, a) -&gt; Maybe a
</span><a href="Data.Ini.Config.Bidir.html#lkp"><span class="hs-identifier hs-var">lkp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054473"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniSection -&gt; Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Raw.html#isVals"><span class="hs-identifier hs-var hs-var">isVals</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054471"><span class="hs-identifier hs-var">sect</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-638"></span><span>      </span><span id="local-6989586621679054469"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054469"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldValue a -&gt; Text -&gt; Either String a
forall a. FieldValue a -&gt; Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var hs-var">fvParse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054473"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var hs-var">vValue</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054470"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>      </span><span class="annot"><span class="annottext">s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
forall s. s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-var">parseFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a) -&gt; Maybe a -&gt; s -&gt; s
forall s t a b. Lens s t a b -&gt; b -&gt; s -&gt; t
</span><a href="Data.Ini.Config.Bidir.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054474"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054469"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054475"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054472"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054471"><span class="hs-identifier hs-var">sect</span></a></span><span>
</span><span id="line-640"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-641"></span><span>      </span><span class="annot"><span class="annottext">s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
forall s. s -&gt; ViewL (Field s) -&gt; IniSection -&gt; Either String s
</span><a href="Data.Ini.Config.Bidir.html#parseFields"><span class="hs-identifier hs-var">parseFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a) -&gt; Maybe a -&gt; s -&gt; s
forall s t a b. Lens s t a b -&gt; b -&gt; s -&gt; t
</span><a href="Data.Ini.Config.Bidir.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054474"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054475"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054472"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054471"><span class="hs-identifier hs-var">sect</span></a></span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-comment">-- | Serialize a value as an INI file according to a provided</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- 'IniSpec'.</span><span>
</span><span id="line-645"></span><span id="local-6989586621679055001"><span class="annot"><a href="Data.Ini.Config.Bidir.html#emitIniFile"><span class="hs-identifier hs-type">emitIniFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055001"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679055001"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span></span><span>
</span><span id="line-646"></span><span id="emitIniFile"><span class="annot"><span class="annottext">emitIniFile :: s -&gt; Spec s -&gt; RawIni
</span><a href="Data.Ini.Config.Bidir.html#emitIniFile"><span class="hs-identifier hs-var hs-var">emitIniFile</span></a></span></span><span> </span><span id="local-6989586621679054468"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054468"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679054467"><span class="annot"><span class="annottext">Spec s
</span><a href="#local-6989586621679054467"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-647"></span><span>  </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection) -&gt; RawIni
</span><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-var">RawIni</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (NormalizedText, IniSection) -&gt; RawIni)
-&gt; Seq (NormalizedText, IniSection) -&gt; RawIni
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><span class="annottext">(Section s -&gt; (NormalizedText, IniSection))
-&gt; Spec s -&gt; Seq (NormalizedText, IniSection)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span id="local-6989586621679054466"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054466"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054465"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054465"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-649"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054466"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s -&gt; Text -&gt; Seq (Field s) -&gt; IniSection
forall s. s -&gt; Text -&gt; Seq (Field s) -&gt; IniSection
</span><a href="Data.Ini.Config.Bidir.html#toSection"><span class="hs-identifier hs-var">toSection</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054468"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#actualText"><span class="hs-identifier hs-var hs-var">actualText</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054466"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054465"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec s
</span><a href="#local-6989586621679054467"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#mkComments"><span class="hs-identifier hs-type">mkComments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#BlankLine"><span class="hs-identifier hs-type">BlankLine</span></a></span><span>
</span><span id="line-652"></span><span id="mkComments"><span class="annot"><span class="annottext">mkComments :: Seq Text -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#mkComments"><span class="hs-identifier hs-var hs-var">mkComments</span></a></span></span><span> </span><span id="local-6989586621679054461"><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054461"><span class="hs-identifier hs-var">comments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><span class="annottext">(Text -&gt; BlankLine) -&gt; Seq Text -&gt; Seq BlankLine
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679054460"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054460"><span class="hs-identifier hs-var">ln</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; BlankLine
</span><a href="Data.Ini.Config.Raw.html#CommentLine"><span class="hs-identifier hs-var">CommentLine</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'#'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054460"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054461"><span class="hs-identifier hs-var">comments</span></a></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span id="local-6989586621679054818"><span class="annot"><a href="Data.Ini.Config.Bidir.html#toSection"><span class="hs-identifier hs-type">toSection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054818"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054818"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span></span><span>
</span><span id="line-656"></span><span id="toSection"><span class="annot"><span class="annottext">toSection :: s -&gt; Text -&gt; Seq (Field s) -&gt; IniSection
</span><a href="Data.Ini.Config.Bidir.html#toSection"><span class="hs-identifier hs-var hs-var">toSection</span></a></span></span><span> </span><span id="local-6989586621679054458"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679054457"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054457"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054456"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054456"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IniSection :: Text
-&gt; Seq (NormalizedText, IniValue)
-&gt; Int
-&gt; Int
-&gt; Seq BlankLine
-&gt; IniSection
</span><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">isName :: Text
</span><a href="Data.Ini.Config.Raw.html#isName"><span class="hs-identifier hs-var">isName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054457"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isVals :: Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Raw.html#isVals"><span class="hs-identifier hs-var">isVals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Field s -&gt; (NormalizedText, IniValue))
-&gt; Seq (Field s) -&gt; Seq (NormalizedText, IniValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Field s -&gt; (NormalizedText, IniValue)
</span><a href="#local-6989586621679054453"><span class="hs-identifier hs-var">toVal</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054456"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isStartLine :: Int
</span><a href="Data.Ini.Config.Raw.html#isStartLine"><span class="hs-identifier hs-var">isStartLine</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isEndLine :: Int
</span><a href="Data.Ini.Config.Raw.html#isEndLine"><span class="hs-identifier hs-var">isEndLine</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-661"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isComments :: Seq BlankLine
</span><a href="Data.Ini.Config.Raw.html#isComments"><span class="hs-identifier hs-var">isComments</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq BlankLine
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-662"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054449"><span class="annot"><span class="annottext">mkIniValue :: Text -&gt; FieldDescription t -&gt; Bool -&gt; (NormalizedText, IniValue)
</span><a href="#local-6989586621679054449"><span class="hs-identifier hs-var hs-var">mkIniValue</span></a></span></span><span> </span><span id="local-6989586621679054448"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054448"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679054447"><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054447"><span class="hs-identifier hs-var">descr</span></a></span></span><span> </span><span id="local-6989586621679054446"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054446"><span class="hs-identifier hs-var">opt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-663"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FieldDescription t -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054447"><span class="hs-identifier hs-var">descr</span></a></span><span>
</span><span id="line-664"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue :: Int -&gt; Text -&gt; Text -&gt; Seq BlankLine -&gt; Bool -&gt; Char -&gt; IniValue
</span><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span>
</span><span id="line-665"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vLineNo :: Int
</span><a href="Data.Ini.Config.Raw.html#vLineNo"><span class="hs-identifier hs-var">vLineNo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-666"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vName :: Text
</span><a href="Data.Ini.Config.Raw.html#vName"><span class="hs-identifier hs-var">vName</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#actualText"><span class="hs-identifier hs-var hs-var">actualText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription t -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054447"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vValue :: Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var">vValue</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054448"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-668"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vComments :: Seq BlankLine
</span><a href="Data.Ini.Config.Raw.html#vComments"><span class="hs-identifier hs-var">vComments</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#mkComments"><span class="hs-identifier hs-var">mkComments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription t -&gt; Seq Text
forall t. FieldDescription t -&gt; Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fdComment"><span class="hs-identifier hs-var hs-var">fdComment</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription t
</span><a href="#local-6989586621679054447"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vCommentedOut :: Bool
</span><a href="Data.Ini.Config.Raw.html#vCommentedOut"><span class="hs-identifier hs-var">vCommentedOut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054446"><span class="hs-identifier hs-var">opt</span></a></span><span>
</span><span id="line-670"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vDelimiter :: Char
</span><a href="Data.Ini.Config.Raw.html#vDelimiter"><span class="hs-identifier hs-var">vDelimiter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span>
</span><span id="line-671"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-672"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>          </span><span id="local-6989586621679054453"><span class="annot"><span class="annottext">toVal :: Field s -&gt; (NormalizedText, IniValue)
</span><a href="#local-6989586621679054453"><span class="hs-identifier hs-var hs-var">toVal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span id="local-6989586621679054439"><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054439"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054438"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054438"><span class="hs-identifier hs-var">descr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054437"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054437"><span class="hs-identifier hs-var">dummy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldDescription a -&gt; Maybe Text
forall t. FieldDescription t -&gt; Maybe Text
</span><a href="Data.Ini.Config.Bidir.html#fdDummy"><span class="hs-identifier hs-var hs-var">fdDummy</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054438"><span class="hs-identifier hs-var">descr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-675"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; FieldDescription a -&gt; Bool -&gt; (NormalizedText, IniValue)
forall t.
Text -&gt; FieldDescription t -&gt; Bool -&gt; (NormalizedText, IniValue)
</span><a href="#local-6989586621679054449"><span class="hs-identifier hs-var">mkIniValue</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054437"><span class="hs-identifier hs-var">dummy</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054438"><span class="hs-identifier hs-var">descr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-676"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-677"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; FieldDescription a -&gt; Bool -&gt; (NormalizedText, IniValue)
forall t.
Text -&gt; FieldDescription t -&gt; Bool -&gt; (NormalizedText, IniValue)
</span><a href="#local-6989586621679054449"><span class="hs-identifier hs-var">mkIniValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldValue a -&gt; a -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054438"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens s s a a -&gt; s -&gt; a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054439"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054438"><span class="hs-identifier hs-var">descr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-678"></span><span>          </span><span class="annot"><a href="#local-6989586621679054453"><span class="hs-identifier hs-var">toVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span id="local-6989586621679054436"><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054436"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054435"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-var">descr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054434"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054434"><span class="hs-identifier hs-var">dummy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldDescription a -&gt; Maybe Text
forall t. FieldDescription t -&gt; Maybe Text
</span><a href="Data.Ini.Config.Bidir.html#fdDummy"><span class="hs-identifier hs-var hs-var">fdDummy</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-var">descr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-680"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; FieldDescription a -&gt; Bool -&gt; (NormalizedText, IniValue)
forall t.
Text -&gt; FieldDescription t -&gt; Bool -&gt; (NormalizedText, IniValue)
</span><a href="#local-6989586621679054449"><span class="hs-identifier hs-var">mkIniValue</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679054434"><span class="hs-identifier hs-var">dummy</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-var">descr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-681"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054433"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054433"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a) -&gt; s -&gt; Maybe a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054436"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-682"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; FieldDescription a -&gt; Bool -&gt; (NormalizedText, IniValue)
forall t.
Text -&gt; FieldDescription t -&gt; Bool -&gt; (NormalizedText, IniValue)
</span><a href="#local-6989586621679054449"><span class="hs-identifier hs-var">mkIniValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldValue a -&gt; a -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054433"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-var">descr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-683"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-684"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; FieldDescription a -&gt; Bool -&gt; (NormalizedText, IniValue)
forall t.
Text -&gt; FieldDescription t -&gt; Bool -&gt; (NormalizedText, IniValue)
</span><a href="#local-6989586621679054449"><span class="hs-identifier hs-var">mkIniValue</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-var">descr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-comment">-- | An 'UpdatePolicy' guides certain choices made when an 'Ini' file</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- is updated: for example, how to add comments to the generated</span><span>
</span><span id="line-688"></span><span class="hs-comment">-- fields, or how to treat fields which are optional.</span><span>
</span><span id="line-689"></span><span class="hs-keyword">data</span><span> </span><span id="UpdatePolicy"><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-var">UpdatePolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UpdatePolicy"><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-var">UpdatePolicy</span></a></span></span><span>
</span><span id="line-690"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="updateAddOptionalFields"><span class="annot"><span class="annottext">UpdatePolicy -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#updateAddOptionalFields"><span class="hs-identifier hs-var hs-var">updateAddOptionalFields</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-691"></span><span>    </span><span class="hs-comment">-- ^ If 'True', then optional fields not included in the INI file</span><span>
</span><span id="line-692"></span><span>    </span><span class="hs-comment">-- will be included in the updated INI file. Defaults to 'False'.</span><span>
</span><span id="line-693"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="updateIgnoreExtraneousFields"><span class="annot"><span class="annottext">UpdatePolicy -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#updateIgnoreExtraneousFields"><span class="hs-identifier hs-var hs-var">updateIgnoreExtraneousFields</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-694"></span><span>    </span><span class="hs-comment">-- ^ If 'True', then fields in the INI file that have no</span><span>
</span><span id="line-695"></span><span>    </span><span class="hs-comment">-- corresponding description in the 'IniSpec' will be ignored; if</span><span>
</span><span id="line-696"></span><span>    </span><span class="hs-comment">-- 'False', then those fields will return an error value. Defaults</span><span>
</span><span id="line-697"></span><span>    </span><span class="hs-comment">-- to 'True'.</span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="updateGeneratedCommentPolicy"><span class="annot"><span class="annottext">UpdatePolicy -&gt; UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#updateGeneratedCommentPolicy"><span class="hs-identifier hs-var hs-var">updateGeneratedCommentPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdateCommentPolicy"><span class="hs-identifier hs-type">UpdateCommentPolicy</span></a></span><span>
</span><span id="line-699"></span><span>    </span><span class="hs-comment">-- ^ The policy for what to do to comments associated with</span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-comment">-- modified fields during an update. Defaults to</span><span>
</span><span id="line-701"></span><span>    </span><span class="hs-comment">-- 'CommentPolicyNone'.</span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054425"><span id="local-6989586621679054427"><span class="annot"><span class="annottext">UpdatePolicy -&gt; UpdatePolicy -&gt; Bool
(UpdatePolicy -&gt; UpdatePolicy -&gt; Bool)
-&gt; (UpdatePolicy -&gt; UpdatePolicy -&gt; Bool) -&gt; Eq UpdatePolicy
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: UpdatePolicy -&gt; UpdatePolicy -&gt; Bool
$c/= :: UpdatePolicy -&gt; UpdatePolicy -&gt; Bool
== :: UpdatePolicy -&gt; UpdatePolicy -&gt; Bool
$c== :: UpdatePolicy -&gt; UpdatePolicy -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054418"><span id="local-6989586621679054420"><span id="local-6989586621679054422"><span class="annot"><span class="annottext">Int -&gt; UpdatePolicy -&gt; String -&gt; String
[UpdatePolicy] -&gt; String -&gt; String
UpdatePolicy -&gt; String
(Int -&gt; UpdatePolicy -&gt; String -&gt; String)
-&gt; (UpdatePolicy -&gt; String)
-&gt; ([UpdatePolicy] -&gt; String -&gt; String)
-&gt; Show UpdatePolicy
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [UpdatePolicy] -&gt; String -&gt; String
$cshowList :: [UpdatePolicy] -&gt; String -&gt; String
show :: UpdatePolicy -&gt; String
$cshow :: UpdatePolicy -&gt; String
showsPrec :: Int -&gt; UpdatePolicy -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; UpdatePolicy -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="hs-comment">-- | A set of sensible 'UpdatePolicy' defaults which keep the diffs</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- between file versions minimal.</span><span>
</span><span id="line-706"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#defaultUpdatePolicy"><span class="hs-identifier hs-type">defaultUpdatePolicy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-type">UpdatePolicy</span></a></span><span>
</span><span id="line-707"></span><span id="defaultUpdatePolicy"><span class="annot"><span class="annottext">defaultUpdatePolicy :: UpdatePolicy
</span><a href="Data.Ini.Config.Bidir.html#defaultUpdatePolicy"><span class="hs-identifier hs-var hs-var">defaultUpdatePolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdatePolicy :: Bool -&gt; Bool -&gt; UpdateCommentPolicy -&gt; UpdatePolicy
</span><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-type">UpdatePolicy</span></a></span><span>
</span><span id="line-708"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">updateAddOptionalFields :: Bool
</span><a href="Data.Ini.Config.Bidir.html#updateAddOptionalFields"><span class="hs-identifier hs-var">updateAddOptionalFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-709"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">updateIgnoreExtraneousFields :: Bool
</span><a href="Data.Ini.Config.Bidir.html#updateIgnoreExtraneousFields"><span class="hs-identifier hs-var">updateIgnoreExtraneousFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">updateGeneratedCommentPolicy :: UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#updateGeneratedCommentPolicy"><span class="hs-identifier hs-var">updateGeneratedCommentPolicy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#CommentPolicyNone"><span class="hs-identifier hs-var">CommentPolicyNone</span></a></span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="hs-comment">-- | An 'UpdateCommentPolicy' describes what comments should accompany</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- a field added to or modified in an existing INI file when using</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- 'updateIni'.</span><span>
</span><span id="line-716"></span><span class="hs-keyword">data</span><span> </span><span id="UpdateCommentPolicy"><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdateCommentPolicy"><span class="hs-identifier hs-var">UpdateCommentPolicy</span></a></span></span><span>
</span><span id="line-717"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="CommentPolicyNone"><span class="annot"><a href="Data.Ini.Config.Bidir.html#CommentPolicyNone"><span class="hs-identifier hs-var">CommentPolicyNone</span></a></span></span><span>
</span><span id="line-718"></span><span>    </span><span class="hs-comment">-- ^ Do not add comments to new fields</span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CommentPolicyAddFieldComment"><span class="annot"><a href="Data.Ini.Config.Bidir.html#CommentPolicyAddFieldComment"><span class="hs-identifier hs-var">CommentPolicyAddFieldComment</span></a></span></span><span>
</span><span id="line-720"></span><span>    </span><span class="hs-comment">-- ^ Add the same comment which appears in the 'IniSpec' value for</span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-comment">-- the field we're adding or modifying.</span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CommentPolicyAddDefaultComment"><span class="annot"><a href="Data.Ini.Config.Bidir.html#CommentPolicyAddDefaultComment"><span class="hs-identifier hs-var">CommentPolicyAddDefaultComment</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>    </span><span class="hs-comment">-- ^ Add a common comment to all new fields added or modified</span><span>
</span><span id="line-724"></span><span>    </span><span class="hs-comment">-- by an 'updateIni' call.</span><span>
</span><span id="line-725"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054410"><span id="local-6989586621679054412"><span class="annot"><span class="annottext">UpdateCommentPolicy -&gt; UpdateCommentPolicy -&gt; Bool
(UpdateCommentPolicy -&gt; UpdateCommentPolicy -&gt; Bool)
-&gt; (UpdateCommentPolicy -&gt; UpdateCommentPolicy -&gt; Bool)
-&gt; Eq UpdateCommentPolicy
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: UpdateCommentPolicy -&gt; UpdateCommentPolicy -&gt; Bool
$c/= :: UpdateCommentPolicy -&gt; UpdateCommentPolicy -&gt; Bool
== :: UpdateCommentPolicy -&gt; UpdateCommentPolicy -&gt; Bool
$c== :: UpdateCommentPolicy -&gt; UpdateCommentPolicy -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054404"><span id="local-6989586621679054406"><span id="local-6989586621679054408"><span class="annot"><span class="annottext">Int -&gt; UpdateCommentPolicy -&gt; String -&gt; String
[UpdateCommentPolicy] -&gt; String -&gt; String
UpdateCommentPolicy -&gt; String
(Int -&gt; UpdateCommentPolicy -&gt; String -&gt; String)
-&gt; (UpdateCommentPolicy -&gt; String)
-&gt; ([UpdateCommentPolicy] -&gt; String -&gt; String)
-&gt; Show UpdateCommentPolicy
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [UpdateCommentPolicy] -&gt; String -&gt; String
$cshowList :: [UpdateCommentPolicy] -&gt; String -&gt; String
show :: UpdateCommentPolicy -&gt; String
$cshow :: UpdateCommentPolicy -&gt; String
showsPrec :: Int -&gt; UpdateCommentPolicy -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; UpdateCommentPolicy -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span id="local-6989586621679054781"><span class="annot"><a href="Data.Ini.Config.Bidir.html#getComments"><span class="hs-identifier hs-type">getComments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldDescription"><span class="hs-identifier hs-type">FieldDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054781"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdateCommentPolicy"><span class="hs-identifier hs-type">UpdateCommentPolicy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#BlankLine"><span class="hs-identifier hs-type">BlankLine</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-728"></span><span id="getComments"><span class="annot"><span class="annottext">getComments :: FieldDescription s -&gt; UpdateCommentPolicy -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#getComments"><span class="hs-identifier hs-var hs-var">getComments</span></a></span></span><span> </span><span class="annot"><span class="annottext">FieldDescription s
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#CommentPolicyNone"><span class="hs-identifier hs-var">CommentPolicyNone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq BlankLine
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-729"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#getComments"><span class="hs-identifier hs-var">getComments</span></a></span><span> </span><span id="local-6989586621679054402"><span class="annot"><span class="annottext">FieldDescription s
</span><a href="#local-6989586621679054402"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#CommentPolicyAddFieldComment"><span class="hs-identifier hs-var">CommentPolicyAddFieldComment</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-730"></span><span>  </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#mkComments"><span class="hs-identifier hs-var">mkComments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription s -&gt; Seq Text
forall t. FieldDescription t -&gt; Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fdComment"><span class="hs-identifier hs-var hs-var">fdComment</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription s
</span><a href="#local-6989586621679054402"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span class="annot"><a href="Data.Ini.Config.Bidir.html#getComments"><span class="hs-identifier hs-var">getComments</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#CommentPolicyAddDefaultComment"><span class="hs-identifier hs-type">CommentPolicyAddDefaultComment</span></a></span><span> </span><span id="local-6989586621679054401"><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054401"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-732"></span><span>  </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#mkComments"><span class="hs-identifier hs-var">mkComments</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054401"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span class="hs-comment">-- | Given a value, an 'IniSpec', and a 'Text' form of an INI file,</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- parse 'Text' as INI and then selectively modify the file whenever</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- the provided value differs from the file. This is designed to help</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- applications update a user's configuration automatically while</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- retaining the structure and comments of a user's application,</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- ideally in a way which produces as few changes as possible to the</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- resulting file (so that, for example, the diff between the two</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- should be as small as possible.)</span><span>
</span><span id="line-742"></span><span class="hs-comment">--</span><span>
</span><span id="line-743"></span><span class="hs-comment">--  A field is considered to have &quot;changed&quot; if the parsed</span><span>
</span><span id="line-744"></span><span class="hs-comment">--  representation of the field as extracted from the textual INI file</span><span>
</span><span id="line-745"></span><span class="hs-comment">--  is not equal to the corresponding value in the provided</span><span>
</span><span id="line-746"></span><span class="hs-comment">--  structure. Changed fields will retain their place in the overall</span><span>
</span><span id="line-747"></span><span class="hs-comment">--  file, while newly added fields (for example, fields which have</span><span>
</span><span id="line-748"></span><span class="hs-comment">--  been changed from a default value) will be added to the end of the</span><span>
</span><span id="line-749"></span><span class="hs-comment">--  section in which they appear.</span><span>
</span><span id="line-750"></span><span class="hs-comment">--doUpdateIni :: s -&gt; s -&gt; Spec s -&gt; RawIni -&gt; UpdatePolicy -&gt; Either String (Ini s)</span><span>
</span><span id="line-751"></span><span id="local-6989586621679054988"><span class="annot"><a href="Data.Ini.Config.Bidir.html#doUpdateIni"><span class="hs-identifier hs-type">doUpdateIni</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054988"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054988"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054988"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-752"></span><span id="doUpdateIni"><span class="annot"><span class="annottext">doUpdateIni :: s -&gt; Ini s -&gt; Either String (Ini s)
</span><a href="Data.Ini.Config.Bidir.html#doUpdateIni"><span class="hs-identifier hs-var hs-var">doUpdateIni</span></a></span></span><span> </span><span id="local-6989586621679054400"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054400"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679054399"><span class="annot"><span class="annottext">i :: Ini s
</span><a href="#local-6989586621679054399"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Ini"><span class="hs-identifier hs-type">Ini</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniSpec :: forall s. Ini s -&gt; Spec s
</span><a href="Data.Ini.Config.Bidir.html#iniSpec"><span class="hs-identifier hs-var">iniSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054398"><span class="annot"><span class="annottext">Spec s
</span><a href="#local-6989586621679054398"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-753"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniDef :: forall s. Ini s -&gt; s
</span><a href="Data.Ini.Config.Bidir.html#iniDef"><span class="hs-identifier hs-var">iniDef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054397"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054397"><span class="hs-identifier hs-var">def</span></a></span></span><span>
</span><span id="line-754"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniPol :: forall s. Ini s -&gt; UpdatePolicy
</span><a href="Data.Ini.Config.Bidir.html#iniPol"><span class="hs-identifier hs-var">iniPol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054396"><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054396"><span class="hs-identifier hs-var">pol</span></a></span></span><span>
</span><span id="line-755"></span><span>                    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- spec (RawIni ini) pol = do</span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-type">RawIni</span></a></span><span> </span><span id="local-6989586621679054395"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054395"><span class="hs-identifier hs-var">ini'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ini s -&gt; RawIni
forall s. Ini s -&gt; RawIni
</span><a href="Data.Ini.Config.Bidir.html#getRawIni"><span class="hs-identifier hs-var">getRawIni</span></a></span><span> </span><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054399"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-757"></span><span>  </span><span id="local-6989586621679054394"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054394"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">s
-&gt; s
-&gt; Seq (NormalizedText, IniSection)
-&gt; Spec s
-&gt; UpdatePolicy
-&gt; Either String (Seq (NormalizedText, IniSection))
forall s.
s
-&gt; s
-&gt; Seq (NormalizedText, IniSection)
-&gt; Seq (Section s)
-&gt; UpdatePolicy
-&gt; Either String (Seq (NormalizedText, IniSection))
</span><a href="Data.Ini.Config.Bidir.html#updateSections"><span class="hs-identifier hs-var">updateSections</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054400"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054397"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054395"><span class="hs-identifier hs-var">ini'</span></a></span><span> </span><span class="annot"><span class="annottext">Spec s
</span><a href="#local-6989586621679054398"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054396"><span class="hs-identifier hs-var">pol</span></a></span><span>
</span><span id="line-758"></span><span>  </span><span class="annot"><span class="annottext">Ini s -&gt; Either String (Ini s)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Ini s -&gt; Either String (Ini s)) -&gt; Ini s -&gt; Either String (Ini s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ini s
</span><a href="#local-6989586621679054399"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-759"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iniCurr :: s
</span><a href="Data.Ini.Config.Bidir.html#iniCurr"><span class="hs-identifier hs-var">iniCurr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054400"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-760"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iniLast :: Maybe RawIni
</span><a href="Data.Ini.Config.Bidir.html#iniLast"><span class="hs-identifier hs-var">iniLast</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawIni -&gt; Maybe RawIni
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection) -&gt; RawIni
</span><a href="Data.Ini.Config.Raw.html#RawIni"><span class="hs-identifier hs-var">RawIni</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054394"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span id="local-6989586621679054805"><span class="annot"><a href="Data.Ini.Config.Bidir.html#updateSections"><span class="hs-identifier hs-type">updateSections</span></a></span><span>
</span><span id="line-764"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054805"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-765"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054805"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-766"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054805"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-type">UpdatePolicy</span></a></span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-type">IniSection</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-770"></span><span id="updateSections"><span class="annot"><span class="annottext">updateSections :: s
-&gt; s
-&gt; Seq (NormalizedText, IniSection)
-&gt; Seq (Section s)
-&gt; UpdatePolicy
-&gt; Either String (Seq (NormalizedText, IniSection))
</span><a href="Data.Ini.Config.Bidir.html#updateSections"><span class="hs-identifier hs-var hs-var">updateSections</span></a></span></span><span> </span><span id="local-6989586621679054392"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054392"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679054391"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054391"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621679054390"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054390"><span class="hs-identifier hs-var">sections</span></a></span></span><span> </span><span id="local-6989586621679054389"><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054389"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679054388"><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054388"><span class="hs-identifier hs-var">pol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-771"></span><span>  </span><span class="hs-comment">-- First, we process all the sections that actually appear in the</span><span>
</span><span id="line-772"></span><span>  </span><span class="hs-comment">-- INI file in order</span><span>
</span><span id="line-773"></span><span>  </span><span id="local-6989586621679054387"><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054387"><span class="hs-identifier hs-var">existingSections</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; ((NormalizedText, IniSection)
    -&gt; Either String (NormalizedText, IniSection))
-&gt; Either String (Seq (NormalizedText, IniSection))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">F.for</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054390"><span class="hs-identifier hs-var">sections</span></a></span><span> </span><span class="annot"><span class="annottext">(((NormalizedText, IniSection)
  -&gt; Either String (NormalizedText, IniSection))
 -&gt; Either String (Seq (NormalizedText, IniSection)))
-&gt; ((NormalizedText, IniSection)
    -&gt; Either String (NormalizedText, IniSection))
-&gt; Either String (Seq (NormalizedText, IniSection))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054385"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054385"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054384"><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054384"><span class="hs-identifier hs-var">sec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-774"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054383"><span class="annot"><span class="annottext">err :: Either String b
</span><a href="#local-6989586621679054383"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected top-level section: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054385"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-775"></span><span>    </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054382"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054382"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (Section s)
-&gt; (Section s -&gt; Either String (Section s))
-&gt; Maybe (Section s)
-&gt; Either String (Section s)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Either String (Section s)
forall b. Either String b
</span><a href="#local-6989586621679054383"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Section s -&gt; Either String (Section s)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-776"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Section s -&gt; Bool) -&gt; Seq (Section s) -&gt; Maybe (Section s)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">F.find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span id="local-6989586621679054380"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054380"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054380"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; NormalizedText -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054385"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054389"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621679054379"><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054379"><span class="hs-identifier hs-var">newVals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">s
-&gt; Seq (NormalizedText, IniValue)
-&gt; Seq (Field s)
-&gt; UpdatePolicy
-&gt; Either String (Seq (NormalizedText, IniValue))
forall s.
s
-&gt; Seq (NormalizedText, IniValue)
-&gt; Seq (Field s)
-&gt; UpdatePolicy
-&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="Data.Ini.Config.Bidir.html#updateFields"><span class="hs-identifier hs-var">updateFields</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054392"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniSection -&gt; Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Raw.html#isVals"><span class="hs-identifier hs-var hs-var">isVals</span></a></span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054384"><span class="hs-identifier hs-var">sec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054382"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054388"><span class="hs-identifier hs-var">pol</span></a></span><span>
</span><span id="line-778"></span><span>    </span><span class="annot"><span class="annottext">(NormalizedText, IniSection)
-&gt; Either String (NormalizedText, IniSection)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054385"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniSection
</span><a href="#local-6989586621679054384"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">isVals :: Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Raw.html#isVals"><span class="hs-identifier hs-var">isVals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054379"><span class="hs-identifier hs-var">newVals</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>  </span><span class="hs-comment">-- And then</span><span>
</span><span id="line-780"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054377"><span class="annot"><span class="annottext">existingSectionNames :: Seq NormalizedText
</span><a href="#local-6989586621679054377"><span class="hs-identifier hs-var hs-var">existingSectionNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((NormalizedText, IniSection) -&gt; NormalizedText)
-&gt; Seq (NormalizedText, IniSection) -&gt; Seq NormalizedText
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniSection) -&gt; NormalizedText
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054387"><span class="hs-identifier hs-var">existingSections</span></a></span><span>
</span><span id="line-781"></span><span>  </span><span id="local-6989586621679054376"><span class="annot"><span class="annottext">Seq (Seq (NormalizedText, IniSection))
</span><a href="#local-6989586621679054376"><span class="hs-identifier hs-var">newSections</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Seq (Section s)
-&gt; (Section s -&gt; Either String (Seq (NormalizedText, IniSection)))
-&gt; Either String (Seq (Seq (NormalizedText, IniSection)))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">F.for</span></span><span> </span><span class="annot"><span class="annottext">Seq (Section s)
</span><a href="#local-6989586621679054389"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">((Section s -&gt; Either String (Seq (NormalizedText, IniSection)))
 -&gt; Either String (Seq (Seq (NormalizedText, IniSection))))
-&gt; (Section s -&gt; Either String (Seq (NormalizedText, IniSection)))
-&gt; Either String (Seq (Seq (NormalizedText, IniSection)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-782"></span><span>    </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Section"><span class="hs-identifier hs-type">Section</span></a></span><span> </span><span id="local-6989586621679054375"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054375"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621679054374"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054374"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-783"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054375"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq NormalizedText -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Seq NormalizedText
</span><a href="#local-6989586621679054377"><span class="hs-identifier hs-var">existingSectionNames</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; Either String (Seq (NormalizedText, IniSection))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-784"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-785"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054372"><span class="annot"><span class="annottext">rs :: Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054372"><span class="hs-identifier hs-var hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
-&gt; s
-&gt; Seq (Field s)
-&gt; UpdatePolicy
-&gt; Seq (NormalizedText, IniValue)
forall s.
s
-&gt; s
-&gt; Seq (Field s)
-&gt; UpdatePolicy
-&gt; Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Bidir.html#emitNewFields"><span class="hs-identifier hs-var">emitNewFields</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054392"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054391"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054374"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054388"><span class="hs-identifier hs-var">pol</span></a></span><span>
</span><span id="line-786"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue) -&gt; Bool
forall a. Seq a -&gt; Bool
</span><span class="hs-identifier hs-var">Seq.null</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054372"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-787"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; Either String (Seq (NormalizedText, IniSection))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-788"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; Either String (Seq (NormalizedText, IniSection))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Seq (NormalizedText, IniSection)
 -&gt; Either String (Seq (NormalizedText, IniSection)))
-&gt; Seq (NormalizedText, IniSection)
-&gt; Either String (Seq (NormalizedText, IniSection))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniSection) -&gt; Seq (NormalizedText, IniSection)
forall a. a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.singleton</span></span><span>
</span><span id="line-789"></span><span>                       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054375"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-790"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Seq (NormalizedText, IniValue)
-&gt; Int
-&gt; Int
-&gt; Seq BlankLine
-&gt; IniSection
</span><a href="Data.Ini.Config.Raw.html#IniSection"><span class="hs-identifier hs-var">IniSection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#actualText"><span class="hs-identifier hs-var hs-var">actualText</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054375"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054372"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Seq BlankLine
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-791"></span><span>                       </span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>  </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; Either String (Seq (NormalizedText, IniSection))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
</span><a href="#local-6989586621679054387"><span class="hs-identifier hs-var">existingSections</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniSection)
-&gt; Seq (NormalizedText, IniSection)
-&gt; Seq (NormalizedText, IniSection)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq (Seq (NormalizedText, IniSection))
-&gt; Seq (NormalizedText, IniSection)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Foldable t, Alternative f) =&gt;
t (f a) -&gt; f a
</span><span class="hs-identifier hs-var">F.asum</span></span><span> </span><span class="annot"><span class="annottext">Seq (Seq (NormalizedText, IniSection))
</span><a href="#local-6989586621679054376"><span class="hs-identifier hs-var">newSections</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span class="hs-comment">-- We won't emit a section if everything in the section is also</span><span>
</span><span id="line-795"></span><span class="hs-comment">-- missing</span><span>
</span><span id="line-796"></span><span id="local-6989586621679054790"><span class="annot"><a href="Data.Ini.Config.Bidir.html#emitNewFields"><span class="hs-identifier hs-type">emitNewFields</span></a></span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054790"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054790"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-798"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054790"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-type">UpdatePolicy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-800"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-801"></span><span id="emitNewFields"><span class="annot"><span class="annottext">emitNewFields :: s
-&gt; s
-&gt; Seq (Field s)
-&gt; UpdatePolicy
-&gt; Seq (NormalizedText, IniValue)
</span><a href="Data.Ini.Config.Bidir.html#emitNewFields"><span class="hs-identifier hs-var hs-var">emitNewFields</span></a></span></span><span> </span><span id="local-6989586621679054367"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054367"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679054366"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054366"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621679054365"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054365"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679054364"><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054364"><span class="hs-identifier hs-var">pol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054363"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054365"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-802"></span><span>  </span><span id="local-6989586621679054363"><span class="annot"><span class="annottext">go :: ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054363"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">ViewL (Field s)
</span><span class="hs-identifier hs-var">EmptyL</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-803"></span><span>  </span><span class="annot"><a href="#local-6989586621679054363"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span id="local-6989586621679054362"><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054362"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054361"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054361"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679054360"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054360"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>    </span><span class="hs-comment">-- If a field is not present but is also the same as the default,</span><span>
</span><span id="line-805"></span><span>    </span><span class="hs-comment">-- then we can safely omit it</span><span>
</span><span id="line-806"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Lens s s a a -&gt; s -&gt; a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054362"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054367"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Lens s s a a -&gt; s -&gt; a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054362"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054366"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdatePolicy -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#updateAddOptionalFields"><span class="hs-identifier hs-var hs-var">updateAddOptionalFields</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054364"><span class="hs-identifier hs-var">pol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-807"></span><span>      </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054363"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054360"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>    </span><span class="hs-comment">-- otherwise, we should add it to the result</span><span>
</span><span id="line-809"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-810"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054357"><span class="annot"><span class="annottext">cs :: Seq BlankLine
</span><a href="#local-6989586621679054357"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldDescription a -&gt; UpdateCommentPolicy -&gt; Seq BlankLine
forall s.
FieldDescription s -&gt; UpdateCommentPolicy -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#getComments"><span class="hs-identifier hs-var">getComments</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054361"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdatePolicy -&gt; UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#updateGeneratedCommentPolicy"><span class="hs-identifier hs-var hs-var">updateGeneratedCommentPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054364"><span class="hs-identifier hs-var">pol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-811"></span><span>          </span><span id="local-6989586621679054356"><span class="annot"><span class="annottext">new :: (NormalizedText, IniValue)
</span><a href="#local-6989586621679054356"><span class="hs-identifier hs-var hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FieldDescription a -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054361"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-812"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue :: Int -&gt; Text -&gt; Text -&gt; Seq BlankLine -&gt; Bool -&gt; Char -&gt; IniValue
</span><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span>
</span><span id="line-813"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vLineNo :: Int
</span><a href="Data.Ini.Config.Raw.html#vLineNo"><span class="hs-identifier hs-var">vLineNo</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-814"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vName :: Text
</span><a href="Data.Ini.Config.Raw.html#vName"><span class="hs-identifier hs-var">vName</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#actualText"><span class="hs-identifier hs-var hs-var">actualText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054361"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vValue :: Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var">vValue</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldValue a -&gt; a -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054361"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens s s a a -&gt; s -&gt; a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054362"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054367"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vComments :: Seq BlankLine
</span><a href="Data.Ini.Config.Raw.html#vComments"><span class="hs-identifier hs-var">vComments</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq BlankLine
</span><a href="#local-6989586621679054357"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-817"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vCommentedOut :: Bool
</span><a href="Data.Ini.Config.Raw.html#vCommentedOut"><span class="hs-identifier hs-var">vCommentedOut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-818"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vDelimiter :: Char
</span><a href="Data.Ini.Config.Raw.html#vDelimiter"><span class="hs-identifier hs-var">vDelimiter</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span>
</span><span id="line-819"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-820"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
</span><a href="#local-6989586621679054356"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054363"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054360"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>  </span><span class="annot"><a href="#local-6989586621679054363"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span id="local-6989586621679054355"><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054355"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054354"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054354"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679054353"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054353"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-823"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a) -&gt; s -&gt; Maybe a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054355"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054367"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-824"></span><span>      </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054363"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054353"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054352"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054352"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-826"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054351"><span class="annot"><span class="annottext">cs :: Seq BlankLine
</span><a href="#local-6989586621679054351"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldDescription a -&gt; UpdateCommentPolicy -&gt; Seq BlankLine
forall s.
FieldDescription s -&gt; UpdateCommentPolicy -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#getComments"><span class="hs-identifier hs-var">getComments</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054354"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdatePolicy -&gt; UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#updateGeneratedCommentPolicy"><span class="hs-identifier hs-var hs-var">updateGeneratedCommentPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054364"><span class="hs-identifier hs-var">pol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>            </span><span id="local-6989586621679054350"><span class="annot"><span class="annottext">new :: (NormalizedText, IniValue)
</span><a href="#local-6989586621679054350"><span class="hs-identifier hs-var hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FieldDescription a -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054354"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-828"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue :: Int -&gt; Text -&gt; Text -&gt; Seq BlankLine -&gt; Bool -&gt; Char -&gt; IniValue
</span><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span>
</span><span id="line-829"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vLineNo :: Int
</span><a href="Data.Ini.Config.Raw.html#vLineNo"><span class="hs-identifier hs-var">vLineNo</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-830"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vName :: Text
</span><a href="Data.Ini.Config.Raw.html#vName"><span class="hs-identifier hs-var">vName</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#actualText"><span class="hs-identifier hs-var hs-var">actualText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; NormalizedText
forall t. FieldDescription t -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fdName"><span class="hs-identifier hs-var hs-var">fdName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054354"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-831"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vValue :: Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var">vValue</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue a -&gt; a -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054354"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054352"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-832"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vComments :: Seq BlankLine
</span><a href="Data.Ini.Config.Raw.html#vComments"><span class="hs-identifier hs-var">vComments</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq BlankLine
</span><a href="#local-6989586621679054351"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-833"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vCommentedOut :: Bool
</span><a href="Data.Ini.Config.Raw.html#vCommentedOut"><span class="hs-identifier hs-var">vCommentedOut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-834"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vDelimiter :: Char
</span><a href="Data.Ini.Config.Raw.html#vDelimiter"><span class="hs-identifier hs-var">vDelimiter</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span>
</span><span id="line-835"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-836"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-837"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
</span><a href="#local-6989586621679054350"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054363"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054353"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span id="local-6989586621679054796"><span class="annot"><a href="Data.Ini.Config.Bidir.html#updateFields"><span class="hs-identifier hs-type">updateFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679054796"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679054796"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#UpdatePolicy"><span class="hs-identifier hs-type">UpdatePolicy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Raw.html#NormalizedText"><span class="hs-identifier hs-type">NormalizedText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-842"></span><span id="updateFields"><span class="annot"><span class="annottext">updateFields :: s
-&gt; Seq (NormalizedText, IniValue)
-&gt; Seq (Field s)
-&gt; UpdatePolicy
-&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="Data.Ini.Config.Bidir.html#updateFields"><span class="hs-identifier hs-var hs-var">updateFields</span></a></span></span><span> </span><span id="local-6989586621679054349"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054349"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679054348"><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054348"><span class="hs-identifier hs-var">values</span></a></span></span><span> </span><span id="local-6989586621679054347"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054347"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679054346"><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054346"><span class="hs-identifier hs-var">pol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniValue)
-&gt; Seq (Field s) -&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="#local-6989586621679054345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue) -&gt; ViewL (NormalizedText, IniValue)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054348"><span class="hs-identifier hs-var">values</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054347"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-843"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054345"><span class="annot"><span class="annottext">go :: ViewL (NormalizedText, IniValue)
-&gt; Seq (Field s) -&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="#local-6989586621679054345"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679054344"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054343"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054343"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679054342"><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054342"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054341"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054341"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-844"></span><span>          </span><span class="hs-comment">-- For each field, we need to fetch the description of the</span><span>
</span><span id="line-845"></span><span>          </span><span class="hs-comment">-- field in the spec</span><span>
</span><span id="line-846"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Field s -&gt; Bool) -&gt; Seq (Field s) -&gt; Maybe (Field s)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">F.find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679054340"><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054340"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Field s -&gt; NormalizedText
forall s. Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054340"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; NormalizedText -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054341"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-847"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054339"><span class="annot"><span class="annottext">f :: Field s
</span><a href="#local-6989586621679054339"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span id="local-6989586621679054338"><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054338"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054337"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054337"><span class="hs-identifier hs-var">descr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-848"></span><span>              </span><span class="hs-comment">-- if it does exist, then we need to find out whether</span><span>
</span><span id="line-849"></span><span>              </span><span class="hs-comment">-- the field has changed at all. We can do this with the</span><span>
</span><span id="line-850"></span><span>              </span><span class="hs-comment">-- provided lens, and check it against the INI file</span><span>
</span><span id="line-851"></span><span>              </span><span class="hs-comment">-- we've got. There's a minor complication: there's</span><span>
</span><span id="line-852"></span><span>              </span><span class="hs-comment">-- nothing that forces the user to provide the same INI</span><span>
</span><span id="line-853"></span><span>              </span><span class="hs-comment">-- file we originally parsed! One side-effect means that</span><span>
</span><span id="line-854"></span><span>              </span><span class="hs-comment">-- the parsed INI file might not actually have a valid</span><span>
</span><span id="line-855"></span><span>              </span><span class="hs-comment">-- field according to the field parser the user</span><span>
</span><span id="line-856"></span><span>              </span><span class="hs-comment">-- provides. In that case, we'll assume the field is</span><span>
</span><span id="line-857"></span><span>              </span><span class="hs-comment">-- outdated, and update it with the value in the</span><span>
</span><span id="line-858"></span><span>              </span><span class="hs-comment">-- provided structure.</span><span>
</span><span id="line-859"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens s s a a -&gt; s -&gt; a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054338"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054349"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either String a -&gt; Either String a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FieldValue a -&gt; Text -&gt; Either String a
forall a. FieldValue a -&gt; Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var hs-var">fvParse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054337"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var hs-var">vValue</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054343"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>                 </span><span class="hs-comment">-- if the value in the INI file parses the same as</span><span>
</span><span id="line-861"></span><span>                 </span><span class="hs-comment">-- the one in the structure we were passed, then it</span><span>
</span><span id="line-862"></span><span>                 </span><span class="hs-comment">-- doesn't need any updating, and we keep going,</span><span>
</span><span id="line-863"></span><span>                 </span><span class="hs-comment">-- removing the field from our list</span><span>
</span><span id="line-864"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054343"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniValue)
-&gt; Seq (Field s) -&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="#local-6989586621679054345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue) -&gt; ViewL (NormalizedText, IniValue)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054342"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
forall s. NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
</span><a href="Data.Ini.Config.Bidir.html#rmv"><span class="hs-identifier hs-var">rmv</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054341"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span>                 </span><span class="hs-comment">-- otherwise, we've got a new updated value! Let's</span><span>
</span><span id="line-866"></span><span>                 </span><span class="hs-comment">-- synthesize a new element, using our comment policy</span><span>
</span><span id="line-867"></span><span>                 </span><span class="hs-comment">-- to comment it accordingly. (This pattern is</span><span>
</span><span id="line-868"></span><span>                 </span><span class="hs-comment">-- partial, but we should never have a situation</span><span>
</span><span id="line-869"></span><span>                 </span><span class="hs-comment">-- where it returns Nothing, because we already know</span><span>
</span><span id="line-870"></span><span>                 </span><span class="hs-comment">-- that we've matched a Field!)</span><span>
</span><span id="line-871"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054336"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054336"><span class="hs-identifier hs-var">nv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Field s -&gt; Char -&gt; Maybe IniValue
</span><a href="#local-6989586621679054335"><span class="hs-identifier hs-var">mkValue</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054339"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Char
</span><a href="Data.Ini.Config.Raw.html#vDelimiter"><span class="hs-identifier hs-var hs-var">vDelimiter</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054343"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054336"><span class="hs-identifier hs-var">nv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniValue)
-&gt; Seq (Field s) -&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="#local-6989586621679054345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue) -&gt; ViewL (NormalizedText, IniValue)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054342"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
forall s. NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
</span><a href="Data.Ini.Config.Bidir.html#rmv"><span class="hs-identifier hs-var">rmv</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054341"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span>              </span><span class="hs-comment">-- And we have to replicate the logic for the FieldMb</span><span>
</span><span id="line-874"></span><span>              </span><span class="hs-comment">-- case, because (as an existential) it doesn't really</span><span>
</span><span id="line-875"></span><span>              </span><span class="hs-comment">-- permit us usable abstractions here. See the previous</span><span>
</span><span id="line-876"></span><span>              </span><span class="hs-comment">-- comments for descriptions of the cases.</span><span>
</span><span id="line-877"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054334"><span class="annot"><span class="annottext">f :: Field s
</span><a href="#local-6989586621679054334"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span id="local-6989586621679054333"><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054333"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054332"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054332"><span class="hs-identifier hs-var">descr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-878"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054331"><span class="annot"><span class="annottext">parsed :: Either String a
</span><a href="#local-6989586621679054331"><span class="hs-identifier hs-var hs-var">parsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldValue a -&gt; Text -&gt; Either String a
forall a. FieldValue a -&gt; Text -&gt; Either String a
</span><a href="Data.Ini.Config.Bidir.html#fvParse"><span class="hs-identifier hs-var hs-var">fvParse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054332"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var hs-var">vValue</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054343"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Either String (Maybe a)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a) -&gt; s -&gt; Maybe a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054333"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054349"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either String (Maybe a) -&gt; Either String (Maybe a) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; Either String a -&gt; Either String (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Either String a
</span><a href="#local-6989586621679054331"><span class="hs-identifier hs-var">parsed</span></a></span><span>
</span><span id="line-880"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054343"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniValue)
-&gt; Seq (Field s) -&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="#local-6989586621679054345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue) -&gt; ViewL (NormalizedText, IniValue)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054342"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
forall s. NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
</span><a href="Data.Ini.Config.Bidir.html#rmv"><span class="hs-identifier hs-var">rmv</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054341"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>                   </span><span class="hs-comment">-- this is in the only case where the FieldMb case</span><span>
</span><span id="line-882"></span><span>                   </span><span class="hs-comment">-- differs: we might NOT have a value in the</span><span>
</span><span id="line-883"></span><span>                   </span><span class="hs-comment">-- structure. In that case, we remove the value</span><span>
</span><span id="line-884"></span><span>                   </span><span class="hs-comment">-- from the file, as well!</span><span>
</span><span id="line-885"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Field s -&gt; Char -&gt; Maybe IniValue
</span><a href="#local-6989586621679054335"><span class="hs-identifier hs-var">mkValue</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054334"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue -&gt; Char
</span><a href="Data.Ini.Config.Raw.html#vDelimiter"><span class="hs-identifier hs-var hs-var">vDelimiter</span></a></span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054343"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-886"></span><span>                         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054330"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054330"><span class="hs-identifier hs-var">nv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054330"><span class="hs-identifier hs-var">nv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniValue)
-&gt; Seq (Field s) -&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="#local-6989586621679054345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue) -&gt; ViewL (NormalizedText, IniValue)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054342"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
forall s. NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
</span><a href="Data.Ini.Config.Bidir.html#rmv"><span class="hs-identifier hs-var">rmv</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054341"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>                         </span><span class="annot"><span class="annottext">Maybe IniValue
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniValue)
-&gt; Seq (Field s) -&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="#local-6989586621679054345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue) -&gt; ViewL (NormalizedText, IniValue)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054342"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
forall s. NormalizedText -&gt; Seq (Field s) -&gt; Seq (Field s)
</span><a href="Data.Ini.Config.Bidir.html#rmv"><span class="hs-identifier hs-var">rmv</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054341"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>            </span><span class="hs-comment">-- Finally, if we can't find any description of the field,</span><span>
</span><span id="line-889"></span><span>            </span><span class="hs-comment">-- then we might skip it or throw an error, depending on</span><span>
</span><span id="line-890"></span><span>            </span><span class="hs-comment">-- the policy the user wants.</span><span>
</span><span id="line-891"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Field s)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-892"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UpdatePolicy -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#updateIgnoreExtraneousFields"><span class="hs-identifier hs-var hs-var">updateIgnoreExtraneousFields</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054346"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-893"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054343"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
-&gt; Either String (Seq (NormalizedText, IniValue))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniValue)
-&gt; Seq (Field s) -&gt; Either String (Seq (NormalizedText, IniValue))
</span><a href="#local-6989586621679054345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue) -&gt; ViewL (NormalizedText, IniValue)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054342"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054341"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-894"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Seq (NormalizedText, IniValue))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected field: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054344"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>        </span><span class="hs-comment">-- Once we've gone through all the fields in the file, we need</span><span>
</span><span id="line-896"></span><span>        </span><span class="hs-comment">-- to see if there's anything left over that should be in the</span><span>
</span><span id="line-897"></span><span>        </span><span class="hs-comment">-- file. We might want to include dummy values for things that</span><span>
</span><span id="line-898"></span><span>        </span><span class="hs-comment">-- were left out, but if we have any non-optional fields left</span><span>
</span><span id="line-899"></span><span>        </span><span class="hs-comment">-- over, then we definitely need to include them.</span><span>
</span><span id="line-900"></span><span>        </span><span class="annot"><a href="#local-6989586621679054345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ViewL (NormalizedText, IniValue)
</span><span class="hs-identifier hs-var">EmptyL</span></span><span> </span><span id="local-6989586621679054329"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054329"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
-&gt; Either String (Seq (NormalizedText, IniValue))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054329"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>        </span><span id="local-6989586621679054328"><span class="annot"><span class="annottext">finish :: ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054327"><span class="annot"><span class="annottext">f :: Field s
</span><a href="#local-6989586621679054327"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679054326"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054326"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UpdatePolicy -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#updateAddOptionalFields"><span class="hs-identifier hs-var hs-var">updateAddOptionalFields</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054346"><span class="hs-identifier hs-var">pol</span></a></span><span>
</span><span id="line-903"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054325"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054325"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Field s -&gt; Char -&gt; Maybe IniValue
</span><a href="#local-6989586621679054335"><span class="hs-identifier hs-var">mkValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Field s -&gt; NormalizedText
forall s. Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054327"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054327"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-904"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Field s -&gt; NormalizedText
forall s. Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054327"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054325"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054326"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-905"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054326"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>        </span><span class="annot"><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054324"><span class="annot"><span class="annottext">f :: Field s
</span><a href="#local-6989586621679054324"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054323"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054323"><span class="hs-identifier hs-var">descr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679054322"><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054322"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; Bool
forall t. FieldDescription t -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#fdSkipIfMissing"><span class="hs-identifier hs-var hs-var">fdSkipIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054323"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-908"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054321"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054321"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Field s -&gt; Char -&gt; Maybe IniValue
</span><a href="#local-6989586621679054335"><span class="hs-identifier hs-var">mkValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Field s -&gt; NormalizedText
forall s. Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054324"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054324"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-909"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Field s -&gt; NormalizedText
forall s. Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054324"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054321"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054322"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UpdatePolicy -&gt; Bool
</span><a href="Data.Ini.Config.Bidir.html#updateAddOptionalFields"><span class="hs-identifier hs-var hs-var">updateAddOptionalFields</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054346"><span class="hs-identifier hs-var">pol</span></a></span><span>
</span><span id="line-911"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054320"><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054320"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Field s -&gt; Char -&gt; Maybe IniValue
</span><a href="#local-6989586621679054335"><span class="hs-identifier hs-var">mkValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Field s -&gt; NormalizedText
forall s. Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054324"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054324"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-912"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Field s -&gt; NormalizedText
forall s. Field s -&gt; NormalizedText
</span><a href="Data.Ini.Config.Bidir.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054324"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054320"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalizedText, IniValue)
-&gt; Seq (NormalizedText, IniValue) -&gt; Seq (NormalizedText, IniValue)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054322"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ViewL (Field s) -&gt; Seq (NormalizedText, IniValue)
</span><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Field s) -&gt; ViewL (Field s)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">Seq.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (Field s)
</span><a href="#local-6989586621679054322"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>        </span><span class="hs-comment">-- If there's nothing left, then we can return a final value!</span><span>
</span><span id="line-915"></span><span>        </span><span class="annot"><a href="#local-6989586621679054328"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">ViewL (Field s)
</span><span class="hs-identifier hs-var">EmptyL</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (NormalizedText, IniValue)
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-916"></span><span>        </span><span id="local-6989586621679054335"><span class="annot"><span class="annottext">mkValue :: NormalizedText -&gt; Field s -&gt; Char -&gt; Maybe IniValue
</span><a href="#local-6989586621679054335"><span class="hs-identifier hs-var hs-var">mkValue</span></a></span></span><span> </span><span id="local-6989586621679054319"><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054319"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679054318"><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054318"><span class="hs-identifier hs-var">fld</span></a></span></span><span> </span><span id="local-6989586621679054317"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679054317"><span class="hs-identifier hs-var">delim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-917"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054316"><span class="annot"><span class="annottext">comments :: Seq BlankLine
</span><a href="#local-6989586621679054316"><span class="hs-identifier hs-var hs-var">comments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UpdatePolicy -&gt; UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#updateGeneratedCommentPolicy"><span class="hs-identifier hs-var hs-var">updateGeneratedCommentPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">UpdatePolicy
</span><a href="#local-6989586621679054346"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-918"></span><span>                </span><span class="annot"><span class="annottext">UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#CommentPolicyNone"><span class="hs-identifier hs-var">CommentPolicyNone</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq BlankLine
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-919"></span><span>                </span><span class="annot"><span class="annottext">UpdateCommentPolicy
</span><a href="Data.Ini.Config.Bidir.html#CommentPolicyAddFieldComment"><span class="hs-identifier hs-var">CommentPolicyAddFieldComment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-920"></span><span>                  </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#mkComments"><span class="hs-identifier hs-var">mkComments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Field s -&gt; Seq Text
forall s. Field s -&gt; Seq Text
</span><a href="Data.Ini.Config.Bidir.html#fieldComment"><span class="hs-identifier hs-var">fieldComment</span></a></span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054318"><span class="hs-identifier hs-var">fld</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>                </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#CommentPolicyAddDefaultComment"><span class="hs-identifier hs-type">CommentPolicyAddDefaultComment</span></a></span><span> </span><span id="local-6989586621679054315"><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054315"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-922"></span><span>                  </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq BlankLine
</span><a href="Data.Ini.Config.Bidir.html#mkComments"><span class="hs-identifier hs-var">mkComments</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679054315"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-923"></span><span>              </span><span id="local-6989586621679054314"><span class="annot"><span class="annottext">val :: IniValue
</span><a href="#local-6989586621679054314"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IniValue :: Int -&gt; Text -&gt; Text -&gt; Seq BlankLine -&gt; Bool -&gt; Char -&gt; IniValue
</span><a href="Data.Ini.Config.Raw.html#IniValue"><span class="hs-identifier hs-type">IniValue</span></a></span><span>
</span><span id="line-924"></span><span>                      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vLineNo :: Int
</span><a href="Data.Ini.Config.Raw.html#vLineNo"><span class="hs-identifier hs-var">vLineNo</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-925"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vName :: Text
</span><a href="Data.Ini.Config.Raw.html#vName"><span class="hs-identifier hs-var">vName</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalizedText -&gt; Text
</span><a href="Data.Ini.Config.Raw.html#actualText"><span class="hs-identifier hs-var hs-var">actualText</span></a></span><span> </span><span class="annot"><span class="annottext">NormalizedText
</span><a href="#local-6989586621679054319"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-926"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vValue :: Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var">vValue</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-927"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vComments :: Seq BlankLine
</span><a href="Data.Ini.Config.Raw.html#vComments"><span class="hs-identifier hs-var">vComments</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq BlankLine
</span><a href="#local-6989586621679054316"><span class="hs-identifier hs-var">comments</span></a></span><span>
</span><span id="line-928"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vCommentedOut :: Bool
</span><a href="Data.Ini.Config.Raw.html#vCommentedOut"><span class="hs-identifier hs-var">vCommentedOut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-929"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">vDelimiter :: Char
</span><a href="Data.Ini.Config.Raw.html#vDelimiter"><span class="hs-identifier hs-var">vDelimiter</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679054317"><span class="hs-identifier hs-var">delim</span></a></span><span>
</span><span id="line-930"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-931"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Field s
</span><a href="#local-6989586621679054318"><span class="hs-identifier hs-var">fld</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-932"></span><span>               </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span id="local-6989586621679054313"><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054313"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054312"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054312"><span class="hs-identifier hs-var">descr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-933"></span><span>                 </span><span class="annot"><span class="annottext">IniValue -&gt; Maybe IniValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054314"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vValue :: Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var">vValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldValue a -&gt; a -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054312"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens s s a a -&gt; s -&gt; a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s a a
</span><a href="#local-6989586621679054313"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054349"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>               </span><span class="annot"><a href="Data.Ini.Config.Bidir.html#FieldMb"><span class="hs-identifier hs-type">FieldMb</span></a></span><span> </span><span id="local-6989586621679054311"><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054311"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679054310"><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054310"><span class="hs-identifier hs-var">descr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-935"></span><span>                 </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a) -&gt; s -&gt; Maybe a
forall s t a b. Lens s t a b -&gt; s -&gt; a
</span><a href="Data.Ini.Config.Bidir.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Lens s s (Maybe a) (Maybe a)
</span><a href="#local-6989586621679054311"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679054349"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-936"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054309"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054309"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IniValue -&gt; Maybe IniValue
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IniValue
</span><a href="#local-6989586621679054314"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vValue :: Text
</span><a href="Data.Ini.Config.Raw.html#vValue"><span class="hs-identifier hs-var">vValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldValue a -&gt; a -&gt; Text
forall a. FieldValue a -&gt; a -&gt; Text
</span><a href="Data.Ini.Config.Bidir.html#fvEmit"><span class="hs-identifier hs-var hs-var">fvEmit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDescription a -&gt; FieldValue a
forall t. FieldDescription t -&gt; FieldValue t
</span><a href="Data.Ini.Config.Bidir.html#fdValue"><span class="hs-identifier hs-var hs-var">fdValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDescription a
</span><a href="#local-6989586621679054310"><span class="hs-identifier hs-var">descr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054309"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>                   </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe IniValue
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="hs-comment">-- $using</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- Functions for parsing, serializing, and updating INI files.</span><span>
</span><span id="line-942"></span><span>
</span><span id="line-943"></span><span class="hs-comment">-- $types</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- Types which represent declarative specifications for INI</span><span>
</span><span id="line-945"></span><span class="hs-comment">-- file structure.</span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span class="hs-comment">-- $sections</span><span>
</span><span id="line-948"></span><span class="hs-comment">-- Declaring sections of an INI file specification</span><span>
</span><span id="line-949"></span><span>
</span><span id="line-950"></span><span class="hs-comment">-- $fields</span><span>
</span><span id="line-951"></span><span class="hs-comment">-- Declaring individual fields of an INI file specification.</span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span class="hs-comment">-- $fieldvalues</span><span>
</span><span id="line-954"></span><span class="hs-comment">-- Values of type 'FieldValue' represent both a parser and a</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- serializer for a value of a given type. It's possible to manually</span><span>
</span><span id="line-956"></span><span class="hs-comment">-- create 'FieldValue' descriptions, but for simple configurations,</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- but for the sake of convenience, several commonly-needed</span><span>
</span><span id="line-958"></span><span class="hs-comment">-- varieties of 'FieldValue' are defined here.</span><span>
</span><span id="line-959"></span><span>
</span><span id="line-960"></span><span class="hs-comment">-- $misc</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- These values and types are exported for compatibility.</span><span>
</span><span id="line-962"></span></pre></body></html>