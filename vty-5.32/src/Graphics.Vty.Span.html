<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright Corey O'Connor</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- | A picture is translated into a sequences of state changes and</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- character spans. The attribute is applied to all following spans,</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- including spans of the next row. The nth element of the sequence</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- represents the nth row (from top to bottom) of the picture to render.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- A span op sequence will be defined for all rows and columns (and no</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- more) of the region provided with the picture to 'spansForPic'.</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Graphics.Vty.Span</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Attributes.html"><span class="hs-identifier">Graphics.Vty.Attributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Attributes.html#Attr"><span class="hs-identifier">Attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Image.html"><span class="hs-identifier">Graphics.Vty.Image</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Image.Internal.html"><span class="hs-identifier">Graphics.Vty.Image.Internal</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Graphics.Vty.Image.Internal.html#clipText"><span class="hs-identifier">clipText</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TL</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vector</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- | This represents an operation on the terminal: either an attribute</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- change or the output of a text string.</span><span>
</span><span id="line-24"></span><span class="hs-keyword">data</span><span> </span><span id="SpanOp"><span class="annot"><a href="Graphics.Vty.Span.html#SpanOp"><span class="hs-identifier hs-var">SpanOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-comment">-- | A span of UTF-8 text occupies a specific number of screen space</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-comment">-- columns. A single UTF character does not necessarily represent 1</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-comment">-- colunm. See Codec.Binary.UTF8.Width TextSpan [Attr] [output width</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-comment">-- in columns] [number of characters] [data]</span><span>
</span><span id="line-29"></span><span>      </span><span id="TextSpan"><span class="annot"><a href="Graphics.Vty.Span.html#TextSpan"><span class="hs-identifier hs-var">TextSpan</span></a></span></span><span>
</span><span id="line-30"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="textSpanAttr"><span class="annot"><span class="annottext">SpanOp -&gt; Attr
</span><a href="Graphics.Vty.Span.html#textSpanAttr"><span class="hs-identifier hs-var hs-var">textSpanAttr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Graphics.Vty.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a></span><span>
</span><span id="line-31"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="textSpanOutputWidth"><span class="annot"><span class="annottext">SpanOp -&gt; Int
</span><a href="Graphics.Vty.Span.html#textSpanOutputWidth"><span class="hs-identifier hs-var hs-var">textSpanOutputWidth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-32"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="textSpanCharWidth"><span class="annot"><span class="annottext">SpanOp -&gt; Int
</span><a href="Graphics.Vty.Span.html#textSpanCharWidth"><span class="hs-identifier hs-var hs-var">textSpanCharWidth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-33"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="textSpanText"><span class="annot"><span class="annottext">SpanOp -&gt; DisplayText
</span><a href="Graphics.Vty.Span.html#textSpanText"><span class="hs-identifier hs-var hs-var">textSpanText</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Image.Internal.html#DisplayText"><span class="hs-identifier hs-type">DisplayText</span></a></span><span>
</span><span id="line-34"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-comment">-- | Skips the given number of columns.</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Skip"><span class="annot"><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-comment">-- | Marks the end of a row. Specifies how many columns are</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-comment">-- remaining. These columns will not be explicitly overwritten with</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-comment">-- the span ops. The terminal is require to assure the remaining</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-comment">-- columns are clear.</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RowEnd"><span class="annot"><a href="Graphics.Vty.Span.html#RowEnd"><span class="hs-identifier hs-var">RowEnd</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679367541"><span id="local-6989586621679367543"><span class="annot"><span class="annottext">SpanOp -&gt; SpanOp -&gt; Bool
(SpanOp -&gt; SpanOp -&gt; Bool)
-&gt; (SpanOp -&gt; SpanOp -&gt; Bool) -&gt; Eq SpanOp
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SpanOp -&gt; SpanOp -&gt; Bool
$c/= :: SpanOp -&gt; SpanOp -&gt; Bool
== :: SpanOp -&gt; SpanOp -&gt; Bool
$c== :: SpanOp -&gt; SpanOp -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | A vector of span operations executed in succession. This represents</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- the operations required to render a row of the terminal. The</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- operations in one row may affect subsequent rows. For example,</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- setting the foreground color in one row will affect all subsequent</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- rows until the foreground color is changed.</span><span>
</span><span id="line-49"></span><span class="hs-keyword">type</span><span> </span><span id="SpanOps"><span class="annot"><a href="Graphics.Vty.Span.html#SpanOps"><span class="hs-identifier hs-var">SpanOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOp"><span class="hs-identifier hs-type">SpanOp</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Graphics.Vty.Span.html#dropOps"><span class="hs-identifier hs-type">dropOps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOps"><span class="hs-identifier hs-type">SpanOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOps"><span class="hs-identifier hs-type">SpanOps</span></a></span><span>
</span><span id="line-52"></span><span id="dropOps"><span class="annot"><span class="annottext">dropOps :: Int -&gt; SpanOps -&gt; SpanOps
</span><a href="Graphics.Vty.Span.html#dropOps"><span class="hs-identifier hs-var hs-var">dropOps</span></a></span></span><span> </span><span id="local-6989586621679367538"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367538"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SpanOps, SpanOps) -&gt; SpanOps
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((SpanOps, SpanOps) -&gt; SpanOps)
-&gt; (SpanOps -&gt; (SpanOps, SpanOps)) -&gt; SpanOps -&gt; SpanOps
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpanOps -&gt; (SpanOps, SpanOps)
</span><a href="Graphics.Vty.Span.html#splitOpsAt"><span class="hs-identifier hs-var">splitOpsAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367538"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Graphics.Vty.Span.html#splitOpsAt"><span class="hs-identifier hs-type">splitOpsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOps"><span class="hs-identifier hs-type">SpanOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOps"><span class="hs-identifier hs-type">SpanOps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOps"><span class="hs-identifier hs-type">SpanOps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span id="splitOpsAt"><span class="annot"><span class="annottext">splitOpsAt :: Int -&gt; SpanOps -&gt; (SpanOps, SpanOps)
</span><a href="Graphics.Vty.Span.html#splitOpsAt"><span class="hs-identifier hs-var hs-var">splitOpsAt</span></a></span></span><span> </span><span id="local-6989586621679367535"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367535"><span class="hs-identifier hs-var">inW</span></a></span></span><span> </span><span id="local-6989586621679367534"><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367534"><span class="hs-identifier hs-var">inOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpanOps -&gt; (SpanOps, SpanOps)
</span><a href="#local-6989586621679367533"><span class="hs-identifier hs-var">splitOpsAt'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367535"><span class="hs-identifier hs-var">inW</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367534"><span class="hs-identifier hs-var">inOps</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>        </span><span id="local-6989586621679367533"><span class="annot"><span class="annottext">splitOpsAt' :: Int -&gt; SpanOps -&gt; (SpanOps, SpanOps)
</span><a href="#local-6989586621679367533"><span class="hs-identifier hs-var hs-var">splitOpsAt'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679367532"><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367532"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOps
forall a. Vector a
</span><span class="hs-identifier hs-var">Vector.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367532"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>        </span><span class="annot"><a href="#local-6989586621679367533"><span class="hs-identifier hs-var">splitOpsAt'</span></a></span><span> </span><span id="local-6989586621679367530"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span></span><span> </span><span id="local-6989586621679367529"><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367529"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SpanOps -&gt; SpanOp
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">Vector.head</span></span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367529"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-59"></span><span>            </span><span id="local-6989586621679367527"><span class="annot"><span class="annottext">t :: SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#TextSpan"><span class="hs-identifier hs-type">TextSpan</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; Int
</span><a href="Graphics.Vty.Span.html#textSpanOutputWidth"><span class="hs-identifier hs-var hs-var">textSpanOutputWidth</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-60"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679367526"><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367526"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679367525"><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367525"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpanOps -&gt; (SpanOps, SpanOps)
</span><a href="#local-6989586621679367533"><span class="hs-identifier hs-var">splitOpsAt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; Int
</span><a href="Graphics.Vty.Span.html#textSpanOutputWidth"><span class="hs-identifier hs-var hs-var">textSpanOutputWidth</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOps -&gt; SpanOps
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.tail</span></span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367529"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOp -&gt; SpanOps -&gt; SpanOps
forall a. a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.cons</span></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367526"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367525"><span class="hs-identifier hs-var">post</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679367522"><span class="annot"><span class="annottext">preTxt :: DisplayText
</span><a href="#local-6989586621679367522"><span class="hs-identifier hs-var hs-var">preTxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayText -&gt; Int -&gt; Int -&gt; DisplayText
</span><a href="Graphics.Vty.Image.Internal.html#clipText"><span class="hs-identifier hs-var">clipText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOp -&gt; DisplayText
</span><a href="Graphics.Vty.Span.html#textSpanText"><span class="hs-identifier hs-var hs-var">textSpanText</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span>
</span><span id="line-64"></span><span>                         </span><span id="local-6989586621679367521"><span class="annot"><span class="annottext">preOp :: SpanOp
</span><a href="#local-6989586621679367521"><span class="hs-identifier hs-var hs-var">preOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TextSpan :: Attr -&gt; Int -&gt; Int -&gt; DisplayText -&gt; SpanOp
</span><a href="Graphics.Vty.Span.html#TextSpan"><span class="hs-identifier hs-type">TextSpan</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">textSpanAttr :: Attr
</span><a href="Graphics.Vty.Span.html#textSpanAttr"><span class="hs-identifier hs-var">textSpanAttr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; Attr
</span><a href="Graphics.Vty.Span.html#textSpanAttr"><span class="hs-identifier hs-var hs-var">textSpanAttr</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-65"></span><span>                                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">textSpanOutputWidth :: Int
</span><a href="Graphics.Vty.Span.html#textSpanOutputWidth"><span class="hs-identifier hs-var">textSpanOutputWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span>
</span><span id="line-66"></span><span>                                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">textSpanCharWidth :: Int
</span><a href="Graphics.Vty.Span.html#textSpanCharWidth"><span class="hs-identifier hs-var">textSpanCharWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Int) -&gt; Int64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">DisplayText -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="annot"><span class="annottext">DisplayText
</span><a href="#local-6989586621679367522"><span class="hs-identifier hs-var">preTxt</span></a></span><span>
</span><span id="line-67"></span><span>                                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">textSpanText :: DisplayText
</span><a href="Graphics.Vty.Span.html#textSpanText"><span class="hs-identifier hs-var">textSpanText</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayText
</span><a href="#local-6989586621679367522"><span class="hs-identifier hs-var">preTxt</span></a></span><span>
</span><span id="line-68"></span><span>                                           </span><span class="hs-special">}</span><span>
</span><span id="line-69"></span><span>                         </span><span id="local-6989586621679367518"><span class="annot"><span class="annottext">postWidth :: Int
</span><a href="#local-6989586621679367518"><span class="hs-identifier hs-var hs-var">postWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; Int
</span><a href="Graphics.Vty.Span.html#textSpanOutputWidth"><span class="hs-identifier hs-var hs-var">textSpanOutputWidth</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span>
</span><span id="line-70"></span><span>                         </span><span id="local-6989586621679367517"><span class="annot"><span class="annottext">postTxt :: DisplayText
</span><a href="#local-6989586621679367517"><span class="hs-identifier hs-var hs-var">postTxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayText -&gt; Int -&gt; Int -&gt; DisplayText
</span><a href="Graphics.Vty.Image.Internal.html#clipText"><span class="hs-identifier hs-var">clipText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOp -&gt; DisplayText
</span><a href="Graphics.Vty.Span.html#textSpanText"><span class="hs-identifier hs-var hs-var">textSpanText</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367518"><span class="hs-identifier hs-var">postWidth</span></a></span><span>
</span><span id="line-71"></span><span>                         </span><span id="local-6989586621679367516"><span class="annot"><span class="annottext">postOp :: SpanOp
</span><a href="#local-6989586621679367516"><span class="hs-identifier hs-var hs-var">postOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TextSpan :: Attr -&gt; Int -&gt; Int -&gt; DisplayText -&gt; SpanOp
</span><a href="Graphics.Vty.Span.html#TextSpan"><span class="hs-identifier hs-type">TextSpan</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">textSpanAttr :: Attr
</span><a href="Graphics.Vty.Span.html#textSpanAttr"><span class="hs-identifier hs-var">textSpanAttr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; Attr
</span><a href="Graphics.Vty.Span.html#textSpanAttr"><span class="hs-identifier hs-var hs-var">textSpanAttr</span></a></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367527"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-72"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">textSpanOutputWidth :: Int
</span><a href="Graphics.Vty.Span.html#textSpanOutputWidth"><span class="hs-identifier hs-var">textSpanOutputWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367518"><span class="hs-identifier hs-var">postWidth</span></a></span><span>
</span><span id="line-73"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">textSpanCharWidth :: Int
</span><a href="Graphics.Vty.Span.html#textSpanCharWidth"><span class="hs-identifier hs-var">textSpanCharWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Int) -&gt; Int64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">DisplayText -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="annot"><span class="annottext">DisplayText
</span><a href="#local-6989586621679367517"><span class="hs-identifier hs-var">postTxt</span></a></span><span>
</span><span id="line-74"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">textSpanText :: DisplayText
</span><a href="Graphics.Vty.Span.html#textSpanText"><span class="hs-identifier hs-var">textSpanText</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayText
</span><a href="#local-6989586621679367517"><span class="hs-identifier hs-var">postTxt</span></a></span><span>
</span><span id="line-75"></span><span>                                            </span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; SpanOps
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.singleton</span></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367521"><span class="hs-identifier hs-var">preOp</span></a></span><span>
</span><span id="line-77"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; SpanOps -&gt; SpanOps
forall a. a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.cons</span></span><span> </span><span class="annot"><span class="annottext">SpanOp
</span><a href="#local-6989586621679367516"><span class="hs-identifier hs-var">postOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOps -&gt; SpanOps
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.tail</span></span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367529"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>            </span><span class="annot"><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-type">Skip</span></a></span><span> </span><span id="local-6989586621679367514"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367514"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367514"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-80"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679367513"><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367513"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679367512"><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367512"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpanOps -&gt; (SpanOps, SpanOps)
</span><a href="#local-6989586621679367533"><span class="hs-identifier hs-var">splitOpsAt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367514"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOps -&gt; SpanOps
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.tail</span></span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367529"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOp -&gt; SpanOps -&gt; SpanOps
forall a. a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.cons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SpanOp
</span><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367514"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367513"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367512"><span class="hs-identifier hs-var">post</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; SpanOps
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.singleton</span></span><span> </span><span class="annot"><span class="annottext">(SpanOp -&gt; SpanOps) -&gt; SpanOp -&gt; SpanOps
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpanOp
</span><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span>
</span><span id="line-83"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpanOp -&gt; SpanOps -&gt; SpanOps
forall a. a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.cons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SpanOp
</span><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367514"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367530"><span class="hs-identifier hs-var">remainingColumns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpanOps -&gt; SpanOps
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.tail</span></span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367529"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>            </span><span class="annot"><a href="Graphics.Vty.Span.html#RowEnd"><span class="hs-identifier hs-type">RowEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (SpanOps, SpanOps)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cannot split ops containing a row end&quot;</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | A vector of span operation vectors for display, one per row of the</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- output region.</span><span>
</span><span id="line-89"></span><span class="hs-keyword">type</span><span> </span><span id="DisplayOps"><span class="annot"><a href="Graphics.Vty.Span.html#DisplayOps"><span class="hs-identifier hs-var">DisplayOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOps"><span class="hs-identifier hs-type">SpanOps</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679367506"><span id="local-6989586621679367509"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOp"><span class="hs-identifier hs-type">SpanOp</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621679367504"><span class="annot"><span class="annottext">show :: SpanOp -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#TextSpan"><span class="hs-identifier hs-type">TextSpan</span></a></span><span> </span><span id="local-6989586621679367502"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679367502"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679367501"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367501"><span class="hs-identifier hs-var">ow</span></a></span></span><span> </span><span id="local-6989586621679367500"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367500"><span class="hs-identifier hs-var">cw</span></a></span></span><span> </span><span class="annot"><span class="annottext">DisplayText
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;TextSpan(&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679367502"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)(&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367501"><span class="hs-identifier hs-var">ow</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367500"><span class="hs-identifier hs-var">cw</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-type">Skip</span></a></span><span> </span><span id="local-6989586621679367499"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367499"><span class="hs-identifier hs-var">ow</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Skip(&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367499"><span class="hs-identifier hs-var">ow</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#RowEnd"><span class="hs-identifier hs-type">RowEnd</span></a></span><span> </span><span id="local-6989586621679367498"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367498"><span class="hs-identifier hs-var">ow</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;RowEnd(&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367498"><span class="hs-identifier hs-var">ow</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | The number of columns the DisplayOps are defined for.</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- All spans are verified to define same number of columns.</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Graphics.Vty.Span.html#displayOpsColumns"><span class="hs-identifier hs-type">displayOpsColumns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#DisplayOps"><span class="hs-identifier hs-type">DisplayOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-100"></span><span id="displayOpsColumns"><span class="annot"><span class="annottext">displayOpsColumns :: DisplayOps -&gt; Int
</span><a href="Graphics.Vty.Span.html#displayOpsColumns"><span class="hs-identifier hs-var hs-var">displayOpsColumns</span></a></span></span><span> </span><span id="local-6989586621679367496"><span class="annot"><span class="annottext">DisplayOps
</span><a href="#local-6989586621679367496"><span class="hs-identifier hs-var">ops</span></a></span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DisplayOps -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">Vector.length</span></span><span> </span><span class="annot"><span class="annottext">DisplayOps
</span><a href="#local-6989586621679367496"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpanOps -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">Vector.length</span></span><span> </span><span class="annot"><span class="annottext">(SpanOps -&gt; Int) -&gt; SpanOps -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DisplayOps -&gt; SpanOps
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">Vector.head</span></span><span> </span><span class="annot"><span class="annottext">DisplayOps
</span><a href="#local-6989586621679367496"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | The number of rows the DisplayOps are defined for.</span><span>
</span><span id="line-105"></span><span class="annot"><a href="Graphics.Vty.Span.html#displayOpsRows"><span class="hs-identifier hs-type">displayOpsRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#DisplayOps"><span class="hs-identifier hs-type">DisplayOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-106"></span><span id="displayOpsRows"><span class="annot"><span class="annottext">displayOpsRows :: DisplayOps -&gt; Int
</span><a href="Graphics.Vty.Span.html#displayOpsRows"><span class="hs-identifier hs-var hs-var">displayOpsRows</span></a></span></span><span> </span><span id="local-6989586621679367493"><span class="annot"><span class="annottext">DisplayOps
</span><a href="#local-6989586621679367493"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayOps -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">Vector.length</span></span><span> </span><span class="annot"><span class="annottext">DisplayOps
</span><a href="#local-6989586621679367493"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Graphics.Vty.Span.html#affectedRegion"><span class="hs-identifier hs-type">affectedRegion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#DisplayOps"><span class="hs-identifier hs-type">DisplayOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Vty.Image.html#DisplayRegion"><span class="hs-identifier hs-type">DisplayRegion</span></a></span><span>
</span><span id="line-109"></span><span id="affectedRegion"><span class="annot"><span class="annottext">affectedRegion :: DisplayOps -&gt; DisplayRegion
</span><a href="Graphics.Vty.Span.html#affectedRegion"><span class="hs-identifier hs-var hs-var">affectedRegion</span></a></span></span><span> </span><span id="local-6989586621679367491"><span class="annot"><span class="annottext">DisplayOps
</span><a href="#local-6989586621679367491"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DisplayOps -&gt; Int
</span><a href="Graphics.Vty.Span.html#displayOpsColumns"><span class="hs-identifier hs-var">displayOpsColumns</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayOps
</span><a href="#local-6989586621679367491"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DisplayOps -&gt; Int
</span><a href="Graphics.Vty.Span.html#displayOpsRows"><span class="hs-identifier hs-var">displayOpsRows</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayOps
</span><a href="#local-6989586621679367491"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | The number of columns a SpanOps affects.</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Graphics.Vty.Span.html#spanOpsAffectedColumns"><span class="hs-identifier hs-type">spanOpsAffectedColumns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOps"><span class="hs-identifier hs-type">SpanOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-113"></span><span id="spanOpsAffectedColumns"><span class="annot"><span class="annottext">spanOpsAffectedColumns :: SpanOps -&gt; Int
</span><a href="Graphics.Vty.Span.html#spanOpsAffectedColumns"><span class="hs-identifier hs-var hs-var">spanOpsAffectedColumns</span></a></span></span><span> </span><span id="local-6989586621679367489"><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367489"><span class="hs-identifier hs-var">inOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; SpanOp -&gt; Int) -&gt; Int -&gt; SpanOps -&gt; Int
forall a b. (a -&gt; b -&gt; a) -&gt; a -&gt; Vector b -&gt; a
</span><span class="hs-identifier hs-var">Vector.foldl'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SpanOp -&gt; Int
</span><a href="#local-6989586621679367487"><span class="hs-identifier hs-var">spanOpsAffectedColumns'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SpanOps
</span><a href="#local-6989586621679367489"><span class="hs-identifier hs-var">inOps</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>        </span><span id="local-6989586621679367487"><span class="annot"><span class="annottext">spanOpsAffectedColumns' :: Int -&gt; SpanOp -&gt; Int
</span><a href="#local-6989586621679367487"><span class="hs-identifier hs-var hs-var">spanOpsAffectedColumns'</span></a></span></span><span> </span><span id="local-6989586621679367486"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367486"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#TextSpan"><span class="hs-identifier hs-type">TextSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679367485"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367485"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DisplayText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367486"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367485"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="#local-6989586621679367487"><span class="hs-identifier hs-var">spanOpsAffectedColumns'</span></a></span><span> </span><span id="local-6989586621679367483"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367483"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-type">Skip</span></a></span><span> </span><span id="local-6989586621679367482"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367482"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367483"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367482"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><a href="#local-6989586621679367487"><span class="hs-identifier hs-var">spanOpsAffectedColumns'</span></a></span><span> </span><span id="local-6989586621679367481"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367481"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#RowEnd"><span class="hs-identifier hs-type">RowEnd</span></a></span><span> </span><span id="local-6989586621679367480"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367480"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367481"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367480"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | The width of a single SpanOp in columns.</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Graphics.Vty.Span.html#spanOpHasWidth"><span class="hs-identifier hs-type">spanOpHasWidth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOp"><span class="hs-identifier hs-type">SpanOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span id="spanOpHasWidth"><span class="annot"><span class="annottext">spanOpHasWidth :: SpanOp -&gt; Maybe DisplayRegion
</span><a href="Graphics.Vty.Span.html#spanOpHasWidth"><span class="hs-identifier hs-var hs-var">spanOpHasWidth</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#TextSpan"><span class="hs-identifier hs-type">TextSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679367478"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367478"><span class="hs-identifier hs-var">ow</span></a></span></span><span> </span><span id="local-6989586621679367477"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367477"><span class="hs-identifier hs-var">cw</span></a></span></span><span> </span><span class="annot"><span class="annottext">DisplayText
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayRegion -&gt; Maybe DisplayRegion
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367477"><span class="hs-identifier hs-var">cw</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367478"><span class="hs-identifier hs-var">ow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Graphics.Vty.Span.html#spanOpHasWidth"><span class="hs-identifier hs-var">spanOpHasWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-type">Skip</span></a></span><span> </span><span id="local-6989586621679367476"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367476"><span class="hs-identifier hs-var">ow</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayRegion -&gt; Maybe DisplayRegion
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367476"><span class="hs-identifier hs-var">ow</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367476"><span class="hs-identifier hs-var">ow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="annot"><a href="Graphics.Vty.Span.html#spanOpHasWidth"><span class="hs-identifier hs-var">spanOpHasWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#RowEnd"><span class="hs-identifier hs-type">RowEnd</span></a></span><span> </span><span id="local-6989586621679367475"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367475"><span class="hs-identifier hs-var">ow</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayRegion -&gt; Maybe DisplayRegion
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367475"><span class="hs-identifier hs-var">ow</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367475"><span class="hs-identifier hs-var">ow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | The number of columns to the character at the given position in the</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- span op.</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Graphics.Vty.Span.html#columnsToCharOffset"><span class="hs-identifier hs-type">columnsToCharOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Vty.Span.html#SpanOp"><span class="hs-identifier hs-type">SpanOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-128"></span><span id="columnsToCharOffset"><span class="annot"><span class="annottext">columnsToCharOffset :: Int -&gt; SpanOp -&gt; Int
</span><a href="Graphics.Vty.Span.html#columnsToCharOffset"><span class="hs-identifier hs-var hs-var">columnsToCharOffset</span></a></span></span><span> </span><span id="local-6989586621679367473"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367473"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#TextSpan"><span class="hs-identifier hs-type">TextSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679367472"><span class="annot"><span class="annottext">DisplayText
</span><a href="#local-6989586621679367472"><span class="hs-identifier hs-var">utf8Str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">DisplayText -&gt; Int
</span><a href="Graphics.Text.Width.html#wctlwidth"><span class="hs-identifier hs-var">wctlwidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; DisplayText -&gt; DisplayText
</span><span class="hs-identifier hs-var">TL.take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367473"><span class="hs-identifier hs-var">cx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DisplayText
</span><a href="#local-6989586621679367472"><span class="hs-identifier hs-var">utf8Str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="annot"><a href="Graphics.Vty.Span.html#columnsToCharOffset"><span class="hs-identifier hs-var">columnsToCharOffset</span></a></span><span> </span><span id="local-6989586621679367469"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367469"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#Skip"><span class="hs-identifier hs-type">Skip</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367469"><span class="hs-identifier hs-var">cx</span></a></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Graphics.Vty.Span.html#columnsToCharOffset"><span class="hs-identifier hs-var">columnsToCharOffset</span></a></span><span> </span><span id="local-6989586621679367468"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367468"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Span.html#RowEnd"><span class="hs-identifier hs-type">RowEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679367468"><span class="hs-identifier hs-var">cx</span></a></span><span>
</span><span id="line-132"></span></pre></body></html>