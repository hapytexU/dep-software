<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Vty provides interfaces for both terminal input and terminal</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- output.</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- - Input to the terminal is provided to the Vty application as a</span><span>
</span><span id="line-7"></span><span class="hs-comment">--   sequence of 'Event's.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- - Output is provided to Vty by the application in the form of a</span><span>
</span><span id="line-10"></span><span class="hs-comment">--   'Picture'. A 'Picture' is one or more layers of 'Image's.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--   'Image' values can be built by the various constructors in</span><span>
</span><span id="line-12"></span><span class="hs-comment">--   &quot;Graphics.Vty.Image&quot;. Output can be syled using 'Attr' (attribute)</span><span>
</span><span id="line-13"></span><span class="hs-comment">--   values in the &quot;Graphics.Vty.Attributes&quot; module.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Vty uses threads internally, so programs made with Vty need to be</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- compiled with the threaded runtime using the GHC @-threaded@ option.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-19"></span><span class="hs-comment">--  import &quot;Graphics.Vty&quot;</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">--  main = do</span><span>
</span><span id="line-22"></span><span class="hs-comment">--      cfg &lt;- 'standardIOConfig'</span><span>
</span><span id="line-23"></span><span class="hs-comment">--      vty &lt;- 'mkVty' cfg</span><span>
</span><span id="line-24"></span><span class="hs-comment">--      let line0 = 'string' ('defAttr' ` 'withForeColor' ` 'green') \&quot;first line\&quot;</span><span>
</span><span id="line-25"></span><span class="hs-comment">--          line1 = 'string' ('defAttr' ` 'withBackColor' ` 'blue') \&quot;second line\&quot;</span><span>
</span><span id="line-26"></span><span class="hs-comment">--          img = line0 '&lt;-&gt;' line1</span><span>
</span><span id="line-27"></span><span class="hs-comment">--          pic = 'picForImage' img</span><span>
</span><span id="line-28"></span><span class="hs-comment">--      'update' vty pic</span><span>
</span><span id="line-29"></span><span class="hs-comment">--      e &lt;- 'nextEvent' vty</span><span>
</span><span id="line-30"></span><span class="hs-comment">--      'shutdown' vty</span><span>
</span><span id="line-31"></span><span class="hs-comment">--      'print' (\&quot;Last event was: \&quot; '++' 'show' e)</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-33"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Graphics.Vty</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Graphics.Vty.html#Vty"><span class="hs-identifier">Vty</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Graphics.Vty.html#mkVty"><span class="hs-identifier">mkVty</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Graphics.Vty.html#setWindowTitle"><span class="hs-identifier">setWindowTitle</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Graphics.Vty.Output.Interface.html#Mode"><span class="hs-identifier">Mode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Graphics.Vty.Config.html"><span class="hs-identifier">Graphics.Vty.Config</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Graphics.Vty.Input.html"><span class="hs-identifier">Graphics.Vty.Input</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Graphics.Vty.Output.html"><span class="hs-identifier">Graphics.Vty.Output</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Graphics.Vty.Output.Interface.html"><span class="hs-identifier">Graphics.Vty.Output.Interface</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Graphics.Vty.Picture.html"><span class="hs-identifier">Graphics.Vty.Picture</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Graphics.Vty.Image.html"><span class="hs-identifier">Graphics.Vty.Image</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Graphics.Vty.Attributes.html"><span class="hs-identifier">Graphics.Vty.Attributes</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Config.html"><span class="hs-identifier">Graphics.Vty.Config</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Input.html"><span class="hs-identifier">Graphics.Vty.Input</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Output.html"><span class="hs-identifier">Graphics.Vty.Output</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Output.Interface.html"><span class="hs-identifier">Graphics.Vty.Output.Interface</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Picture.html"><span class="hs-identifier">Graphics.Vty.Picture</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Image.html"><span class="hs-identifier">Graphics.Vty.Image</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.Attributes.html"><span class="hs-identifier">Graphics.Vty.Attributes</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.UnicodeWidthTable.IO.html"><span class="hs-identifier">Graphics.Vty.UnicodeWidthTable.IO</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Graphics.Vty.UnicodeWidthTable.Install.html"><span class="hs-identifier">Graphics.Vty.UnicodeWidthTable.Install</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isPrint</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showLitChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS8</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.STM</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span class="hs-cpp">
#if !(MIN_VERSION_base(4,11,0))
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | A Vty value represents a handle to the Vty library that the</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- application must create in order to use Vty.</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- The use of Vty typically follows this process:</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">--    1. Initialize vty with 'mkVty' (this takes control of the terminal).</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">--    2. Use 'update' to display a picture.</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">--    3. Use 'nextEvent' to get the next input event.</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">--    4. Depending on the event, go to 2 or 5.</span><span>
</span><span id="line-82"></span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span class="hs-comment">--    5. Shutdown vty and restore the terminal state with 'shutdown'. At</span><span>
</span><span id="line-84"></span><span class="hs-comment">--    this point the 'Vty' handle cannot be used again.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- Operations on Vty handles are not thread-safe.</span><span>
</span><span id="line-87"></span><span class="hs-keyword">data</span><span> </span><span id="Vty"><span class="annot"><a href="Graphics.Vty.html#Vty"><span class="hs-identifier hs-var">Vty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-88"></span><span>    </span><span id="Vty"><span class="annot"><a href="Graphics.Vty.html#Vty"><span class="hs-identifier hs-var">Vty</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="update"><span class="annot"><span class="annottext">Vty -&gt; Picture -&gt; IO ()
</span><a href="Graphics.Vty.html#update"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Picture.html#Picture"><span class="hs-identifier hs-type">Picture</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-comment">-- ^ Outputs the given 'Picture'.</span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="nextEvent"><span class="annot"><span class="annottext">Vty -&gt; IO Event
</span><a href="Graphics.Vty.html#nextEvent"><span class="hs-identifier hs-var hs-var">nextEvent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Graphics.Vty.Input.Events.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-comment">-- ^ Return the next 'Event' or block until one becomes</span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-comment">-- available.</span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="nextEventNonblocking"><span class="annot"><span class="annottext">Vty -&gt; IO (Maybe Event)
</span><a href="Graphics.Vty.html#nextEventNonblocking"><span class="hs-identifier hs-var hs-var">nextEventNonblocking</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Graphics.Vty.Input.Events.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-comment">-- ^ Non-blocking version of 'nextEvent'.</span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="inputIface"><span class="annot"><span class="annottext">Vty -&gt; Input
</span><a href="Graphics.Vty.html#inputIface"><span class="hs-identifier hs-var hs-var">inputIface</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Input.Loop.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-comment">-- ^ The input interface. See 'Input'.</span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="outputIface"><span class="annot"><span class="annottext">Vty -&gt; Output
</span><a href="Graphics.Vty.html#outputIface"><span class="hs-identifier hs-var hs-var">outputIface</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Output.Interface.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-comment">-- ^ The output interface. See 'Output'.</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="refresh"><span class="annot"><span class="annottext">Vty -&gt; IO ()
</span><a href="Graphics.Vty.html#refresh"><span class="hs-identifier hs-var hs-var">refresh</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>        </span><span class="hs-comment">-- ^ Refresh the display. If other programs output to the</span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-comment">-- terminal and mess up the display then the application might</span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-comment">-- want to force a refresh using this function.</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="shutdown"><span class="annot"><span class="annottext">Vty -&gt; IO ()
</span><a href="Graphics.Vty.html#shutdown"><span class="hs-identifier hs-var hs-var">shutdown</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-comment">-- ^ Clean up after vty. A call to this function is necessary to</span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-comment">-- cleanly restore the terminal state before application exit.</span><span>
</span><span id="line-106"></span><span>        </span><span class="hs-comment">-- The above methods will throw an exception if executed after</span><span>
</span><span id="line-107"></span><span>        </span><span class="hs-comment">-- this is executed. Idempotent.</span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="isShutdown"><span class="annot"><span class="annottext">Vty -&gt; IO Bool
</span><a href="Graphics.Vty.html#isShutdown"><span class="hs-identifier hs-var hs-var">isShutdown</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Create a Vty handle. At most one handle should be created at a time</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- for a given terminal device.</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- The specified configuration is added to the the configuration</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- loaded by 'userConfig' with the 'userConfig' configuration taking</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- precedence. See &quot;Graphics.Vty.Config&quot;.</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- For most applications @mkVty defaultConfig@ is sufficient.</span><span>
</span><span id="line-119"></span><span class="annot"><a href="Graphics.Vty.html#mkVty"><span class="hs-identifier hs-type">mkVty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Graphics.Vty.html#Vty"><span class="hs-identifier hs-type">Vty</span></a></span><span>
</span><span id="line-120"></span><span id="mkVty"><span class="annot"><span class="annottext">mkVty :: Config -&gt; IO Vty
</span><a href="Graphics.Vty.html#mkVty"><span class="hs-identifier hs-var hs-var">mkVty</span></a></span></span><span> </span><span id="local-6989586621679369663"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369663"><span class="hs-identifier hs-var">appConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679369662"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369662"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; Config -&gt; Config
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369663"><span class="hs-identifier hs-var">appConfig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Config -&gt; Config) -&gt; IO Config -&gt; IO Config
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO Config
</span><a href="Graphics.Vty.Config.html#userConfig"><span class="hs-identifier hs-var">userConfig</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; Maybe Bool
</span><a href="Graphics.Vty.Config.html#allowCustomUnicodeWidthTables"><span class="hs-identifier hs-var hs-var">allowCustomUnicodeWidthTables</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369662"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">Config -&gt; IO ()
</span><a href="Graphics.Vty.html#installCustomWidthTable"><span class="hs-identifier hs-var">installCustomWidthTable</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369662"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679369656"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679369656"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Config -&gt; IO Input
</span><a href="Graphics.Vty.Input.html#inputForConfig"><span class="hs-identifier hs-var">inputForConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369662"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679369654"><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369654"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Config -&gt; IO Output
</span><a href="Graphics.Vty.Output.html#outputForConfig"><span class="hs-identifier hs-var">outputForConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369662"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">Input -&gt; Output -&gt; IO Vty
</span><a href="Graphics.Vty.html#internalMkVty"><span class="hs-identifier hs-var">internalMkVty</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679369656"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369654"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Graphics.Vty.html#installCustomWidthTable"><span class="hs-identifier hs-type">installCustomWidthTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span id="installCustomWidthTable"><span class="annot"><span class="annottext">installCustomWidthTable :: Config -&gt; IO ()
</span><a href="Graphics.Vty.html#installCustomWidthTable"><span class="hs-identifier hs-var hs-var">installCustomWidthTable</span></a></span></span><span> </span><span id="local-6989586621679369651"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369651"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369650"><span class="annot"><span class="annottext">doLog :: [Char] -&gt; IO ()
</span><a href="#local-6989586621679369650"><span class="hs-identifier hs-var hs-var">doLog</span></a></span></span><span> </span><span id="local-6989586621679369649"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369649"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Maybe [Char]
</span><a href="Graphics.Vty.Config.html#debugLog"><span class="hs-identifier hs-var hs-var">debugLog</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369651"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-133"></span><span>            </span><span class="annot"><span class="annottext">Maybe [Char]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679369647"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369647"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">appendFile</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369647"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;installWidthTable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369649"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679369645"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679369645"><span class="hs-identifier hs-var">customInstalled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="Graphics.Vty.UnicodeWidthTable.Install.html#isCustomTableReady"><span class="hs-identifier hs-var">isCustomTableReady</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679369645"><span class="hs-identifier hs-var">customInstalled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>        </span><span id="local-6989586621679369642"><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621679369642"><span class="hs-identifier hs-var">mTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe [Char])
</span><a href="Graphics.Vty.Config.html#currentTerminalName"><span class="hs-identifier hs-var">currentTerminalName</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621679369642"><span class="hs-identifier hs-var">mTerm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-140"></span><span>            </span><span class="annot"><span class="annottext">Maybe [Char]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="#local-6989586621679369650"><span class="hs-identifier hs-var">doLog</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No current terminal name available&quot;</span></span><span>
</span><span id="line-142"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679369640"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369640"><span class="hs-identifier hs-var">currentTerm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [([Char], [Char])] -&gt; Maybe [Char]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369640"><span class="hs-identifier hs-var">currentTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; [([Char], [Char])]
</span><a href="Graphics.Vty.Config.html#termWidthMaps"><span class="hs-identifier hs-var hs-var">termWidthMaps</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679369651"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>                    </span><span class="annot"><span class="annottext">Maybe [Char]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>                        </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="#local-6989586621679369650"><span class="hs-identifier hs-var">doLog</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Current terminal not found in custom character width mapping list&quot;</span></span><span>
</span><span id="line-146"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679369637"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369637"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>                        </span><span id="local-6989586621679369636"><span class="annot"><span class="annottext">Either SomeException (Either [Char] UnicodeWidthTable)
</span><a href="#local-6989586621679369636"><span class="hs-identifier hs-var">tableResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either [Char] UnicodeWidthTable)
-&gt; IO (Either SomeException (Either [Char] UnicodeWidthTable))
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">E.try</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either [Char] UnicodeWidthTable)
 -&gt; IO (Either SomeException (Either [Char] UnicodeWidthTable)))
-&gt; IO (Either [Char] UnicodeWidthTable)
-&gt; IO (Either SomeException (Either [Char] UnicodeWidthTable))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either [Char] UnicodeWidthTable)
</span><a href="Graphics.Vty.UnicodeWidthTable.IO.html#readUnicodeWidthTable"><span class="hs-identifier hs-var">readUnicodeWidthTable</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369637"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-148"></span><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either SomeException (Either [Char] UnicodeWidthTable)
</span><a href="#local-6989586621679369636"><span class="hs-identifier hs-var">tableResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679369633"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679369633"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">E.SomeException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>                                </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="#local-6989586621679369650"><span class="hs-identifier hs-var">doLog</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Error reading custom character width table &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-151"></span><span>                                        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;at &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369637"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679369633"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-152"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679369631"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369631"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>                                </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="#local-6989586621679369650"><span class="hs-identifier hs-var">doLog</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Error reading custom character width table &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-154"></span><span>                                        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;at &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369637"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369631"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-155"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679369630"><span class="annot"><span class="annottext">UnicodeWidthTable
</span><a href="#local-6989586621679369630"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>                                </span><span id="local-6989586621679369629"><span class="annot"><span class="annottext">Either SomeException ()
</span><a href="#local-6989586621679369629"><span class="hs-identifier hs-var">installResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Either SomeException ())
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">E.try</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO (Either SomeException ()))
-&gt; IO () -&gt; IO (Either SomeException ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnicodeWidthTable -&gt; IO ()
</span><a href="Graphics.Vty.UnicodeWidthTable.Install.html#installUnicodeWidthTable"><span class="hs-identifier hs-var">installUnicodeWidthTable</span></a></span><span> </span><span class="annot"><span class="annottext">UnicodeWidthTable
</span><a href="#local-6989586621679369630"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-157"></span><span>                                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either SomeException ()
</span><a href="#local-6989586621679369629"><span class="hs-identifier hs-var">installResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>                                    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679369627"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679369627"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">E.SomeException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>                                        </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="#local-6989586621679369650"><span class="hs-identifier hs-var">doLog</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Error installing unicode table (&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-160"></span><span>                                                </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369637"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679369627"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-161"></span><span>                                    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>                                        </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="#local-6989586621679369650"><span class="hs-identifier hs-var">doLog</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Successfully installed Unicode width table &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-163"></span><span>                                                </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; from &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369637"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Graphics.Vty.html#internalMkVty"><span class="hs-identifier hs-type">internalMkVty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.Input.Loop.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Graphics.Vty.Output.Interface.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Graphics.Vty.html#Vty"><span class="hs-identifier hs-type">Vty</span></a></span><span>
</span><span id="line-166"></span><span id="internalMkVty"><span class="annot"><span class="annottext">internalMkVty :: Input -&gt; Output -&gt; IO Vty
</span><a href="Graphics.Vty.html#internalMkVty"><span class="hs-identifier hs-var hs-var">internalMkVty</span></a></span></span><span> </span><span id="local-6989586621679369626"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679369626"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span id="local-6989586621679369625"><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">Output -&gt; IO ()
</span><a href="Graphics.Vty.Output.Interface.html#reserveDisplay"><span class="hs-identifier hs-var hs-var">reserveDisplay</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679369623"><span class="annot"><span class="annottext">TVar Bool
</span><a href="#local-6989586621679369623"><span class="hs-identifier hs-var">shutdownVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM (TVar Bool) -&gt; IO (TVar Bool)
forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">(STM (TVar Bool) -&gt; IO (TVar Bool))
-&gt; STM (TVar Bool) -&gt; IO (TVar Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; STM (TVar Bool)
forall a. a -&gt; STM (TVar a)
</span><span class="hs-identifier hs-var">newTVar</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369620"><span class="annot"><span class="annottext">shutdownIo :: IO ()
</span><a href="#local-6989586621679369620"><span class="hs-identifier hs-var hs-var">shutdownIo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>            </span><span id="local-6989586621679369619"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679369619"><span class="hs-identifier hs-var">alreadyShutdown</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM Bool -&gt; IO Bool
forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">(STM Bool -&gt; IO Bool) -&gt; STM Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TVar Bool -&gt; Bool -&gt; STM Bool
forall a. TVar a -&gt; a -&gt; STM a
</span><span class="hs-identifier hs-var">swapTVar</span></span><span> </span><span class="annot"><span class="annottext">TVar Bool
</span><a href="#local-6989586621679369623"><span class="hs-identifier hs-var">shutdownVar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679369619"><span class="hs-identifier hs-var">alreadyShutdown</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>                </span><span class="annot"><span class="annottext">Input -&gt; IO ()
</span><a href="Graphics.Vty.Input.Loop.html#shutdownInput"><span class="hs-identifier hs-var hs-var">shutdownInput</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679369626"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-174"></span><span>                </span><span class="annot"><span class="annottext">Output -&gt; IO ()
</span><a href="Graphics.Vty.Output.Interface.html#releaseDisplay"><span class="hs-identifier hs-var hs-var">releaseDisplay</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-175"></span><span>                </span><span class="annot"><span class="annottext">Output -&gt; IO ()
</span><a href="Graphics.Vty.Output.Interface.html#releaseTerminal"><span class="hs-identifier hs-var hs-var">releaseTerminal</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369614"><span class="annot"><span class="annottext">shutdownStatus :: IO Bool
</span><a href="#local-6989586621679369614"><span class="hs-identifier hs-var hs-var">shutdownStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STM Bool -&gt; IO Bool
forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">(STM Bool -&gt; IO Bool) -&gt; STM Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TVar Bool -&gt; STM Bool
forall a. TVar a -&gt; STM a
</span><span class="hs-identifier hs-var">readTVar</span></span><span> </span><span class="annot"><span class="annottext">TVar Bool
</span><a href="#local-6989586621679369623"><span class="hs-identifier hs-var">shutdownVar</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679369612"><span class="annot"><span class="annottext">IORef (Maybe Picture)
</span><a href="#local-6989586621679369612"><span class="hs-identifier hs-var">lastPicRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Picture -&gt; IO (IORef (Maybe Picture))
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="annot"><span class="annottext">Maybe Picture
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679369610"><span class="annot"><span class="annottext">IORef (Maybe (DisplayRegion, DisplayContext))
</span><a href="#local-6989586621679369610"><span class="hs-identifier hs-var">lastUpdateRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (DisplayRegion, DisplayContext)
-&gt; IO (IORef (Maybe (DisplayRegion, DisplayContext)))
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="annot"><span class="annottext">Maybe (DisplayRegion, DisplayContext)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369609"><span class="annot"><span class="annottext">innerUpdate :: Picture -&gt; IO ()
</span><a href="#local-6989586621679369609"><span class="hs-identifier hs-var hs-var">innerUpdate</span></a></span></span><span> </span><span id="local-6989586621679369608"><span class="annot"><span class="annottext">Picture
</span><a href="#local-6989586621679369608"><span class="hs-identifier hs-var">inPic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>            </span><span id="local-6989586621679369607"><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369607"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Output -&gt; IO DisplayRegion
</span><a href="Graphics.Vty.Output.Interface.html#displayBounds"><span class="hs-identifier hs-var hs-var">displayBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-184"></span><span>            </span><span id="local-6989586621679369605"><span class="annot"><span class="annottext">Maybe (DisplayRegion, DisplayContext)
</span><a href="#local-6989586621679369605"><span class="hs-identifier hs-var">mlastUpdate</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (DisplayRegion, DisplayContext))
-&gt; IO (Maybe (DisplayRegion, DisplayContext))
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (DisplayRegion, DisplayContext))
</span><a href="#local-6989586621679369610"><span class="hs-identifier hs-var">lastUpdateRef</span></a></span><span>
</span><span id="line-185"></span><span>            </span><span id="local-6989586621679369603"><span class="annot"><span class="annottext">(DisplayRegion, DisplayContext)
</span><a href="#local-6989586621679369603"><span class="hs-identifier hs-var">updateData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (DisplayRegion, DisplayContext)
</span><a href="#local-6989586621679369605"><span class="hs-identifier hs-var">mlastUpdate</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>                </span><span class="annot"><span class="annottext">Maybe (DisplayRegion, DisplayContext)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-187"></span><span>                    </span><span id="local-6989586621679369602"><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369602"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Output -&gt; DisplayRegion -&gt; IO DisplayContext
</span><a href="Graphics.Vty.Output.Interface.html#displayContext"><span class="hs-identifier hs-var">displayContext</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369607"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-188"></span><span>                    </span><span class="annot"><span class="annottext">DisplayContext -&gt; Picture -&gt; IO ()
</span><a href="Graphics.Vty.Output.Interface.html#outputPicture"><span class="hs-identifier hs-var">outputPicture</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369602"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">Picture
</span><a href="#local-6989586621679369608"><span class="hs-identifier hs-var">inPic</span></a></span><span>
</span><span id="line-189"></span><span>                    </span><span class="annot"><span class="annottext">(DisplayRegion, DisplayContext)
-&gt; IO (DisplayRegion, DisplayContext)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369607"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369602"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679369599"><span class="annot"><a href="#local-6989586621679369599"><span class="hs-identifier hs-var">lastBounds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369598"><span class="annot"><a href="#local-6989586621679369598"><span class="hs-identifier hs-var">lastContext</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369607"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayRegion -&gt; DisplayRegion -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369599"><span class="hs-identifier hs-var">lastBounds</span></a></span><span>
</span><span id="line-192"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>                            </span><span id="local-6989586621679369597"><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369597"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Output -&gt; DisplayRegion -&gt; IO DisplayContext
</span><a href="Graphics.Vty.Output.Interface.html#displayContext"><span class="hs-identifier hs-var">displayContext</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369607"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-194"></span><span>                            </span><span class="annot"><span class="annottext">DisplayContext -&gt; Picture -&gt; IO ()
</span><a href="Graphics.Vty.Output.Interface.html#outputPicture"><span class="hs-identifier hs-var">outputPicture</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369597"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">Picture
</span><a href="#local-6989586621679369608"><span class="hs-identifier hs-var">inPic</span></a></span><span>
</span><span id="line-195"></span><span>                            </span><span class="annot"><span class="annottext">(DisplayRegion, DisplayContext)
-&gt; IO (DisplayRegion, DisplayContext)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369607"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369597"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-197"></span><span>                            </span><span class="annot"><span class="annottext">DisplayContext -&gt; Picture -&gt; IO ()
</span><a href="Graphics.Vty.Output.Interface.html#outputPicture"><span class="hs-identifier hs-var">outputPicture</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369598"><span class="hs-identifier hs-var">lastContext</span></a></span><span> </span><span class="annot"><span class="annottext">Picture
</span><a href="#local-6989586621679369608"><span class="hs-identifier hs-var">inPic</span></a></span><span>
</span><span id="line-198"></span><span>                            </span><span class="annot"><span class="annottext">(DisplayRegion, DisplayContext)
-&gt; IO (DisplayRegion, DisplayContext)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369607"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369598"><span class="hs-identifier hs-var">lastContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>            </span><span class="annot"><span class="annottext">IORef (Maybe (DisplayRegion, DisplayContext))
-&gt; Maybe (DisplayRegion, DisplayContext) -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">writeIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (DisplayRegion, DisplayContext))
</span><a href="#local-6989586621679369610"><span class="hs-identifier hs-var">lastUpdateRef</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (DisplayRegion, DisplayContext) -&gt; IO ())
-&gt; Maybe (DisplayRegion, DisplayContext) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DisplayRegion, DisplayContext)
-&gt; Maybe (DisplayRegion, DisplayContext)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(DisplayRegion, DisplayContext)
</span><a href="#local-6989586621679369603"><span class="hs-identifier hs-var">updateData</span></a></span><span>
</span><span id="line-200"></span><span>            </span><span class="annot"><span class="annottext">IORef (Maybe Picture) -&gt; Maybe Picture -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">writeIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe Picture)
</span><a href="#local-6989586621679369612"><span class="hs-identifier hs-var">lastPicRef</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Picture -&gt; IO ()) -&gt; Maybe Picture -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Picture -&gt; Maybe Picture
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Picture
</span><a href="#local-6989586621679369608"><span class="hs-identifier hs-var">inPic</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369595"><span class="annot"><span class="annottext">innerRefresh :: IO ()
</span><a href="#local-6989586621679369595"><span class="hs-identifier hs-var hs-var">innerRefresh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>            </span><span class="annot"><span class="annottext">IORef (Maybe (DisplayRegion, DisplayContext))
-&gt; Maybe (DisplayRegion, DisplayContext) -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">writeIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe (DisplayRegion, DisplayContext))
</span><a href="#local-6989586621679369610"><span class="hs-identifier hs-var">lastUpdateRef</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DisplayRegion, DisplayContext)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-204"></span><span>            </span><span id="local-6989586621679369594"><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369594"><span class="hs-identifier hs-var">bounds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Output -&gt; IO DisplayRegion
</span><a href="Graphics.Vty.Output.Interface.html#displayBounds"><span class="hs-identifier hs-var hs-var">displayBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-205"></span><span>            </span><span id="local-6989586621679369593"><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369593"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Output -&gt; DisplayRegion -&gt; IO DisplayContext
</span><a href="Graphics.Vty.Output.Interface.html#displayContext"><span class="hs-identifier hs-var">displayContext</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayRegion
</span><a href="#local-6989586621679369594"><span class="hs-identifier hs-var">bounds</span></a></span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><span class="annottext">IORef AssumedState -&gt; AssumedState -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">writeIORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Output -&gt; IORef AssumedState
</span><a href="Graphics.Vty.Output.Interface.html#assumedStateRef"><span class="hs-identifier hs-var hs-var">assumedStateRef</span></a></span><span> </span><span class="annot"><span class="annottext">(Output -&gt; IORef AssumedState) -&gt; Output -&gt; IORef AssumedState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DisplayContext -&gt; Output
</span><a href="Graphics.Vty.Output.Interface.html#contextDevice"><span class="hs-identifier hs-var hs-var">contextDevice</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayContext
</span><a href="#local-6989586621679369593"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AssumedState
</span><a href="Graphics.Vty.Output.Interface.html#initialAssumedState"><span class="hs-identifier hs-var">initialAssumedState</span></a></span><span>
</span><span id="line-207"></span><span>            </span><span id="local-6989586621679369589"><span class="annot"><span class="annottext">Maybe Picture
</span><a href="#local-6989586621679369589"><span class="hs-identifier hs-var">mPic</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef (Maybe Picture) -&gt; IO (Maybe Picture)
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe Picture)
</span><a href="#local-6989586621679369612"><span class="hs-identifier hs-var">lastPicRef</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; (Picture -&gt; IO ()) -&gt; Maybe Picture -&gt; IO ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Picture -&gt; IO ()
</span><a href="#local-6989586621679369609"><span class="hs-identifier hs-var">innerUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Picture
</span><a href="#local-6989586621679369589"><span class="hs-identifier hs-var">mPic</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369587"><span class="annot"><span class="annottext">mkResize :: IO Event
</span><a href="#local-6989586621679369587"><span class="hs-identifier hs-var hs-var">mkResize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Event) -&gt; DisplayRegion -&gt; Event
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Event
</span><a href="Graphics.Vty.Input.Events.html#EvResize"><span class="hs-identifier hs-var">EvResize</span></a></span><span> </span><span class="annot"><span class="annottext">(DisplayRegion -&gt; Event) -&gt; IO DisplayRegion -&gt; IO Event
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Output -&gt; IO DisplayRegion
</span><a href="Graphics.Vty.Output.Interface.html#displayBounds"><span class="hs-identifier hs-var hs-var">displayBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span id="local-6989586621679369584"><span class="annot"><span class="annottext">gkey :: IO Event
</span><a href="#local-6989586621679369584"><span class="hs-identifier hs-var hs-var">gkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>            </span><span id="local-6989586621679369583"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679369583"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM Event -&gt; IO Event
forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">(STM Event -&gt; IO Event) -&gt; STM Event -&gt; IO Event
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TChan Event -&gt; STM Event
forall a. TChan a -&gt; STM a
</span><span class="hs-identifier hs-var">readTChan</span></span><span> </span><span class="annot"><span class="annottext">(TChan Event -&gt; STM Event) -&gt; TChan Event -&gt; STM Event
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; TChan Event
</span><a href="Graphics.Vty.Input.Loop.html#_eventChannel"><span class="hs-identifier hs-var hs-var">_eventChannel</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679369626"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-213"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679369583"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Input.Events.html#EvResize"><span class="hs-identifier hs-type">EvResize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Event
</span><a href="#local-6989586621679369587"><span class="hs-identifier hs-var">mkResize</span></a></span><span>
</span><span id="line-215"></span><span>                </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; IO Event
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679369583"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span id="local-6989586621679369580"><span class="annot"><span class="annottext">gkey' :: IO (Maybe Event)
</span><a href="#local-6989586621679369580"><span class="hs-identifier hs-var hs-var">gkey'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-217"></span><span>            </span><span id="local-6989586621679369579"><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679369579"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM (Maybe Event) -&gt; IO (Maybe Event)
forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">(STM (Maybe Event) -&gt; IO (Maybe Event))
-&gt; STM (Maybe Event) -&gt; IO (Maybe Event)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TChan Event -&gt; STM (Maybe Event)
forall a. TChan a -&gt; STM (Maybe a)
</span><span class="hs-identifier hs-var">tryReadTChan</span></span><span> </span><span class="annot"><span class="annottext">(TChan Event -&gt; STM (Maybe Event))
-&gt; TChan Event -&gt; STM (Maybe Event)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Input -&gt; TChan Event
</span><a href="Graphics.Vty.Input.Loop.html#_eventChannel"><span class="hs-identifier hs-var hs-var">_eventChannel</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679369626"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-218"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679369579"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-219"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Graphics.Vty.Input.Events.html#EvResize"><span class="hs-identifier hs-type">EvResize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Maybe Event
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Event -&gt; Maybe Event) -&gt; IO Event -&gt; IO (Maybe Event)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO Event
</span><a href="#local-6989586621679369587"><span class="hs-identifier hs-var">mkResize</span></a></span><span>
</span><span id="line-220"></span><span>                </span><span class="annot"><span class="annottext">Maybe Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Event -&gt; IO (Maybe Event)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Event
</span><a href="#local-6989586621679369579"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">Vty -&gt; IO Vty
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Vty -&gt; IO Vty) -&gt; Vty -&gt; IO Vty
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vty :: (Picture -&gt; IO ())
-&gt; IO Event
-&gt; IO (Maybe Event)
-&gt; Input
-&gt; Output
-&gt; IO ()
-&gt; IO ()
-&gt; IO Bool
-&gt; Vty
</span><a href="Graphics.Vty.html#Vty"><span class="hs-identifier hs-type">Vty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">update :: Picture -&gt; IO ()
</span><a href="Graphics.Vty.html#update"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Picture -&gt; IO ()
</span><a href="#local-6989586621679369609"><span class="hs-identifier hs-var">innerUpdate</span></a></span><span>
</span><span id="line-223"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nextEvent :: IO Event
</span><a href="Graphics.Vty.html#nextEvent"><span class="hs-identifier hs-var">nextEvent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Event
</span><a href="#local-6989586621679369584"><span class="hs-identifier hs-var">gkey</span></a></span><span>
</span><span id="line-224"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nextEventNonblocking :: IO (Maybe Event)
</span><a href="Graphics.Vty.html#nextEventNonblocking"><span class="hs-identifier hs-var">nextEventNonblocking</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Event)
</span><a href="#local-6989586621679369580"><span class="hs-identifier hs-var">gkey'</span></a></span><span>
</span><span id="line-225"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">inputIface :: Input
</span><a href="Graphics.Vty.html#inputIface"><span class="hs-identifier hs-var">inputIface</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621679369626"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-226"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">outputIface :: Output
</span><a href="Graphics.Vty.html#outputIface"><span class="hs-identifier hs-var">outputIface</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Output
</span><a href="#local-6989586621679369625"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-227"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">refresh :: IO ()
</span><a href="Graphics.Vty.html#refresh"><span class="hs-identifier hs-var">refresh</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679369595"><span class="hs-identifier hs-var">innerRefresh</span></a></span><span>
</span><span id="line-228"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">shutdown :: IO ()
</span><a href="Graphics.Vty.html#shutdown"><span class="hs-identifier hs-var">shutdown</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679369620"><span class="hs-identifier hs-var">shutdownIo</span></a></span><span>
</span><span id="line-229"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isShutdown :: IO Bool
</span><a href="Graphics.Vty.html#isShutdown"><span class="hs-identifier hs-var">isShutdown</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="#local-6989586621679369614"><span class="hs-identifier hs-var">shutdownStatus</span></a></span><span>
</span><span id="line-230"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Set the terminal window title string.</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- This function emits an Xterm-compatible escape sequence that we</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- anticipate will work for essentially all modern terminal emulators.</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- Ideally we'd use a terminal capability for this, but there does not</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- seem to exist a termcap for setting window titles. If you find that</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- this function does not work for a given terminal emulator, please</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- report the issue.</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- For details, see:</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- https://tldp.org/HOWTO/Xterm-Title-3.html</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Graphics.Vty.html#setWindowTitle"><span class="hs-identifier hs-type">setWindowTitle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Graphics.Vty.html#Vty"><span class="hs-identifier hs-type">Vty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="setWindowTitle"><span class="annot"><span class="annottext">setWindowTitle :: Vty -&gt; [Char] -&gt; IO ()
</span><a href="Graphics.Vty.html#setWindowTitle"><span class="hs-identifier hs-var hs-var">setWindowTitle</span></a></span></span><span> </span><span id="local-6989586621679369576"><span class="annot"><span class="annottext">Vty
</span><a href="#local-6989586621679369576"><span class="hs-identifier hs-var">vty</span></a></span></span><span> </span><span id="local-6989586621679369575"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369575"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679369574"><span class="hs-identifier hs-type">sanitize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-247"></span><span>        </span><span id="local-6989586621679369574"><span class="annot"><span class="annottext">sanitize :: [Char] -&gt; [Char]
</span><a href="#local-6989586621679369574"><span class="hs-identifier hs-var hs-var">sanitize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char]
</span><a href="#local-6989586621679369572"><span class="hs-identifier hs-var">sanitizeChar</span></a></span><span>
</span><span id="line-248"></span><span>        </span><span id="local-6989586621679369572"><span class="annot"><span class="annottext">sanitizeChar :: Char -&gt; [Char]
</span><a href="#local-6989586621679369572"><span class="hs-identifier hs-var hs-var">sanitizeChar</span></a></span></span><span> </span><span id="local-6989586621679369571"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679369571"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPrint</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679369571"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">showLitChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679369571"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-249"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679369571"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369570"><span class="annot"><span class="annottext">buf :: ByteString
</span><a href="#local-6989586621679369570"><span class="hs-identifier hs-var hs-var">buf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS8.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ByteString) -&gt; [Char] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\ESC]2;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621679369574"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679369575"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\007&quot;</span></span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">Output -&gt; ByteString -&gt; IO ()
</span><a href="Graphics.Vty.Output.Interface.html#outputByteBuffer"><span class="hs-identifier hs-var hs-var">outputByteBuffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vty -&gt; Output
</span><a href="Graphics.Vty.html#outputIface"><span class="hs-identifier hs-var hs-var">outputIface</span></a></span><span> </span><span class="annot"><span class="annottext">Vty
</span><a href="#local-6989586621679369576"><span class="hs-identifier hs-var">vty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679369570"><span class="hs-identifier hs-var">buf</span></a></span><span>
</span><span id="line-252"></span></pre></body></html>