<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | This module provids a file browser widget that allows users to</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- navigate directory trees, search for files and directories, and</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- select entries of interest. For a complete working demonstration of</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- this module, see @programs/FileBrowserDemo.hs@.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- To use this module:</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- * Embed a 'FileBrowser' in your application state.</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- * Dispatch events to it in your event handler with</span><span>
</span><span id="line-15"></span><span class="hs-comment">--   'handleFileBrowserEvent'.</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- * Get the entry under the browser's cursor with 'fileBrowserCursor'</span><span>
</span><span id="line-17"></span><span class="hs-comment">--   and get the entries selected by the user with 'Enter' or 'Space'</span><span>
</span><span id="line-18"></span><span class="hs-comment">--   using 'fileBrowserSelection'.</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- * Inspect 'fileBrowserException' to determine whether the</span><span>
</span><span id="line-20"></span><span class="hs-comment">--   file browser encountered an error when reading a directory in</span><span>
</span><span id="line-21"></span><span class="hs-comment">--   'setWorkingDirectory' or when changing directories in the event</span><span>
</span><span id="line-22"></span><span class="hs-comment">--   handler.</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- File browsers have a built-in user-configurable function to limit the</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- entries displayed that defaults to showing all files. For example,</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- an application might want to limit the browser to just directories</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- and XML files. That is accomplished by setting the filter with</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- 'setFileBrowserEntryFilter' and some examples are provided in this</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- module: 'fileTypeMatch' and 'fileExtensionMatch'.</span><span>
</span><span id="line-30"></span><span class="hs-comment">--</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- File browsers are styled using the provided collection of attribute</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- names, so add those to your attribute map to get the appearance you</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- want. File browsers also make use of a 'List' internally, so the</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- 'List' attributes will affect how the list appears.</span><span>
</span><span id="line-35"></span><span class="hs-comment">--</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- File browsers catch 'IOException's when changing directories. If a</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- call to 'setWorkingDirectory' triggers an 'IOException' while reading</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- the working directory, the resulting 'IOException' is stored in the</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- file browser and is accessible with 'fileBrowserException'. The</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- 'setWorkingDirectory' function clears the exception field if the</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- working directory is read successfully. The caller is responsible for</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- deciding when and whether to display the exception to the user. In</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- the event that an 'IOException' is raised as described here, the file</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- browser will always present @..@ as a navigation option to allow the</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- user to continue navigating up the directory tree. It does this even</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- if the current or parent directory does not exist or cannot be read,</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- so it is always safe to present a file browser for any working</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- directory. Bear in mind that the @..@ entry is always subjected to</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- filtering and searching.</span><span>
</span><span id="line-50"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Brick.Widgets.FileBrowser</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier">FileBrowser</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier">FileInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileStatus"><span class="hs-identifier">FileStatus</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileType"><span class="hs-identifier">FileType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Making a new file browser</span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#newFileBrowser"><span class="hs-identifier">newFileBrowser</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#selectNonDirectories"><span class="hs-identifier">selectNonDirectories</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#selectDirectories"><span class="hs-identifier">selectDirectories</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Manipulating a file browser's state</span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#setWorkingDirectory"><span class="hs-identifier">setWorkingDirectory</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#getWorkingDirectory"><span class="hs-identifier">getWorkingDirectory</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier">updateFileBrowserSearch</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#setFileBrowserEntryFilter"><span class="hs-identifier">setFileBrowserEntryFilter</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Actions</span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserBeginSearch"><span class="hs-identifier">actionFileBrowserBeginSearch</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserSelectEnter"><span class="hs-identifier">actionFileBrowserSelectEnter</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserSelectCurrent"><span class="hs-identifier">actionFileBrowserSelectCurrent</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPageUp"><span class="hs-identifier">actionFileBrowserListPageUp</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPageDown"><span class="hs-identifier">actionFileBrowserListPageDown</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListHalfPageUp"><span class="hs-identifier">actionFileBrowserListHalfPageUp</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListHalfPageDown"><span class="hs-identifier">actionFileBrowserListHalfPageDown</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListTop"><span class="hs-identifier">actionFileBrowserListTop</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListBottom"><span class="hs-identifier">actionFileBrowserListBottom</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListNext"><span class="hs-identifier">actionFileBrowserListNext</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPrev"><span class="hs-identifier">actionFileBrowserListPrev</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Handling events</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEvent"><span class="hs-identifier">handleFileBrowserEvent</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#maybeSelectCurrentEntry"><span class="hs-identifier">maybeSelectCurrentEntry</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Rendering</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#renderFileBrowser"><span class="hs-identifier">renderFileBrowser</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Getting information</span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserCursor"><span class="hs-identifier">fileBrowserCursor</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserIsSearching"><span class="hs-identifier">fileBrowserIsSearching</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelection"><span class="hs-identifier">fileBrowserSelection</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserException"><span class="hs-identifier">fileBrowserException</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectable"><span class="hs-identifier">fileBrowserSelectable</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier">fileInfoFileType</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Attributes</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier">fileBrowserAttr</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserCurrentDirectoryAttr"><span class="hs-identifier">fileBrowserCurrentDirectoryAttr</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectionInfoAttr"><span class="hs-identifier">fileBrowserSelectionInfoAttr</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedAttr"><span class="hs-identifier">fileBrowserSelectedAttr</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserDirectoryAttr"><span class="hs-identifier">fileBrowserDirectoryAttr</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserBlockDeviceAttr"><span class="hs-identifier">fileBrowserBlockDeviceAttr</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserRegularFileAttr"><span class="hs-identifier">fileBrowserRegularFileAttr</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserCharacterDeviceAttr"><span class="hs-identifier">fileBrowserCharacterDeviceAttr</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserNamedPipeAttr"><span class="hs-identifier">fileBrowserNamedPipeAttr</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSymbolicLinkAttr"><span class="hs-identifier">fileBrowserSymbolicLinkAttr</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserUnixSocketAttr"><span class="hs-identifier">fileBrowserUnixSocketAttr</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Example browser entry filters</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileTypeMatch"><span class="hs-identifier">fileTypeMatch</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileExtensionMatch"><span class="hs-identifier">fileExtensionMatch</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Lenses</span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntryFilterL"><span class="hs-identifier">fileBrowserEntryFilterL</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectableL"><span class="hs-identifier">fileBrowserSelectableL</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileInfoFilenameL"><span class="hs-identifier">fileInfoFilenameL</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileInfoSanitizedFilenameL"><span class="hs-identifier">fileInfoSanitizedFilenameL</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileInfoFilePathL"><span class="hs-identifier">fileInfoFilePathL</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileInfoFileStatusL"><span class="hs-identifier">fileInfoFileStatusL</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileInfoLinkTargetTypeL"><span class="hs-identifier">fileInfoLinkTargetTypeL</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileStatusSizeL"><span class="hs-identifier">fileStatusSizeL</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileStatusFileTypeL"><span class="hs-identifier">fileStatusFileTypeL</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Miscellaneous</span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#prettyFileSize"><span class="hs-identifier">prettyFileSize</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#entriesForDirectory"><span class="hs-identifier">entriesForDirectory</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#getFileInfo"><span class="hs-identifier">getFileInfo</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isPrint</span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span class="hs-cpp">
#if !(MIN_VERSION_base(4,11,0))
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isSuffixOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-147"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Vty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vty</span></span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">D</span></span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix.Files</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">U</span></span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix.Types</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">U</span></span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FP</span></span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">printf</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.Types.html"><span class="hs-identifier">Brick.Types</span></a></span><span>
</span><span id="line-156"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.AttrMap.html"><span class="hs-identifier">Brick.AttrMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier">AttrName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.Widgets.Core.html"><span class="hs-identifier">Brick.Widgets.Core</span></a></span><span>
</span><span id="line-158"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.Widgets.List.html"><span class="hs-identifier">Brick.Widgets.List</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | A file browser's state. Embed this in your application state and</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- transform it with 'handleFileBrowserEvent' and the functions included</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- in this module.</span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="FileBrowser"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-var">FileBrowser</span></a></span></span><span> </span><span id="local-6989586621679375364"><span class="annot"><a href="#local-6989586621679375364"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>    </span><span id="FileBrowser"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-var">FileBrowser</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fileBrowserWorkingDirectory"><span class="annot"><span class="annottext">FileBrowser n -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserWorkingDirectory"><span class="hs-identifier hs-var hs-var">fileBrowserWorkingDirectory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-165"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="fileBrowserEntries"><span class="annot"><span class="annottext">FileBrowser n -&gt; List n FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntries"><span class="hs-identifier hs-var hs-var">fileBrowserEntries</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375364"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span>
</span><span id="line-166"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="fileBrowserLatestResults"><span class="annot"><span class="annottext">FileBrowser n -&gt; [FileInfo]
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserLatestResults"><span class="hs-identifier hs-var hs-var">fileBrowserLatestResults</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="fileBrowserSelectedFiles"><span class="annot"><span class="annottext">FileBrowser n -&gt; Set FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedFiles"><span class="hs-identifier hs-var hs-var">fileBrowserSelectedFiles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-168"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="fileBrowserName"><span class="annot"><span class="annottext">FileBrowser n -&gt; n
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserName"><span class="hs-identifier hs-var hs-var">fileBrowserName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679375364"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-169"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="fileBrowserEntryFilter"><span class="annot"><span class="annottext">FileBrowser n -&gt; Maybe (FileInfo -&gt; Bool)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntryFilter"><span class="hs-identifier hs-var hs-var">fileBrowserEntryFilter</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="fileBrowserSearchString"><span class="annot"><span class="annottext">FileBrowser n -&gt; Maybe Text
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchString"><span class="hs-identifier hs-var hs-var">fileBrowserSearchString</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-171"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="fileBrowserException"><span class="annot"><span class="annottext">FileBrowser n -&gt; Maybe IOException
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserException"><span class="hs-identifier hs-var hs-var">fileBrowserException</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.IOException</span></span><span>
</span><span id="line-172"></span><span>                </span><span class="hs-comment">-- ^ The exception status of the latest directory</span><span>
</span><span id="line-173"></span><span>                </span><span class="hs-comment">-- change. If 'Nothing', the latest directory change</span><span>
</span><span id="line-174"></span><span>                </span><span class="hs-comment">-- was successful and all entries were read. Otherwise,</span><span>
</span><span id="line-175"></span><span>                </span><span class="hs-comment">-- this contains the exception raised by the latest</span><span>
</span><span id="line-176"></span><span>                </span><span class="hs-comment">-- directory change in case the calling application</span><span>
</span><span id="line-177"></span><span>                </span><span class="hs-comment">-- needs to inspect or present the error to the user.</span><span>
</span><span id="line-178"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="fileBrowserSelectable"><span class="annot"><span class="annottext">FileBrowser n -&gt; FileInfo -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectable"><span class="hs-identifier hs-var hs-var">fileBrowserSelectable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-179"></span><span>                </span><span class="hs-comment">-- ^ The function that determines what kinds of entries</span><span>
</span><span id="line-180"></span><span>                </span><span class="hs-comment">-- are selectable with in the event handler. Note that</span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-comment">-- if this returns 'True' for an entry, an @Enter@ or</span><span>
</span><span id="line-182"></span><span>                </span><span class="hs-comment">-- @Space@ keypress selects that entry rather than doing</span><span>
</span><span id="line-183"></span><span>                </span><span class="hs-comment">-- anything else; directory changes can only occur if</span><span>
</span><span id="line-184"></span><span>                </span><span class="hs-comment">-- this returns 'False' for directories.</span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span>                </span><span class="hs-comment">-- Note that this is a record field so it can be used to</span><span>
</span><span id="line-187"></span><span>                </span><span class="hs-comment">-- change the selection function.</span><span>
</span><span id="line-188"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | File status information.</span><span>
</span><span id="line-191"></span><span class="hs-keyword">data</span><span> </span><span id="FileStatus"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileStatus"><span class="hs-identifier hs-var">FileStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>    </span><span id="FileStatus"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileStatus"><span class="hs-identifier hs-var">FileStatus</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fileStatusSize"><span class="annot"><span class="annottext">FileStatus -&gt; Int64
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusSize"><span class="hs-identifier hs-var hs-var">fileStatusSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-193"></span><span>               </span><span class="hs-comment">-- ^ The size, in bytes, of this entry's file.</span><span>
</span><span id="line-194"></span><span>               </span><span class="hs-special">,</span><span> </span><span id="fileStatusFileType"><span class="annot"><span class="annottext">FileStatus -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusFileType"><span class="hs-identifier hs-var hs-var">fileStatusFileType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileType"><span class="hs-identifier hs-type">FileType</span></a></span><span>
</span><span id="line-195"></span><span>               </span><span class="hs-comment">-- ^ The type of this entry's file, if it could be</span><span>
</span><span id="line-196"></span><span>               </span><span class="hs-comment">-- determined.</span><span>
</span><span id="line-197"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-198"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375110"><span id="local-6989586621679375112"><span id="local-6989586621679375114"><span class="annot"><span class="annottext">Int -&gt; FileStatus -&gt; ShowS
[FileStatus] -&gt; ShowS
FileStatus -&gt; FilePath
(Int -&gt; FileStatus -&gt; ShowS)
-&gt; (FileStatus -&gt; FilePath)
-&gt; ([FileStatus] -&gt; ShowS)
-&gt; Show FileStatus
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FileStatus] -&gt; ShowS
$cshowList :: [FileStatus] -&gt; ShowS
show :: FileStatus -&gt; FilePath
$cshow :: FileStatus -&gt; FilePath
showsPrec :: Int -&gt; FileStatus -&gt; ShowS
$cshowsPrec :: Int -&gt; FileStatus -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375105"><span id="local-6989586621679375107"><span class="annot"><span class="annottext">FileStatus -&gt; FileStatus -&gt; Bool
(FileStatus -&gt; FileStatus -&gt; Bool)
-&gt; (FileStatus -&gt; FileStatus -&gt; Bool) -&gt; Eq FileStatus
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FileStatus -&gt; FileStatus -&gt; Bool
$c/= :: FileStatus -&gt; FileStatus -&gt; Bool
== :: FileStatus -&gt; FileStatus -&gt; Bool
$c== :: FileStatus -&gt; FileStatus -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Information about a file entry in the browser.</span><span>
</span><span id="line-201"></span><span class="hs-keyword">data</span><span> </span><span id="FileInfo"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-var">FileInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>    </span><span id="FileInfo"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-var">FileInfo</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fileInfoFilename"><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-203"></span><span>             </span><span class="hs-comment">-- ^ The filename of this entry, without its path.</span><span>
</span><span id="line-204"></span><span>             </span><span class="hs-comment">-- This is not for display purposes; for that, use</span><span>
</span><span id="line-205"></span><span>             </span><span class="hs-comment">-- 'fileInfoSanitizedFilename'.</span><span>
</span><span id="line-206"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="fileInfoSanitizedFilename"><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoSanitizedFilename"><span class="hs-identifier hs-var hs-var">fileInfoSanitizedFilename</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-207"></span><span>             </span><span class="hs-comment">-- ^ The filename of this entry with out its path,</span><span>
</span><span id="line-208"></span><span>             </span><span class="hs-comment">-- sanitized of non-printable characters (replaced with</span><span>
</span><span id="line-209"></span><span>             </span><span class="hs-comment">-- '?'). This is for display purposes only.</span><span>
</span><span id="line-210"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="fileInfoFilePath"><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilePath"><span class="hs-identifier hs-var hs-var">fileInfoFilePath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-211"></span><span>             </span><span class="hs-comment">-- ^ The full path to this entry's file.</span><span>
</span><span id="line-212"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="fileInfoFileStatus"><span class="annot"><span class="annottext">FileInfo -&gt; Either IOException FileStatus
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileStatus"><span class="hs-identifier hs-var hs-var">fileInfoFileStatus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.IOException</span></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileStatus"><span class="hs-identifier hs-type">FileStatus</span></a></span><span>
</span><span id="line-213"></span><span>             </span><span class="hs-comment">-- ^ The file status if it could be obtained, or the</span><span>
</span><span id="line-214"></span><span>             </span><span class="hs-comment">-- exception that was caught when attempting to read the</span><span>
</span><span id="line-215"></span><span>             </span><span class="hs-comment">-- file's status.</span><span>
</span><span id="line-216"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="fileInfoLinkTargetType"><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoLinkTargetType"><span class="hs-identifier hs-var hs-var">fileInfoLinkTargetType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileType"><span class="hs-identifier hs-type">FileType</span></a></span><span>
</span><span id="line-217"></span><span>             </span><span class="hs-comment">-- ^ If this entry is a symlink, this indicates the type of</span><span>
</span><span id="line-218"></span><span>             </span><span class="hs-comment">-- file the symlink points to, if it could be obtained.</span><span>
</span><span id="line-219"></span><span>             </span><span class="hs-special">}</span><span>
</span><span id="line-220"></span><span>             </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375092"><span id="local-6989586621679375094"><span id="local-6989586621679375096"><span class="annot"><span class="annottext">Int -&gt; FileInfo -&gt; ShowS
[FileInfo] -&gt; ShowS
FileInfo -&gt; FilePath
(Int -&gt; FileInfo -&gt; ShowS)
-&gt; (FileInfo -&gt; FilePath) -&gt; ([FileInfo] -&gt; ShowS) -&gt; Show FileInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FileInfo] -&gt; ShowS
$cshowList :: [FileInfo] -&gt; ShowS
show :: FileInfo -&gt; FilePath
$cshow :: FileInfo -&gt; FilePath
showsPrec :: Int -&gt; FileInfo -&gt; ShowS
$cshowsPrec :: Int -&gt; FileInfo -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375088"><span id="local-6989586621679375090"><span class="annot"><span class="annottext">FileInfo -&gt; FileInfo -&gt; Bool
(FileInfo -&gt; FileInfo -&gt; Bool)
-&gt; (FileInfo -&gt; FileInfo -&gt; Bool) -&gt; Eq FileInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FileInfo -&gt; FileInfo -&gt; Bool
$c/= :: FileInfo -&gt; FileInfo -&gt; Bool
== :: FileInfo -&gt; FileInfo -&gt; Bool
$c== :: FileInfo -&gt; FileInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | The type of file entries in the browser.</span><span>
</span><span id="line-223"></span><span class="hs-keyword">data</span><span> </span><span id="FileType"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileType"><span class="hs-identifier hs-var">FileType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>    </span><span id="RegularFile"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#RegularFile"><span class="hs-identifier hs-var">RegularFile</span></a></span></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-comment">-- ^ A regular disk file.</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BlockDevice"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#BlockDevice"><span class="hs-identifier hs-var">BlockDevice</span></a></span></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-comment">-- ^ A block device.</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CharacterDevice"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#CharacterDevice"><span class="hs-identifier hs-var">CharacterDevice</span></a></span></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- ^ A character device.</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="NamedPipe"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#NamedPipe"><span class="hs-identifier hs-var">NamedPipe</span></a></span></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- ^ A named pipe.</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Directory"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-comment">-- ^ A directory.</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SymbolicLink"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-comment">-- ^ A symbolic link.</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="UnixSocket"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#UnixSocket"><span class="hs-identifier hs-var">UnixSocket</span></a></span></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-comment">-- ^ A Unix socket.</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375073"><span id="local-6989586621679375075"><span id="local-6989586621679375077"><span id="local-6989586621679375079"><span class="annot"><span class="annottext">ReadPrec [FileType]
ReadPrec FileType
Int -&gt; ReadS FileType
ReadS [FileType]
(Int -&gt; ReadS FileType)
-&gt; ReadS [FileType]
-&gt; ReadPrec FileType
-&gt; ReadPrec [FileType]
-&gt; Read FileType
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [FileType]
$creadListPrec :: ReadPrec [FileType]
readPrec :: ReadPrec FileType
$creadPrec :: ReadPrec FileType
readList :: ReadS [FileType]
$creadList :: ReadS [FileType]
readsPrec :: Int -&gt; ReadS FileType
$creadsPrec :: Int -&gt; ReadS FileType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375066"><span id="local-6989586621679375068"><span id="local-6989586621679375070"><span class="annot"><span class="annottext">Int -&gt; FileType -&gt; ShowS
[FileType] -&gt; ShowS
FileType -&gt; FilePath
(Int -&gt; FileType -&gt; ShowS)
-&gt; (FileType -&gt; FilePath) -&gt; ([FileType] -&gt; ShowS) -&gt; Show FileType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FileType] -&gt; ShowS
$cshowList :: [FileType] -&gt; ShowS
show :: FileType -&gt; FilePath
$cshow :: FileType -&gt; FilePath
showsPrec :: Int -&gt; FileType -&gt; ShowS
$cshowsPrec :: Int -&gt; FileType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375062"><span id="local-6989586621679375064"><span class="annot"><span class="annottext">FileType -&gt; FileType -&gt; Bool
(FileType -&gt; FileType -&gt; Bool)
-&gt; (FileType -&gt; FileType -&gt; Bool) -&gt; Eq FileType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FileType -&gt; FileType -&gt; Bool
$c/= :: FileType -&gt; FileType -&gt; Bool
== :: FileType -&gt; FileType -&gt; Bool
$c== :: FileType -&gt; FileType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span id="fileBrowserWorkingDirectoryL"><span id="fileBrowserSelectedFilesL"><span id="fileBrowserSearchStringL"><span id="fileBrowserNameL"><span id="fileBrowserLatestResultsL"><span id="fileBrowserExceptionL"><span id="fileBrowserEntriesL"><span id="fileBrowserSelectableL"><span id="fileBrowserEntryFilterL"><span id="local-6989586621679375364"><span class="hs-identifier">suffixLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">FileBrowser</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-241"></span><span id="fileInfoLinkTargetTypeL"><span id="fileInfoFileStatusL"><span id="fileInfoFilePathL"><span id="fileInfoSanitizedFilenameL"><span id="fileInfoFilenameL"><span class="hs-identifier">suffixLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">FileInfo</span></span></span></span></span></span><span>
</span><span id="line-242"></span><span id="fileStatusFileTypeL"><span id="fileStatusSizeL"><span class="hs-identifier">suffixLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">FileStatus</span></span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Make a new file browser state. The provided resource name will be</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- used to render the 'List' viewport of the browser.</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- By default, the browser will show all files and directories</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- in its working directory. To change that behavior, see</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- 'setFileBrowserEntryFilter'.</span><span>
</span><span id="line-250"></span><span id="local-6989586621679375054"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#newFileBrowser"><span class="hs-identifier hs-type">newFileBrowser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>               </span><span class="hs-comment">-- ^ The function used to determine what kinds of entries</span><span>
</span><span id="line-252"></span><span>               </span><span class="hs-comment">-- can be selected (see 'handleFileBrowserEvent'). A</span><span>
</span><span id="line-253"></span><span>               </span><span class="hs-comment">-- good default is 'selectNonDirectories'. This can be</span><span>
</span><span id="line-254"></span><span>               </span><span class="hs-comment">-- changed at 'any time with 'fileBrowserSelectable' or</span><span>
</span><span id="line-255"></span><span>               </span><span class="hs-comment">-- its 'corresponding lens.</span><span>
</span><span id="line-256"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375054"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-257"></span><span>               </span><span class="hs-comment">-- ^ The resource name associated with the browser's</span><span>
</span><span id="line-258"></span><span>               </span><span class="hs-comment">-- entry listing.</span><span>
</span><span id="line-259"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-260"></span><span>               </span><span class="hs-comment">-- ^ The initial working directory that the browser</span><span>
</span><span id="line-261"></span><span>               </span><span class="hs-comment">-- displays. If not provided, this defaults to the</span><span>
</span><span id="line-262"></span><span>               </span><span class="hs-comment">-- executable's current working directory.</span><span>
</span><span id="line-263"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375054"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-264"></span><span id="newFileBrowser"><span class="annot"><span class="annottext">newFileBrowser :: (FileInfo -&gt; Bool) -&gt; n -&gt; Maybe FilePath -&gt; IO (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#newFileBrowser"><span class="hs-identifier hs-var hs-var">newFileBrowser</span></a></span></span><span> </span><span id="local-6989586621679375053"><span class="annot"><span class="annottext">FileInfo -&gt; Bool
</span><a href="#local-6989586621679375053"><span class="hs-identifier hs-var">selPredicate</span></a></span></span><span> </span><span id="local-6989586621679375052"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375052"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679375051"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679375051"><span class="hs-identifier hs-var">mCwd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621679375050"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375050"><span class="hs-identifier hs-var">initialCwd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679375051"><span class="hs-identifier hs-var">mCwd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375049"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375049"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375049"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">D.getCurrentDirectory</span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375047"><span class="annot"><span class="annottext">b :: FileBrowser n
</span><a href="#local-6989586621679375047"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileBrowser :: forall n.
FilePath
-&gt; List n FileInfo
-&gt; [FileInfo]
-&gt; Set FilePath
-&gt; n
-&gt; Maybe (FileInfo -&gt; Bool)
-&gt; Maybe Text
-&gt; Maybe IOException
-&gt; (FileInfo -&gt; Bool)
-&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fileBrowserWorkingDirectory :: FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserWorkingDirectory"><span class="hs-identifier hs-var">fileBrowserWorkingDirectory</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375050"><span class="hs-identifier hs-var">initialCwd</span></a></span><span>
</span><span id="line-270"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileBrowserEntries :: List n FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntries"><span class="hs-identifier hs-var">fileBrowserEntries</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Vector FileInfo -&gt; Int -&gt; List n FileInfo
forall (t :: * -&gt; *) n e.
Foldable t =&gt;
n -&gt; t e -&gt; Int -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#list"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375052"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Vector FileInfo
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-271"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileBrowserLatestResults :: [FileInfo]
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserLatestResults"><span class="hs-identifier hs-var">fileBrowserLatestResults</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FileInfo]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-272"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileBrowserSelectedFiles :: Set FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedFiles"><span class="hs-identifier hs-var">fileBrowserSelectedFiles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FilePath
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-273"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileBrowserName :: n
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserName"><span class="hs-identifier hs-var">fileBrowserName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375052"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-274"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileBrowserEntryFilter :: Maybe (FileInfo -&gt; Bool)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntryFilter"><span class="hs-identifier hs-var">fileBrowserEntryFilter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FileInfo -&gt; Bool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-275"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileBrowserSearchString :: Maybe Text
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchString"><span class="hs-identifier hs-var">fileBrowserSearchString</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-276"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileBrowserException :: Maybe IOException
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserException"><span class="hs-identifier hs-var">fileBrowserException</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe IOException
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-277"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileBrowserSelectable :: FileInfo -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectable"><span class="hs-identifier hs-var">fileBrowserSelectable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Bool
</span><a href="#local-6989586621679375053"><span class="hs-identifier hs-var">selPredicate</span></a></span><span>
</span><span id="line-278"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; FileBrowser n -&gt; IO (FileBrowser n)
forall n. FilePath -&gt; FileBrowser n -&gt; IO (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#setWorkingDirectory"><span class="hs-identifier hs-var">setWorkingDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375050"><span class="hs-identifier hs-var">initialCwd</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679375047"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | A file entry selector that permits selection of all file entries</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- except directories. Use this if you want users to be able to navigate</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- directories in the browser. If you want users to be able to select</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- only directories, use 'selectDirectories'.</span><span>
</span><span id="line-286"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#selectNonDirectories"><span class="hs-identifier hs-type">selectNonDirectories</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-287"></span><span id="selectNonDirectories"><span class="annot"><span class="annottext">selectNonDirectories :: FileInfo -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#selectNonDirectories"><span class="hs-identifier hs-var hs-var">selectNonDirectories</span></a></span></span><span> </span><span id="local-6989586621679375045"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375045"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375045"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoLinkTargetType"><span class="hs-identifier hs-var hs-var">fileInfoLinkTargetType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375045"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-293"></span><span>                </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-294"></span><span>        </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | A file entry selector that permits selection of directories</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- only. This prevents directory navigation and only supports directory</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- selection.</span><span>
</span><span id="line-299"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#selectDirectories"><span class="hs-identifier hs-type">selectDirectories</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-300"></span><span id="selectDirectories"><span class="annot"><span class="annottext">selectDirectories :: FileInfo -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#selectDirectories"><span class="hs-identifier hs-var hs-var">selectDirectories</span></a></span></span><span> </span><span id="local-6989586621679375044"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375044"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375044"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-304"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoLinkTargetType"><span class="hs-identifier hs-var hs-var">fileInfoLinkTargetType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375044"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-305"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-306"></span><span>                </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-comment">-- | Set the filtering function used to determine which entries in</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- the browser's current directory appear in the browser. 'Nothing'</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- indicates no filtering, meaning all entries will be shown. 'Just'</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- indicates a function that should return 'True' for entries that</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- should be permitted to appear.</span><span>
</span><span id="line-314"></span><span id="local-6989586621679375043"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#setFileBrowserEntryFilter"><span class="hs-identifier hs-type">setFileBrowserEntryFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375043"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375043"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-315"></span><span id="setFileBrowserEntryFilter"><span class="annot"><span class="annottext">setFileBrowserEntryFilter :: Maybe (FileInfo -&gt; Bool) -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#setFileBrowserEntryFilter"><span class="hs-identifier hs-var hs-var">setFileBrowserEntryFilter</span></a></span></span><span> </span><span id="local-6989586621679375042"><span class="annot"><span class="annottext">Maybe (FileInfo -&gt; Bool)
</span><a href="#local-6989586621679375042"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679375041"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679375041"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; FileBrowser n
forall n. FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#applyFilterAndSearch"><span class="hs-identifier hs-var">applyFilterAndSearch</span></a></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n -&gt; FileBrowser n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679375041"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (FileInfo -&gt; Bool) -&gt; Identity (Maybe (FileInfo -&gt; Bool)))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (Maybe (FileInfo -&gt; Bool))
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntryFilterL"><span class="hs-identifier hs-var">fileBrowserEntryFilterL</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (FileInfo -&gt; Bool) -&gt; Identity (Maybe (FileInfo -&gt; Bool)))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; Maybe (FileInfo -&gt; Bool) -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe (FileInfo -&gt; Bool)
</span><a href="#local-6989586621679375042"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- | Set the working directory of the file browser. This scans the new</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- directory and repopulates the browser while maintaining any active</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- search string and/or entry filtering.</span><span>
</span><span id="line-321"></span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- If the directory scan raises an 'IOException', the exception is</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- stored in the browser and is accessible with 'fileBrowserException'. If</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- no exception is raised, the exception field is cleared. Regardless of</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- whether an exception is raised, @..@ is always presented as a valid</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- option in the browser.</span><span>
</span><span id="line-327"></span><span id="local-6989586621679375356"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#setWorkingDirectory"><span class="hs-identifier hs-type">setWorkingDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375356"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375356"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-328"></span><span id="setWorkingDirectory"><span class="annot"><span class="annottext">setWorkingDirectory :: FilePath -&gt; FileBrowser n -&gt; IO (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#setWorkingDirectory"><span class="hs-identifier hs-var hs-var">setWorkingDirectory</span></a></span></span><span> </span><span id="local-6989586621679375037"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375037"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679375036"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679375036"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679375035"><span class="annot"><span class="annottext">Either IOException [FileInfo]
</span><a href="#local-6989586621679375035"><span class="hs-identifier hs-var">entriesResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [FileInfo] -&gt; IO (Either IOException [FileInfo])
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">E.try</span></span><span> </span><span class="annot"><span class="annottext">(IO [FileInfo] -&gt; IO (Either IOException [FileInfo]))
-&gt; IO [FileInfo] -&gt; IO (Either IOException [FileInfo])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [FileInfo]
</span><a href="Brick.Widgets.FileBrowser.html#entriesForDirectory"><span class="hs-identifier hs-var">entriesForDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375037"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375033"><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679375033"><span class="hs-identifier hs-var">entries</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375032"><span class="annot"><span class="annottext">Maybe IOException
</span><a href="#local-6989586621679375032"><span class="hs-identifier hs-var">exc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOException [FileInfo]
</span><a href="#local-6989586621679375035"><span class="hs-identifier hs-var">entriesResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-332"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375031"><span class="annot"><a href="#local-6989586621679375031"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">E.IOException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IOException -&gt; Maybe IOException
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679375031"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679375030"><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679375030"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679375030"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe IOException
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621679375029"><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679375029"><span class="hs-identifier hs-var">allEntries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375037"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[FileInfo] -&gt; IO [FileInfo]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679375033"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>        </span><span id="local-6989586621679375028"><span class="annot"><span class="annottext">Either IOException FileInfo
</span><a href="#local-6989586621679375028"><span class="hs-identifier hs-var">parentResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FileInfo -&gt; IO (Either IOException FileInfo)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">E.try</span></span><span> </span><span class="annot"><span class="annottext">(IO FileInfo -&gt; IO (Either IOException FileInfo))
-&gt; IO FileInfo -&gt; IO (Either IOException FileInfo)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#parentOf"><span class="hs-identifier hs-var">parentOf</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375037"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><span class="annottext">[FileInfo] -&gt; IO [FileInfo]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([FileInfo] -&gt; IO [FileInfo]) -&gt; [FileInfo] -&gt; IO [FileInfo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOException FileInfo
</span><a href="#local-6989586621679375028"><span class="hs-identifier hs-var">parentResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-338"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">E.IOException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679375033"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-339"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679375026"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375026"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375026"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; [FileInfo] -&gt; [FileInfo]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679375033"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375025"><span class="annot"><span class="annottext">b' :: FileBrowser n
</span><a href="#local-6989586621679375025"><span class="hs-identifier hs-var hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FileInfo] -&gt; FileBrowser n -&gt; FileBrowser n
forall n. [FileInfo] -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#setEntries"><span class="hs-identifier hs-var">setEntries</span></a></span><span> </span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679375029"><span class="hs-identifier hs-var">allEntries</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679375036"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; IO (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; IO (FileBrowser n))
-&gt; FileBrowser n -&gt; IO (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679375025"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Identity FilePath)
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserWorkingDirectoryL"><span class="hs-identifier hs-var">fileBrowserWorkingDirectoryL</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; Identity FilePath)
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; FilePath -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375037"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-343"></span><span>                </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe IOException -&gt; Identity (Maybe IOException))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (Maybe IOException)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserExceptionL"><span class="hs-identifier hs-var">fileBrowserExceptionL</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe IOException -&gt; Identity (Maybe IOException))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; Maybe IOException -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe IOException
</span><a href="#local-6989586621679375032"><span class="hs-identifier hs-var">exc</span></a></span><span>
</span><span id="line-344"></span><span>                </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Set FilePath -&gt; Identity (Set FilePath))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (Set FilePath)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedFilesL"><span class="hs-identifier hs-var">fileBrowserSelectedFilesL</span></a></span><span> </span><span class="annot"><span class="annottext">((Set FilePath -&gt; Identity (Set FilePath))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; Set FilePath -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Set FilePath
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#parentOf"><span class="hs-identifier hs-type">parentOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span>
</span><span id="line-347"></span><span id="parentOf"><span class="annot"><span class="annottext">parentOf :: FilePath -&gt; IO FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#parentOf"><span class="hs-identifier hs-var hs-var">parentOf</span></a></span></span><span> </span><span id="local-6989586621679375023"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375023"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#getFileInfo"><span class="hs-identifier hs-var">getFileInfo</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;..&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FileInfo) -&gt; FilePath -&gt; IO FileInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">FP.takeDirectory</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375023"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-comment">-- | Build a 'FileInfo' for the specified file and path. If an</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- 'IOException' is raised while attempting to get the file information,</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- the 'fileInfoFileStatus' field is populated with the exception.</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- Otherwise it is populated with the 'FileStatus' for the file.</span><span>
</span><span id="line-353"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#getFileInfo"><span class="hs-identifier hs-type">getFileInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-comment">-- ^ The name of the file to inspect. This filename is only</span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-comment">-- used to set the 'fileInfoFilename' and sanitized filename</span><span>
</span><span id="line-356"></span><span>            </span><span class="hs-comment">-- fields; the actual file to be inspected is referred</span><span>
</span><span id="line-357"></span><span>            </span><span class="hs-comment">-- to by the second argument. This is decomposed so that</span><span>
</span><span id="line-358"></span><span>            </span><span class="hs-comment">-- 'FileInfo's can be used to represent information about</span><span>
</span><span id="line-359"></span><span>            </span><span class="hs-comment">-- entries like @..@, whose display names differ from their</span><span>
</span><span id="line-360"></span><span>            </span><span class="hs-comment">-- physical paths.</span><span>
</span><span id="line-361"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-362"></span><span>            </span><span class="hs-comment">-- ^ The actual full path to the file or directory to</span><span>
</span><span id="line-363"></span><span>            </span><span class="hs-comment">-- inspect.</span><span>
</span><span id="line-364"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span>
</span><span id="line-365"></span><span id="getFileInfo"><span class="annot"><span class="annottext">getFileInfo :: FilePath -&gt; FilePath -&gt; IO FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#getFileInfo"><span class="hs-identifier hs-var hs-var">getFileInfo</span></a></span></span><span> </span><span id="local-6989586621679375021"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375021"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath -&gt; IO FileInfo
</span><a href="#local-6989586621679375020"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>        </span><span id="local-6989586621679375020"><span class="annot"><span class="annottext">go :: [FilePath] -&gt; FilePath -&gt; IO FileInfo
</span><a href="#local-6989586621679375020"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679375019"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679375019"><span class="hs-identifier hs-var">history</span></a></span></span><span> </span><span id="local-6989586621679375018"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375018"><span class="hs-identifier hs-var">fullPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-368"></span><span>            </span><span id="local-6989586621679375017"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375017"><span class="hs-identifier hs-var">filePath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.makeAbsolute</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375018"><span class="hs-identifier hs-var">fullPath</span></a></span><span>
</span><span id="line-369"></span><span>            </span><span id="local-6989586621679375015"><span class="annot"><span class="annottext">Either IOException FileStatus
</span><a href="#local-6989586621679375015"><span class="hs-identifier hs-var">statusResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FileStatus -&gt; IO (Either IOException FileStatus)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">E.try</span></span><span> </span><span class="annot"><span class="annottext">(IO FileStatus -&gt; IO (Either IOException FileStatus))
-&gt; IO FileStatus -&gt; IO (Either IOException FileStatus)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FileStatus
</span><span class="hs-identifier hs-var">U.getSymbolicLinkStatus</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375017"><span class="hs-identifier hs-var">filePath</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375013"><span class="annot"><span class="annottext">stat :: Either IOException FileStatus
</span><a href="#local-6989586621679375013"><span class="hs-identifier hs-var hs-var">stat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>                  </span><span id="local-6989586621679375012"><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679375012"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either IOException FileStatus
</span><a href="#local-6989586621679375015"><span class="hs-identifier hs-var">statusResult</span></a></span><span>
</span><span id="line-373"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">U.COff</span></span><span> </span><span id="local-6989586621679375010"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679375010"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; COff
</span><span class="hs-identifier hs-var">U.fileSize</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679375012"><span class="hs-identifier hs-var">status</span></a></span><span>
</span><span id="line-374"></span><span>                  </span><span class="annot"><span class="annottext">FileStatus -&gt; Either IOException FileStatus
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FileStatus :: Int64 -&gt; Maybe FileType -&gt; FileStatus
</span><a href="Brick.Widgets.FileBrowser.html#FileStatus"><span class="hs-identifier hs-type">FileStatus</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fileStatusFileType :: Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusFileType"><span class="hs-identifier hs-var">fileStatusFileType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileTypeFromStatus"><span class="hs-identifier hs-var">fileTypeFromStatus</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679375012"><span class="hs-identifier hs-var">status</span></a></span><span>
</span><span id="line-375"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileStatusSize :: Int64
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusSize"><span class="hs-identifier hs-var">fileStatusSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679375010"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-376"></span><span>                                    </span><span class="hs-special">}</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>            </span><span id="local-6989586621679375007"><span class="annot"><span class="annottext">Maybe FileType
</span><a href="#local-6989586621679375007"><span class="hs-identifier hs-var">targetTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusFileType"><span class="hs-identifier hs-var hs-var">fileStatusFileType</span></a></span><span> </span><span class="annot"><span class="annottext">(FileStatus -&gt; Maybe FileType)
-&gt; Either IOException FileStatus
-&gt; Either IOException (Maybe FileType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either IOException FileStatus
</span><a href="#local-6989586621679375013"><span class="hs-identifier hs-var">stat</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-379"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>                    </span><span id="local-6989586621679375005"><span class="annot"><span class="annottext">Either SomeException FilePath
</span><a href="#local-6989586621679375005"><span class="hs-identifier hs-var">targetPathResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; IO (Either SomeException FilePath)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">E.try</span></span><span> </span><span class="annot"><span class="annottext">(IO FilePath -&gt; IO (Either SomeException FilePath))
-&gt; IO FilePath -&gt; IO (Either SomeException FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">U.readSymbolicLink</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375017"><span class="hs-identifier hs-var">filePath</span></a></span><span>
</span><span id="line-381"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either SomeException FilePath
</span><a href="#local-6989586621679375005"><span class="hs-identifier hs-var">targetPathResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-382"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException
</span><span class="hs-identifier">_</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">E.SomeException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; IO (Maybe FileType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe FileType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-383"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679375003"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375003"><span class="hs-identifier hs-var">targetPath</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-384"></span><span>                            </span><span class="hs-comment">-- Watch out for recursive symlink chains:</span><span>
</span><span id="line-385"></span><span>                            </span><span class="hs-comment">-- if history starts repeating, abort the</span><span>
</span><span id="line-386"></span><span>                            </span><span class="hs-comment">-- symlink following process.</span><span>
</span><span id="line-387"></span><span>                            </span><span class="hs-comment">--</span><span>
</span><span id="line-388"></span><span>                            </span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-389"></span><span>                            </span><span class="hs-comment">--   $ ln -s foo foo</span><span>
</span><span id="line-390"></span><span>                            </span><span class="hs-comment">--</span><span>
</span><span id="line-391"></span><span>                            </span><span class="hs-comment">--   $ ln -s foo bar</span><span>
</span><span id="line-392"></span><span>                            </span><span class="hs-comment">--   $ ln -s bar foo</span><span>
</span><span id="line-393"></span><span>                            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375003"><span class="hs-identifier hs-var">targetPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679375019"><span class="hs-identifier hs-var">history</span></a></span><span>
</span><span id="line-394"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; IO (Maybe FileType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe FileType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-395"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-396"></span><span>                                </span><span id="local-6989586621679375001"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375001"><span class="hs-identifier hs-var">targetInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FileInfo -&gt; IO FileInfo
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO FileInfo -&gt; IO FileInfo) -&gt; IO FileInfo -&gt; IO FileInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath -&gt; IO FileInfo
</span><a href="#local-6989586621679375020"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375018"><span class="hs-identifier hs-var">fullPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; [FilePath]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679375019"><span class="hs-identifier hs-var">history</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375003"><span class="hs-identifier hs-var">targetPath</span></a></span><span>
</span><span id="line-397"></span><span>                                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Either IOException FileStatus
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileStatus"><span class="hs-identifier hs-var hs-var">fileInfoFileStatus</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679375001"><span class="hs-identifier hs-var">targetInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-398"></span><span>                                    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileStatus"><span class="hs-identifier hs-type">FileStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375000"><span class="annot"><span class="annottext">Maybe FileType
</span><a href="#local-6989586621679375000"><span class="hs-identifier hs-var">targetTy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; IO (Maybe FileType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe FileType
</span><a href="#local-6989586621679375000"><span class="hs-identifier hs-var">targetTy</span></a></span><span>
</span><span id="line-399"></span><span>                                    </span><span class="annot"><span class="annottext">Either IOException FileStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; IO (Maybe FileType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe FileType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-400"></span><span>                </span><span class="annot"><span class="annottext">Either IOException (Maybe FileType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; IO (Maybe FileType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe FileType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span>            </span><span class="annot"><span class="annottext">FileInfo -&gt; IO FileInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FileInfo :: FilePath
-&gt; FilePath
-&gt; FilePath
-&gt; Either IOException FileStatus
-&gt; Maybe FileType
-&gt; FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fileInfoFilename :: FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var">fileInfoFilename</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375021"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-403"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileInfoFilePath :: FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilePath"><span class="hs-identifier hs-var">fileInfoFilePath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375017"><span class="hs-identifier hs-var">filePath</span></a></span><span>
</span><span id="line-404"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileInfoSanitizedFilename :: FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoSanitizedFilename"><span class="hs-identifier hs-var">fileInfoSanitizedFilename</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Brick.Widgets.FileBrowser.html#sanitizeFilename"><span class="hs-identifier hs-var">sanitizeFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679375021"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-405"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileInfoFileStatus :: Either IOException FileStatus
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileStatus"><span class="hs-identifier hs-var">fileInfoFileStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either IOException FileStatus
</span><a href="#local-6989586621679375013"><span class="hs-identifier hs-var">stat</span></a></span><span>
</span><span id="line-406"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fileInfoLinkTargetType :: Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoLinkTargetType"><span class="hs-identifier hs-var">fileInfoLinkTargetType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FileType
</span><a href="#local-6989586621679375007"><span class="hs-identifier hs-var">targetTy</span></a></span><span>
</span><span id="line-407"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">-- | Get the file type for this file info entry. If the file type could</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- not be obtained due to an 'IOException', return 'Nothing'.</span><span>
</span><span id="line-411"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-type">fileInfoFileType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileType"><span class="hs-identifier hs-type">FileType</span></a></span><span>
</span><span id="line-412"></span><span id="fileInfoFileType"><span class="annot"><span class="annottext">fileInfoFileType :: FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var hs-var">fileInfoFileType</span></a></span></span><span> </span><span id="local-6989586621679374998"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374998"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Either IOException FileStatus
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileStatus"><span class="hs-identifier hs-var hs-var">fileInfoFileStatus</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374998"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FileType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-415"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679374997"><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374997"><span class="hs-identifier hs-var">stat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusFileType"><span class="hs-identifier hs-var hs-var">fileStatusFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374997"><span class="hs-identifier hs-var">stat</span></a></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">-- | Get the working directory of the file browser.</span><span>
</span><span id="line-418"></span><span id="local-6989586621679374996"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#getWorkingDirectory"><span class="hs-identifier hs-type">getWorkingDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374996"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span></span><span>
</span><span id="line-419"></span><span id="getWorkingDirectory"><span class="annot"><span class="annottext">getWorkingDirectory :: FileBrowser n -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#getWorkingDirectory"><span class="hs-identifier hs-var hs-var">getWorkingDirectory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; FilePath
forall n. FileBrowser n -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserWorkingDirectory"><span class="hs-identifier hs-var hs-var">fileBrowserWorkingDirectory</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span id="local-6989586621679375337"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#setEntries"><span class="hs-identifier hs-type">setEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375337"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375337"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-422"></span><span id="setEntries"><span class="annot"><span class="annottext">setEntries :: [FileInfo] -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#setEntries"><span class="hs-identifier hs-var hs-var">setEntries</span></a></span></span><span> </span><span id="local-6989586621679374995"><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679374995"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679374994"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374994"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; FileBrowser n
forall n. FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#applyFilterAndSearch"><span class="hs-identifier hs-var">applyFilterAndSearch</span></a></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n -&gt; FileBrowser n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374994"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([FileInfo] -&gt; Identity [FileInfo])
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) [FileInfo]
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserLatestResultsL"><span class="hs-identifier hs-var">fileBrowserLatestResultsL</span></a></span><span> </span><span class="annot"><span class="annottext">(([FileInfo] -&gt; Identity [FileInfo])
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; [FileInfo] -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679374995"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-comment">-- | Returns whether the file browser is in search mode, i.e., the mode</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- in which user input affects the browser's active search string and</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- displayed entries. This is used to aid in event dispatching in the</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- calling program.</span><span>
</span><span id="line-429"></span><span id="local-6989586621679375240"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserIsSearching"><span class="hs-identifier hs-type">fileBrowserIsSearching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375240"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-430"></span><span id="fileBrowserIsSearching"><span class="annot"><span class="annottext">fileBrowserIsSearching :: FileBrowser n -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserIsSearching"><span class="hs-identifier hs-var hs-var">fileBrowserIsSearching</span></a></span></span><span> </span><span id="local-6989586621679374993"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374993"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Bool) -&gt; Maybe Text -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374993"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (Maybe Text) (FileBrowser n) (Maybe Text) -&gt; Maybe Text
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Text) (FileBrowser n) (Maybe Text)
forall n. Lens' (FileBrowser n) (Maybe Text)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchStringL"><span class="hs-identifier hs-var">fileBrowserSearchStringL</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-comment">-- | Get the entries chosen by the user, if any. Entries are chosen by</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- an 'Enter' or 'Space' keypress; if you want the entry under the</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- cursor, use 'fileBrowserCursor'.</span><span>
</span><span id="line-435"></span><span id="local-6989586621679374991"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelection"><span class="hs-identifier hs-type">fileBrowserSelection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374991"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-436"></span><span id="fileBrowserSelection"><span class="annot"><span class="annottext">fileBrowserSelection :: FileBrowser n -&gt; [FileInfo]
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelection"><span class="hs-identifier hs-var hs-var">fileBrowserSelection</span></a></span></span><span> </span><span id="local-6989586621679374990"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374990"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374989"><span class="annot"><span class="annottext">getEntry :: FilePath -&gt; FileInfo
</span><a href="#local-6989586621679374989"><span class="hs-identifier hs-var hs-var">getEntry</span></a></span></span><span> </span><span id="local-6989586621679374988"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374988"><span class="hs-identifier hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FileInfo -&gt; FileInfo
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe FileInfo -&gt; FileInfo) -&gt; Maybe FileInfo -&gt; FileInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FileInfo -&gt; Bool) -&gt; [FileInfo] -&gt; Maybe FileInfo
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">F.find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374988"><span class="hs-identifier hs-var">filename</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Bool) -&gt; (FileInfo -&gt; FilePath) -&gt; FileInfo -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([FileInfo] -&gt; Maybe FileInfo) -&gt; [FileInfo] -&gt; Maybe FileInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374990"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting [FileInfo] (FileBrowser n) [FileInfo] -&gt; [FileInfo]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [FileInfo] (FileBrowser n) [FileInfo]
forall n. Lens' (FileBrowser n) [FileInfo]
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserLatestResultsL"><span class="hs-identifier hs-var">fileBrowserLatestResultsL</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FileInfo) -&gt; [FilePath] -&gt; [FileInfo]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FileInfo
</span><a href="#local-6989586621679374989"><span class="hs-identifier hs-var">getEntry</span></a></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; [FileInfo]) -&gt; [FilePath] -&gt; [FileInfo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set FilePath -&gt; [FilePath]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set FilePath -&gt; [FilePath]) -&gt; Set FilePath -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374990"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (Set FilePath) (FileBrowser n) (Set FilePath)
-&gt; Set FilePath
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Set FilePath) (FileBrowser n) (Set FilePath)
forall n. Lens' (FileBrowser n) (Set FilePath)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedFilesL"><span class="hs-identifier hs-var">fileBrowserSelectedFilesL</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | Modify the file browser's active search string. This causes the</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- browser's displayed entries to change to those in its current</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- directory that match the search string, if any. If a search string</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- is provided, it is matched case-insensitively anywhere in file or</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- directory names.</span><span>
</span><span id="line-445"></span><span id="local-6989586621679375273"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier hs-type">updateFileBrowserSearch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>                        </span><span class="hs-comment">-- ^ The search transformation. 'Nothing'</span><span>
</span><span id="line-447"></span><span>                        </span><span class="hs-comment">-- indicates that search mode should be off;</span><span>
</span><span id="line-448"></span><span>                        </span><span class="hs-comment">-- 'Just' indicates that it should be on and</span><span>
</span><span id="line-449"></span><span>                        </span><span class="hs-comment">-- that the provided search string should be</span><span>
</span><span id="line-450"></span><span>                        </span><span class="hs-comment">-- used.</span><span>
</span><span id="line-451"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375273"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-452"></span><span>                        </span><span class="hs-comment">-- ^ The browser to modify.</span><span>
</span><span id="line-453"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375273"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-454"></span><span id="updateFileBrowserSearch"><span class="annot"><span class="annottext">updateFileBrowserSearch :: (Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier hs-var hs-var">updateFileBrowserSearch</span></a></span></span><span> </span><span id="local-6989586621679374984"><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text
</span><a href="#local-6989586621679374984"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679374983"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374983"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374982"><span class="annot"><span class="annottext">old :: Maybe Text
</span><a href="#local-6989586621679374982"><span class="hs-identifier hs-var hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374983"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (Maybe Text) (FileBrowser n) (Maybe Text) -&gt; Maybe Text
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Text) (FileBrowser n) (Maybe Text)
forall n. Lens' (FileBrowser n) (Maybe Text)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchStringL"><span class="hs-identifier hs-var">fileBrowserSearchStringL</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span id="local-6989586621679374981"><span class="annot"><span class="annottext">new :: Maybe Text
</span><a href="#local-6989586621679374981"><span class="hs-identifier hs-var hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text
</span><a href="#local-6989586621679374984"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text) -&gt; Maybe Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374983"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (Maybe Text) (FileBrowser n) (Maybe Text) -&gt; Maybe Text
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Text) (FileBrowser n) (Maybe Text)
forall n. Lens' (FileBrowser n) (Maybe Text)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchStringL"><span class="hs-identifier hs-var">fileBrowserSearchStringL</span></a></span><span>
</span><span id="line-457"></span><span>        </span><span id="local-6989586621679374980"><span class="annot"><span class="annottext">oldLen :: Int
</span><a href="#local-6989586621679374980"><span class="hs-identifier hs-var hs-var">oldLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Text -&gt; Int) -&gt; Maybe Text -&gt; Int
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679374982"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-458"></span><span>        </span><span id="local-6989586621679374977"><span class="annot"><span class="annottext">newLen :: Int
</span><a href="#local-6989586621679374977"><span class="hs-identifier hs-var hs-var">newLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Text -&gt; Int) -&gt; Maybe Text -&gt; Int
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679374981"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679374982"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679374981"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-460"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374983"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-461"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679374980"><span class="hs-identifier hs-var">oldLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679374977"><span class="hs-identifier hs-var">newLen</span></a></span><span>
</span><span id="line-462"></span><span>            </span><span class="hs-comment">-- This case avoids a list rebuild and cursor position reset</span><span>
</span><span id="line-463"></span><span>            </span><span class="hs-comment">-- when the search state isn't *really* changing.</span><span>
</span><span id="line-464"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374983"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (Maybe Text)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchStringL"><span class="hs-identifier hs-var">fileBrowserSearchStringL</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; Maybe Text -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679374981"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-465"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; FileBrowser n
forall n. FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#applyFilterAndSearch"><span class="hs-identifier hs-var">applyFilterAndSearch</span></a></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n -&gt; FileBrowser n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374983"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (Maybe Text)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchStringL"><span class="hs-identifier hs-var">fileBrowserSearchStringL</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; Maybe Text -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679374981"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span id="local-6989586621679375354"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#applyFilterAndSearch"><span class="hs-identifier hs-type">applyFilterAndSearch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375354"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375354"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-468"></span><span id="applyFilterAndSearch"><span class="annot"><span class="annottext">applyFilterAndSearch :: FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#applyFilterAndSearch"><span class="hs-identifier hs-var hs-var">applyFilterAndSearch</span></a></span></span><span> </span><span id="local-6989586621679374976"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374976"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374975"><span class="annot"><span class="annottext">filterMatch :: FileInfo -&gt; Bool
</span><a href="#local-6989586621679374975"><span class="hs-identifier hs-var hs-var">filterMatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FileInfo -&gt; Bool) -&gt; Maybe (FileInfo -&gt; Bool) -&gt; FileInfo -&gt; Bool
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; FileInfo -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374976"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting
     (Maybe (FileInfo -&gt; Bool))
     (FileBrowser n)
     (Maybe (FileInfo -&gt; Bool))
-&gt; Maybe (FileInfo -&gt; Bool)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Maybe (FileInfo -&gt; Bool))
  (FileBrowser n)
  (Maybe (FileInfo -&gt; Bool))
forall n. Lens' (FileBrowser n) (Maybe (FileInfo -&gt; Bool))
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntryFilterL"><span class="hs-identifier hs-var">fileBrowserEntryFilterL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>        </span><span id="local-6989586621679374973"><span class="annot"><span class="annottext">searchMatch :: FileInfo -&gt; Bool
</span><a href="#local-6989586621679374973"><span class="hs-identifier hs-var hs-var">searchMatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FileInfo -&gt; Bool)
-&gt; (Text -&gt; FileInfo -&gt; Bool) -&gt; Maybe Text -&gt; FileInfo -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; FileInfo -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>                            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679374972"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374972"><span class="hs-identifier hs-var">search</span></a></span></span><span> </span><span id="local-6989586621679374971"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374971"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374972"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isInfixOf`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoSanitizedFilename"><span class="hs-identifier hs-var hs-var">fileInfoSanitizedFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374971"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374976"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (Maybe Text) (FileBrowser n) (Maybe Text) -&gt; Maybe Text
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Text) (FileBrowser n) (Maybe Text)
forall n. Lens' (FileBrowser n) (Maybe Text)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchStringL"><span class="hs-identifier hs-var">fileBrowserSearchStringL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>        </span><span id="local-6989586621679374967"><span class="annot"><span class="annottext">match :: FileInfo -&gt; Bool
</span><a href="#local-6989586621679374967"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679374966"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374966"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Bool
</span><a href="#local-6989586621679374975"><span class="hs-identifier hs-var">filterMatch</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374966"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Bool
</span><a href="#local-6989586621679374973"><span class="hs-identifier hs-var">searchMatch</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374966"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-474"></span><span>        </span><span id="local-6989586621679374964"><span class="annot"><span class="annottext">matching :: [FileInfo]
</span><a href="#local-6989586621679374964"><span class="hs-identifier hs-var hs-var">matching</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FileInfo -&gt; Bool) -&gt; [FileInfo] -&gt; [FileInfo]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Bool
</span><a href="#local-6989586621679374967"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">([FileInfo] -&gt; [FileInfo]) -&gt; [FileInfo] -&gt; [FileInfo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374976"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting [FileInfo] (FileBrowser n) [FileInfo] -&gt; [FileInfo]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [FileInfo] (FileBrowser n) [FileInfo]
forall n. Lens' (FileBrowser n) [FileInfo]
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserLatestResultsL"><span class="hs-identifier hs-var">fileBrowserLatestResultsL</span></a></span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374976"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fileBrowserEntries :: List n FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntries"><span class="hs-identifier hs-var">fileBrowserEntries</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Vector FileInfo -&gt; Int -&gt; List n FileInfo
forall (t :: * -&gt; *) n e.
Foldable t =&gt;
n -&gt; t e -&gt; Int -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#list"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374976"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n -&gt; Getting n (FileBrowser n) n -&gt; n
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting n (FileBrowser n) n
forall n. Lens' (FileBrowser n) n
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserNameL"><span class="hs-identifier hs-var">fileBrowserNameL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FileInfo] -&gt; Vector FileInfo
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679374964"><span class="hs-identifier hs-var">matching</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-comment">-- | Generate a textual abbreviation of a file size, e.g. &quot;10.2M&quot; or &quot;12</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- bytes&quot;.</span><span>
</span><span id="line-479"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#prettyFileSize"><span class="hs-identifier hs-type">prettyFileSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-480"></span><span>               </span><span class="hs-comment">-- ^ A file size in bytes.</span><span>
</span><span id="line-481"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-482"></span><span id="prettyFileSize"><span class="annot"><span class="annottext">prettyFileSize :: Int64 -&gt; Text
</span><a href="Brick.Widgets.FileBrowser.html#prettyFileSize"><span class="hs-identifier hs-var hs-var">prettyFileSize</span></a></span></span><span> </span><span id="local-6989586621679374962"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">40</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FilePath
</span><a href="#local-6989586621679374960"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Double -&gt; Double
</span><a href="#local-6989586621679374959"><span class="hs-operator hs-var">`divBy`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">40</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;T&quot;</span></span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">30</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FilePath
</span><a href="#local-6989586621679374960"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Double -&gt; Double
</span><a href="#local-6989586621679374959"><span class="hs-operator hs-var">`divBy`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">30</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;G&quot;</span></span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">20</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FilePath
</span><a href="#local-6989586621679374960"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Double -&gt; Double
</span><a href="#local-6989586621679374959"><span class="hs-operator hs-var">`divBy`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;M&quot;</span></span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">10</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FilePath
</span><a href="#local-6989586621679374960"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Double -&gt; Double
</span><a href="#local-6989586621679374959"><span class="hs-operator hs-var">`divBy`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;K&quot;</span></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; bytes&quot;</span></span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-489"></span><span>        </span><span id="local-6989586621679374960"><span class="annot"><span class="annottext">format :: Double -&gt; FilePath
</span><a href="#local-6989586621679374960"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Double -&gt; FilePath
forall r. PrintfType r =&gt; FilePath -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;%0.1f&quot;</span></span><span>
</span><span id="line-490"></span><span>        </span><span class="annot"><a href="#local-6989586621679374959"><span class="hs-identifier hs-type">divBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-491"></span><span>        </span><span id="local-6989586621679374959"><span class="annot"><span class="annottext">divBy :: Int64 -&gt; Double -&gt; Double
</span><a href="#local-6989586621679374959"><span class="hs-identifier hs-var hs-var">divBy</span></a></span></span><span> </span><span id="local-6989586621679374956"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374956"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679374955"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679374955"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679374956"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679374955"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">-- | Build a list of file info entries for the specified directory. This</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- function does not catch any exceptions raised by calling</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- 'makeAbsolute' or 'listDirectory', but it does catch exceptions on</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- a per-file basis. Any exceptions caught when inspecting individual</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- files are stored in the 'fileInfoFileStatus' field of each</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- 'FileInfo'.</span><span>
</span><span id="line-499"></span><span class="hs-comment">--</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- The entries returned are all entries in the specified directory</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- except for @.@ and @..@. Directories are always given first. Entries</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- are sorted in case-insensitive lexicographic order.</span><span>
</span><span id="line-503"></span><span class="hs-comment">--</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- This function is exported for those who want to implement their own</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- file browser using the types in this module.</span><span>
</span><span id="line-506"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#entriesForDirectory"><span class="hs-identifier hs-type">entriesForDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-507"></span><span id="entriesForDirectory"><span class="annot"><span class="annottext">entriesForDirectory :: FilePath -&gt; IO [FileInfo]
</span><a href="Brick.Widgets.FileBrowser.html#entriesForDirectory"><span class="hs-identifier hs-var hs-var">entriesForDirectory</span></a></span></span><span> </span><span id="local-6989586621679374953"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374953"><span class="hs-identifier hs-var">rawPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-508"></span><span>    </span><span id="local-6989586621679374952"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374952"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.makeAbsolute</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374953"><span class="hs-identifier hs-var">rawPath</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-comment">-- Get all entries except &quot;.&quot; and &quot;..&quot;, then sort them</span><span>
</span><span id="line-511"></span><span>    </span><span id="local-6989586621679374951"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679374951"><span class="hs-identifier hs-var">dirContents</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [FilePath]
</span><span class="hs-identifier hs-var">D.listDirectory</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374952"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621679374949"><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679374949"><span class="hs-identifier hs-var">infos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; (FilePath -&gt; IO FileInfo) -&gt; IO [FileInfo]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679374951"><span class="hs-identifier hs-var">dirContents</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; IO FileInfo) -&gt; IO [FileInfo])
-&gt; (FilePath -&gt; IO FileInfo) -&gt; IO [FileInfo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679374948"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374948"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-514"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#getFileInfo"><span class="hs-identifier hs-var">getFileInfo</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374948"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374952"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
</span><span class="hs-operator hs-var">FP.&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374948"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374946"><span class="annot"><span class="annottext">dirsFirst :: FileInfo -&gt; FileInfo -&gt; Ordering
</span><a href="#local-6989586621679374946"><span class="hs-identifier hs-var hs-var">dirsFirst</span></a></span></span><span> </span><span id="local-6989586621679374945"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374945"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679374944"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374944"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374945"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Maybe FileType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-517"></span><span>                           </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374944"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Maybe FileType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span>
</span><span id="line-518"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374945"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374944"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374945"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Maybe FileType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-521"></span><span>                                </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374944"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Maybe FileType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span>
</span><span id="line-522"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-523"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374944"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Maybe FileType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-524"></span><span>                                     </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374945"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Maybe FileType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span>
</span><span id="line-525"></span><span>                                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-526"></span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374945"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>                                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374944"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span>        </span><span id="local-6989586621679374941"><span class="annot"><span class="annottext">allEntries :: [FileInfo]
</span><a href="#local-6989586621679374941"><span class="hs-identifier hs-var hs-var">allEntries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FileInfo -&gt; FileInfo -&gt; Ordering) -&gt; [FileInfo] -&gt; [FileInfo]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FileInfo -&gt; Ordering
</span><a href="#local-6989586621679374946"><span class="hs-identifier hs-var">dirsFirst</span></a></span><span> </span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679374949"><span class="hs-identifier hs-var">infos</span></a></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><span class="annottext">[FileInfo] -&gt; IO [FileInfo]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[FileInfo]
</span><a href="#local-6989586621679374941"><span class="hs-identifier hs-var">allEntries</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileTypeFromStatus"><span class="hs-identifier hs-type">fileTypeFromStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">U.FileStatus</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileType"><span class="hs-identifier hs-type">FileType</span></a></span><span>
</span><span id="line-534"></span><span id="fileTypeFromStatus"><span class="annot"><span class="annottext">fileTypeFromStatus :: FileStatus -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileTypeFromStatus"><span class="hs-identifier hs-var hs-var">fileTypeFromStatus</span></a></span></span><span> </span><span id="local-6989586621679374940"><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374940"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Bool
</span><span class="hs-identifier hs-var">U.isBlockDevice</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374940"><span class="hs-identifier hs-var">s</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#BlockDevice"><span class="hs-identifier hs-var">BlockDevice</span></a></span><span>
</span><span id="line-536"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Bool
</span><span class="hs-identifier hs-var">U.isCharacterDevice</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374940"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#CharacterDevice"><span class="hs-identifier hs-var">CharacterDevice</span></a></span><span>
</span><span id="line-537"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Bool
</span><span class="hs-identifier hs-var">U.isNamedPipe</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374940"><span class="hs-identifier hs-var">s</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#NamedPipe"><span class="hs-identifier hs-var">NamedPipe</span></a></span><span>
</span><span id="line-538"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Bool
</span><span class="hs-identifier hs-var">U.isRegularFile</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374940"><span class="hs-identifier hs-var">s</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#RegularFile"><span class="hs-identifier hs-var">RegularFile</span></a></span><span>
</span><span id="line-539"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Bool
</span><span class="hs-identifier hs-var">U.isDirectory</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374940"><span class="hs-identifier hs-var">s</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span>
</span><span id="line-540"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Bool
</span><span class="hs-identifier hs-var">U.isSocket</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374940"><span class="hs-identifier hs-var">s</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#UnixSocket"><span class="hs-identifier hs-var">UnixSocket</span></a></span><span>
</span><span id="line-541"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Bool
</span><span class="hs-identifier hs-var">U.isSymbolicLink</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374940"><span class="hs-identifier hs-var">s</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span><span>
</span><span id="line-542"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FileType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-comment">-- | Get the file information for the file under the cursor, if any.</span><span>
</span><span id="line-545"></span><span id="local-6989586621679375221"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserCursor"><span class="hs-identifier hs-type">fileBrowserCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375221"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span></span><span>
</span><span id="line-546"></span><span id="fileBrowserCursor"><span class="annot"><span class="annottext">fileBrowserCursor :: FileBrowser n -&gt; Maybe FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserCursor"><span class="hs-identifier hs-var hs-var">fileBrowserCursor</span></a></span></span><span> </span><span id="local-6989586621679374932"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374932"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, FileInfo) -&gt; FileInfo
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, FileInfo) -&gt; FileInfo)
-&gt; Maybe (Int, FileInfo) -&gt; Maybe FileInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenericList n Vector FileInfo -&gt; Maybe (Int, FileInfo)
forall (t :: * -&gt; *) n e.
(Splittable t, Foldable t) =&gt;
GenericList n t e -&gt; Maybe (Int, e)
</span><a href="Brick.Widgets.List.html#listSelectedElement"><span class="hs-identifier hs-var">listSelectedElement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374932"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting
     (GenericList n Vector FileInfo)
     (FileBrowser n)
     (GenericList n Vector FileInfo)
-&gt; GenericList n Vector FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (GenericList n Vector FileInfo)
  (FileBrowser n)
  (GenericList n Vector FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-comment">-- | Handle a Vty input event. Note that event handling can</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- cause a directory change so the caller should be aware that</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- 'fileBrowserException' may need to be checked after handling an</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- event in case an exception was triggered while scanning the working</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- directory.</span><span>
</span><span id="line-553"></span><span class="hs-comment">--</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- Events handled regardless of mode:</span><span>
</span><span id="line-555"></span><span class="hs-comment">--</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- * @Ctrl-b@: 'actionFileBrowserListPageUp'</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- * @Ctrl-f@: 'actionFileBrowserListPageDown'</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- * @Ctrl-d@: 'actionFileBrowserListHalfPageDown'</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- * @Ctrl-u@: 'actionFileBrowserListHalfPageUp'</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- * @g@: 'actionFileBrowserListTop'</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- * @G@: 'actionFileBrowserListBottom'</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- * @j@: 'actionFileBrowserListNext'</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- * @k@: 'actionFileBrowserListPrev'</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- * @Ctrl-n@: 'actionFileBrowserListNext'</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- * @Ctrl-p@: 'actionFileBrowserListPrev'</span><span>
</span><span id="line-566"></span><span class="hs-comment">--</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- Events handled only in normal mode:</span><span>
</span><span id="line-568"></span><span class="hs-comment">--</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- * @/@: 'actionFileBrowserBeginSearch'</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- * @Enter@: 'actionFileBrowserSelectEnter'</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- * @Space@: 'actionFileBrowserSelectCurrent'</span><span>
</span><span id="line-572"></span><span class="hs-comment">--</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- Events handled only in search mode:</span><span>
</span><span id="line-574"></span><span class="hs-comment">--</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- * @Esc@, @Ctrl-C@: cancel search mode</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- * Text input: update search string</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span id="local-6989586621679374930"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserBeginSearch"><span class="hs-identifier hs-type">actionFileBrowserBeginSearch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374930"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374930"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374930"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-579"></span><span id="actionFileBrowserBeginSearch"><span class="annot"><span class="annottext">actionFileBrowserBeginSearch :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserBeginSearch"><span class="hs-identifier hs-var hs-var">actionFileBrowserBeginSearch</span></a></span></span><span> </span><span id="local-6989586621679374929"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374929"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
forall n.
(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier hs-var">updateFileBrowserSearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text -&gt; Maybe Text
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text -&gt; Maybe Text)
-&gt; Maybe Text -&gt; Maybe Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374929"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span id="local-6989586621679374928"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserSelectEnter"><span class="hs-identifier hs-type">actionFileBrowserSelectEnter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374928"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374928"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374928"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-583"></span><span id="actionFileBrowserSelectEnter"><span class="annot"><span class="annottext">actionFileBrowserSelectEnter :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserSelectEnter"><span class="hs-identifier hs-var hs-var">actionFileBrowserSelectEnter</span></a></span></span><span> </span><span id="local-6989586621679374927"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374927"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-584"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#maybeSelectCurrentEntry"><span class="hs-identifier hs-var">maybeSelectCurrentEntry</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374927"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span id="local-6989586621679374926"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserSelectCurrent"><span class="hs-identifier hs-type">actionFileBrowserSelectCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374926"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374926"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374926"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-587"></span><span id="actionFileBrowserSelectCurrent"><span class="annot"><span class="annottext">actionFileBrowserSelectCurrent :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserSelectCurrent"><span class="hs-identifier hs-var hs-var">actionFileBrowserSelectCurrent</span></a></span></span><span> </span><span id="local-6989586621679374925"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374925"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#selectCurrentEntry"><span class="hs-identifier hs-var">selectCurrentEntry</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374925"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span id="local-6989586621679375230"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPageUp"><span class="hs-identifier hs-type">actionFileBrowserListPageUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375230"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375230"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375230"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375230"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-591"></span><span id="actionFileBrowserListPageUp"><span class="annot"><span class="annottext">actionFileBrowserListPageUp :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPageUp"><span class="hs-identifier hs-var hs-var">actionFileBrowserListPageUp</span></a></span></span><span> </span><span id="local-6989586621679374923"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374923"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374922"><span class="annot"><span class="annottext">old :: List n FileInfo
</span><a href="#local-6989586621679374922"><span class="hs-identifier hs-var hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374923"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (List n FileInfo) (FileBrowser n) (List n FileInfo)
-&gt; List n FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (List n FileInfo) (FileBrowser n) (List n FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621679374921"><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374921"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">List n FileInfo -&gt; EventM n (List n FileInfo)
forall (t :: * -&gt; *) n e.
(Foldable t, Splittable t, Ord n) =&gt;
GenericList n t e -&gt; EventM n (GenericList n t e)
</span><a href="Brick.Widgets.List.html#listMovePageUp"><span class="hs-identifier hs-var">listMovePageUp</span></a></span><span> </span><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374922"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374923"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(List n FileInfo -&gt; Identity (List n FileInfo))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">((List n FileInfo -&gt; Identity (List n FileInfo))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; List n FileInfo -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374921"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span id="local-6989586621679374919"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPageDown"><span class="hs-identifier hs-type">actionFileBrowserListPageDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374919"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374919"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374919"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374919"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-597"></span><span id="actionFileBrowserListPageDown"><span class="annot"><span class="annottext">actionFileBrowserListPageDown :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPageDown"><span class="hs-identifier hs-var hs-var">actionFileBrowserListPageDown</span></a></span></span><span> </span><span id="local-6989586621679374918"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374918"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-598"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374917"><span class="annot"><span class="annottext">old :: List n FileInfo
</span><a href="#local-6989586621679374917"><span class="hs-identifier hs-var hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374918"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (List n FileInfo) (FileBrowser n) (List n FileInfo)
-&gt; List n FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (List n FileInfo) (FileBrowser n) (List n FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span>
</span><span id="line-599"></span><span>    </span><span id="local-6989586621679374916"><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374916"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">List n FileInfo -&gt; EventM n (List n FileInfo)
forall (t :: * -&gt; *) n e.
(Foldable t, Splittable t, Ord n) =&gt;
GenericList n t e -&gt; EventM n (GenericList n t e)
</span><a href="Brick.Widgets.List.html#listMovePageDown"><span class="hs-identifier hs-var">listMovePageDown</span></a></span><span> </span><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374917"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-600"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374918"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(List n FileInfo -&gt; Identity (List n FileInfo))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">((List n FileInfo -&gt; Identity (List n FileInfo))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; List n FileInfo -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374916"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span id="local-6989586621679374914"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListHalfPageUp"><span class="hs-identifier hs-type">actionFileBrowserListHalfPageUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374914"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374914"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374914"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374914"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-603"></span><span id="actionFileBrowserListHalfPageUp"><span class="annot"><span class="annottext">actionFileBrowserListHalfPageUp :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListHalfPageUp"><span class="hs-identifier hs-var hs-var">actionFileBrowserListHalfPageUp</span></a></span></span><span> </span><span id="local-6989586621679374913"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374913"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374912"><span class="annot"><span class="annottext">old :: List n FileInfo
</span><a href="#local-6989586621679374912"><span class="hs-identifier hs-var hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374913"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (List n FileInfo) (FileBrowser n) (List n FileInfo)
-&gt; List n FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (List n FileInfo) (FileBrowser n) (List n FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span>
</span><span id="line-605"></span><span>    </span><span id="local-6989586621679374911"><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374911"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; List n FileInfo -&gt; EventM n (List n FileInfo)
forall (t :: * -&gt; *) n m e.
(Foldable t, Splittable t, Ord n, RealFrac m) =&gt;
m -&gt; GenericList n t e -&gt; EventM n (GenericList n t e)
</span><a href="Brick.Widgets.List.html#listMoveByPages"><span class="hs-identifier hs-var">listMoveByPages</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374912"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374913"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(List n FileInfo -&gt; Identity (List n FileInfo))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">((List n FileInfo -&gt; Identity (List n FileInfo))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; List n FileInfo -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374911"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span id="local-6989586621679374909"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListHalfPageDown"><span class="hs-identifier hs-type">actionFileBrowserListHalfPageDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374909"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374909"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374909"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374909"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-609"></span><span id="actionFileBrowserListHalfPageDown"><span class="annot"><span class="annottext">actionFileBrowserListHalfPageDown :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListHalfPageDown"><span class="hs-identifier hs-var hs-var">actionFileBrowserListHalfPageDown</span></a></span></span><span> </span><span id="local-6989586621679374908"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374908"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-610"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374907"><span class="annot"><span class="annottext">old :: List n FileInfo
</span><a href="#local-6989586621679374907"><span class="hs-identifier hs-var hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374908"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (List n FileInfo) (FileBrowser n) (List n FileInfo)
-&gt; List n FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (List n FileInfo) (FileBrowser n) (List n FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span id="local-6989586621679374906"><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374906"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; List n FileInfo -&gt; EventM n (List n FileInfo)
forall (t :: * -&gt; *) n m e.
(Foldable t, Splittable t, Ord n, RealFrac m) =&gt;
m -&gt; GenericList n t e -&gt; EventM n (GenericList n t e)
</span><a href="Brick.Widgets.List.html#listMoveByPages"><span class="hs-identifier hs-var">listMoveByPages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374907"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374908"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(List n FileInfo -&gt; Identity (List n FileInfo))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">((List n FileInfo -&gt; Identity (List n FileInfo))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; List n FileInfo -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">List n FileInfo
</span><a href="#local-6989586621679374906"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span id="local-6989586621679374905"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListTop"><span class="hs-identifier hs-type">actionFileBrowserListTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374905"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374905"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374905"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374905"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-615"></span><span id="actionFileBrowserListTop"><span class="annot"><span class="annottext">actionFileBrowserListTop :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListTop"><span class="hs-identifier hs-var hs-var">actionFileBrowserListTop</span></a></span></span><span> </span><span id="local-6989586621679374904"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374904"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374904"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(List n FileInfo -&gt; Identity (List n FileInfo))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">((List n FileInfo -&gt; Identity (List n FileInfo))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; (List n FileInfo -&gt; List n FileInfo)
-&gt; FileBrowser n
-&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; List n FileInfo -&gt; List n FileInfo
forall (t :: * -&gt; *) n e.
(Foldable t, Splittable t) =&gt;
Int -&gt; GenericList n t e -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#listMoveTo"><span class="hs-identifier hs-var">listMoveTo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span id="local-6989586621679374901"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListBottom"><span class="hs-identifier hs-type">actionFileBrowserListBottom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374901"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374901"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374901"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374901"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-619"></span><span id="actionFileBrowserListBottom"><span class="annot"><span class="annottext">actionFileBrowserListBottom :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListBottom"><span class="hs-identifier hs-var hs-var">actionFileBrowserListBottom</span></a></span></span><span> </span><span id="local-6989586621679374900"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374900"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374899"><span class="annot"><span class="annottext">sz :: Int
</span><a href="#local-6989586621679374899"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector FileInfo -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericList n Vector FileInfo -&gt; Vector FileInfo
forall n (t :: * -&gt; *) e. GenericList n t e -&gt; t e
</span><a href="Brick.Widgets.List.html#listElements"><span class="hs-identifier hs-var hs-var">listElements</span></a></span><span> </span><span class="annot"><span class="annottext">(GenericList n Vector FileInfo -&gt; Vector FileInfo)
-&gt; GenericList n Vector FileInfo -&gt; Vector FileInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374900"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting
     (GenericList n Vector FileInfo)
     (FileBrowser n)
     (GenericList n Vector FileInfo)
-&gt; GenericList n Vector FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (GenericList n Vector FileInfo)
  (FileBrowser n)
  (GenericList n Vector FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374900"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(GenericList n Vector FileInfo
 -&gt; Identity (GenericList n Vector FileInfo))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">((GenericList n Vector FileInfo
  -&gt; Identity (GenericList n Vector FileInfo))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; (GenericList n Vector FileInfo -&gt; GenericList n Vector FileInfo)
-&gt; FileBrowser n
-&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; GenericList n Vector FileInfo -&gt; GenericList n Vector FileInfo
forall (t :: * -&gt; *) n e.
(Foldable t, Splittable t) =&gt;
Int -&gt; GenericList n t e -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#listMoveTo"><span class="hs-identifier hs-var">listMoveTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679374899"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span id="local-6989586621679374896"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListNext"><span class="hs-identifier hs-type">actionFileBrowserListNext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374896"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374896"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374896"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374896"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-624"></span><span id="actionFileBrowserListNext"><span class="annot"><span class="annottext">actionFileBrowserListNext :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListNext"><span class="hs-identifier hs-var hs-var">actionFileBrowserListNext</span></a></span></span><span> </span><span id="local-6989586621679374895"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374895"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-625"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374895"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(List n FileInfo -&gt; Identity (List n FileInfo))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">((List n FileInfo -&gt; Identity (List n FileInfo))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; (List n FileInfo -&gt; List n FileInfo)
-&gt; FileBrowser n
-&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; List n FileInfo -&gt; List n FileInfo
forall (t :: * -&gt; *) n e.
(Foldable t, Splittable t) =&gt;
Int -&gt; GenericList n t e -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#listMoveBy"><span class="hs-identifier hs-var">listMoveBy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span id="local-6989586621679374893"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPrev"><span class="hs-identifier hs-type">actionFileBrowserListPrev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374893"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374893"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374893"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374893"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-628"></span><span id="actionFileBrowserListPrev"><span class="annot"><span class="annottext">actionFileBrowserListPrev :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPrev"><span class="hs-identifier hs-var hs-var">actionFileBrowserListPrev</span></a></span></span><span> </span><span id="local-6989586621679374892"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374892"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374892"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(List n FileInfo -&gt; Identity (List n FileInfo))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">((List n FileInfo -&gt; Identity (List n FileInfo))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; (List n FileInfo -&gt; List n FileInfo)
-&gt; FileBrowser n
-&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; List n FileInfo -&gt; List n FileInfo
forall (t :: * -&gt; *) n e.
(Foldable t, Splittable t) =&gt;
Int -&gt; GenericList n t e -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#listMoveBy"><span class="hs-identifier hs-var">listMoveBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span id="local-6989586621679374891"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEvent"><span class="hs-identifier hs-type">handleFileBrowserEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374891"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374891"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374891"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374891"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-632"></span><span id="handleFileBrowserEvent"><span class="annot"><span class="annottext">handleFileBrowserEvent :: Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEvent"><span class="hs-identifier hs-var hs-var">handleFileBrowserEvent</span></a></span></span><span> </span><span id="local-6989586621679374890"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374890"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679374889"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374889"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; Bool
forall n. FileBrowser n -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserIsSearching"><span class="hs-identifier hs-var">fileBrowserIsSearching</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374889"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall n.
Ord n =&gt;
Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventSearching"><span class="hs-identifier hs-var">handleFileBrowserEventSearching</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374890"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374889"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall n.
Ord n =&gt;
Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventNormal"><span class="hs-identifier hs-var">handleFileBrowserEventNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374890"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374889"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#safeInit"><span class="hs-identifier hs-type">safeInit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-638"></span><span id="safeInit"><span class="annot"><span class="annottext">safeInit :: Text -&gt; Text
</span><a href="Brick.Widgets.FileBrowser.html#safeInit"><span class="hs-identifier hs-var hs-var">safeInit</span></a></span></span><span> </span><span id="local-6989586621679374885"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374885"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374885"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374885"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-639"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.init</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374885"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span id="local-6989586621679375239"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventSearching"><span class="hs-identifier hs-type">handleFileBrowserEventSearching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375239"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375239"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375239"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375239"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-642"></span><span id="handleFileBrowserEventSearching"><span class="annot"><span class="annottext">handleFileBrowserEventSearching :: Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventSearching"><span class="hs-identifier hs-var hs-var">handleFileBrowserEventSearching</span></a></span></span><span> </span><span id="local-6989586621679374883"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374883"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679374882"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374882"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374883"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-644"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">Vty.MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-645"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
forall n.
(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier hs-var">updateFileBrowserSearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text -&gt; Maybe Text
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374882"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-646"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">Vty.KEsc</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-647"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
forall n.
(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier hs-var">updateFileBrowserSearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text -&gt; Maybe Text
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374882"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-648"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">Vty.KBS</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-649"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
forall n.
(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier hs-var">updateFileBrowserSearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Maybe Text -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Brick.Widgets.FileBrowser.html#safeInit"><span class="hs-identifier hs-var">safeInit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374882"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-650"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">Vty.KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-651"></span><span>            </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
forall n.
(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier hs-var">updateFileBrowserSearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text -&gt; Maybe Text
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; FileBrowser n)
-&gt; EventM n (FileBrowser n) -&gt; EventM n (FileBrowser n)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-652"></span><span>                </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#maybeSelectCurrentEntry"><span class="hs-identifier hs-var">maybeSelectCurrentEntry</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374882"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-653"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span id="local-6989586621679374875"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679374875"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-654"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
forall n.
(Maybe Text -&gt; Maybe Text) -&gt; FileBrowser n -&gt; FileBrowser n
</span><a href="Brick.Widgets.FileBrowser.html#updateFileBrowserSearch"><span class="hs-identifier hs-var">updateFileBrowserSearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Maybe Text -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Char -&gt; Text) -&gt; Char -&gt; Text -&gt; Text
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Char -&gt; Text
</span><span class="hs-identifier hs-var">T.snoc</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679374875"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374882"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-655"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-656"></span><span>            </span><span class="annot"><span class="annottext">Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall n.
Ord n =&gt;
Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventCommon"><span class="hs-identifier hs-var">handleFileBrowserEventCommon</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374883"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374882"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span id="local-6989586621679374871"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventNormal"><span class="hs-identifier hs-type">handleFileBrowserEventNormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374871"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374871"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374871"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374871"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-659"></span><span id="handleFileBrowserEventNormal"><span class="annot"><span class="annottext">handleFileBrowserEventNormal :: Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventNormal"><span class="hs-identifier hs-var hs-var">handleFileBrowserEventNormal</span></a></span></span><span> </span><span id="local-6989586621679374870"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374870"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679374869"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374869"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374870"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-661"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-662"></span><span>            </span><span class="hs-comment">-- Begin file search</span><span>
</span><span id="line-663"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserBeginSearch"><span class="hs-identifier hs-var">actionFileBrowserBeginSearch</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374869"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-664"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">Vty.KEnter</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-665"></span><span>            </span><span class="hs-comment">-- Select file or enter directory</span><span>
</span><span id="line-666"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserSelectEnter"><span class="hs-identifier hs-var">actionFileBrowserSelectEnter</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374869"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-668"></span><span>            </span><span class="hs-comment">-- Select entry</span><span>
</span><span id="line-669"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserSelectCurrent"><span class="hs-identifier hs-var">actionFileBrowserSelectCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374869"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-670"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-671"></span><span>            </span><span class="annot"><span class="annottext">Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall n.
Ord n =&gt;
Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventCommon"><span class="hs-identifier hs-var">handleFileBrowserEventCommon</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374870"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374869"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span id="local-6989586621679374868"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventCommon"><span class="hs-identifier hs-type">handleFileBrowserEventCommon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374868"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vty.Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374868"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374868"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374868"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-674"></span><span id="handleFileBrowserEventCommon"><span class="annot"><span class="annottext">handleFileBrowserEventCommon :: Event -&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#handleFileBrowserEventCommon"><span class="hs-identifier hs-var hs-var">handleFileBrowserEventCommon</span></a></span></span><span> </span><span id="local-6989586621679374867"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374867"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679374866"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374867"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-676"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">Vty.MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-677"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPageUp"><span class="hs-identifier hs-var">actionFileBrowserListPageUp</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-678"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">Vty.MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-679"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPageDown"><span class="hs-identifier hs-var">actionFileBrowserListPageDown</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-680"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'d'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">Vty.MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-681"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListHalfPageDown"><span class="hs-identifier hs-var">actionFileBrowserListHalfPageDown</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-682"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'u'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">Vty.MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-683"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListHalfPageUp"><span class="hs-identifier hs-var">actionFileBrowserListHalfPageUp</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-684"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'g'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-685"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListTop"><span class="hs-identifier hs-var">actionFileBrowserListTop</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-686"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'G'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-687"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListBottom"><span class="hs-identifier hs-var">actionFileBrowserListBottom</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-688"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'j'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-689"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListNext"><span class="hs-identifier hs-var">actionFileBrowserListNext</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-690"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'k'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-691"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPrev"><span class="hs-identifier hs-var">actionFileBrowserListPrev</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-692"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'n'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">Vty.MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-693"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListNext"><span class="hs-identifier hs-var">actionFileBrowserListNext</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-694"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Vty.EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vty.KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'p'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier hs-var">Vty.MCtrl</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-695"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall n. Ord n =&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#actionFileBrowserListPrev"><span class="hs-identifier hs-var">actionFileBrowserListPrev</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-696"></span><span>        </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-697"></span><span>            </span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Lens' (FileBrowser n) (GenericList n Vector FileInfo)
-&gt; (Event
    -&gt; GenericList n Vector FileInfo
    -&gt; EventM n (GenericList n Vector FileInfo))
-&gt; Event
-&gt; EventM n (FileBrowser n)
forall a b e n.
a -&gt; Lens' a b -&gt; (e -&gt; b -&gt; EventM n b) -&gt; e -&gt; EventM n a
</span><a href="Brick.Types.html#handleEventLensed"><span class="hs-identifier hs-var">handleEventLensed</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374866"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. Lens' (FileBrowser n) (List n FileInfo)
Lens' (FileBrowser n) (GenericList n Vector FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span> </span><span class="annot"><span class="annottext">Event
-&gt; GenericList n Vector FileInfo
-&gt; EventM n (GenericList n Vector FileInfo)
forall (t :: * -&gt; *) n e.
(Foldable t, Splittable t, Ord n) =&gt;
Event -&gt; GenericList n t e -&gt; EventM n (GenericList n t e)
</span><a href="Brick.Widgets.List.html#handleListEvent"><span class="hs-identifier hs-var">handleListEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679374867"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-comment">-- | If the browser's current entry is selectable according to</span><span>
</span><span id="line-700"></span><span class="hs-comment">-- @fileBrowserSelectable@, add it to the selection set and return.</span><span>
</span><span id="line-701"></span><span class="hs-comment">-- If not, and if the entry is a directory or a symlink targeting a</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- directory, set the browser's current path to the selected directory.</span><span>
</span><span id="line-703"></span><span class="hs-comment">--</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- Otherwise, return the browser state unchanged.</span><span>
</span><span id="line-705"></span><span id="local-6989586621679375271"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#maybeSelectCurrentEntry"><span class="hs-identifier hs-type">maybeSelectCurrentEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375271"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375271"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375271"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-706"></span><span id="maybeSelectCurrentEntry"><span class="annot"><span class="annottext">maybeSelectCurrentEntry :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#maybeSelectCurrentEntry"><span class="hs-identifier hs-var hs-var">maybeSelectCurrentEntry</span></a></span></span><span> </span><span id="local-6989586621679374863"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-707"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; Maybe FileInfo
forall n. FileBrowser n -&gt; Maybe FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserCursor"><span class="hs-identifier hs-var">fileBrowserCursor</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-708"></span><span>        </span><span class="annot"><span class="annottext">Maybe FileInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-709"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679374862"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374862"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-710"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; FileInfo -&gt; Bool
forall n. FileBrowser n -&gt; FileInfo -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectable"><span class="hs-identifier hs-var hs-var">fileBrowserSelectable</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374862"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-711"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Set FilePath -&gt; Identity (Set FilePath))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (Set FilePath)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedFilesL"><span class="hs-identifier hs-var">fileBrowserSelectedFilesL</span></a></span><span> </span><span class="annot"><span class="annottext">((Set FilePath -&gt; Identity (Set FilePath))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; (Set FilePath -&gt; Set FilePath) -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Set FilePath -&gt; Set FilePath
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374862"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374862"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-713"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-714"></span><span>                    </span><span class="annot"><span class="annottext">IO (FileBrowser n) -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (FileBrowser n) -&gt; EventM n (FileBrowser n))
-&gt; IO (FileBrowser n) -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FileBrowser n -&gt; IO (FileBrowser n)
forall n. FilePath -&gt; FileBrowser n -&gt; IO (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#setWorkingDirectory"><span class="hs-identifier hs-var">setWorkingDirectory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilePath"><span class="hs-identifier hs-var hs-var">fileInfoFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374862"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-715"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-716"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoLinkTargetType"><span class="hs-identifier hs-var hs-var">fileInfoLinkTargetType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374862"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-717"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-718"></span><span>                            </span><span class="annot"><span class="annottext">IO (FileBrowser n) -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (FileBrowser n) -&gt; EventM n (FileBrowser n))
-&gt; IO (FileBrowser n) -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FileBrowser n -&gt; IO (FileBrowser n)
forall n. FilePath -&gt; FileBrowser n -&gt; IO (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#setWorkingDirectory"><span class="hs-identifier hs-var">setWorkingDirectory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilePath"><span class="hs-identifier hs-var hs-var">fileInfoFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374862"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-719"></span><span>                        </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-720"></span><span>                            </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-721"></span><span>                </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-722"></span><span>                    </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374863"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span id="local-6989586621679374860"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#selectCurrentEntry"><span class="hs-identifier hs-type">selectCurrentEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374860"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374860"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374860"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-725"></span><span id="selectCurrentEntry"><span class="annot"><span class="annottext">selectCurrentEntry :: FileBrowser n -&gt; EventM n (FileBrowser n)
</span><a href="Brick.Widgets.FileBrowser.html#selectCurrentEntry"><span class="hs-identifier hs-var hs-var">selectCurrentEntry</span></a></span></span><span> </span><span id="local-6989586621679374859"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374859"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-726"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; Maybe FileInfo
forall n. FileBrowser n -&gt; Maybe FileInfo
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserCursor"><span class="hs-identifier hs-var">fileBrowserCursor</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374859"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-727"></span><span>        </span><span class="annot"><span class="annottext">Maybe FileInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374859"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-728"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679374858"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374858"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; EventM n (FileBrowser n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FileBrowser n -&gt; EventM n (FileBrowser n))
-&gt; FileBrowser n -&gt; EventM n (FileBrowser n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374859"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; (FileBrowser n -&gt; FileBrowser n) -&gt; FileBrowser n
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Set FilePath -&gt; Identity (Set FilePath))
-&gt; FileBrowser n -&gt; Identity (FileBrowser n)
forall n. Lens' (FileBrowser n) (Set FilePath)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedFilesL"><span class="hs-identifier hs-var">fileBrowserSelectedFilesL</span></a></span><span> </span><span class="annot"><span class="annottext">((Set FilePath -&gt; Identity (Set FilePath))
 -&gt; FileBrowser n -&gt; Identity (FileBrowser n))
-&gt; (Set FilePath -&gt; Set FilePath) -&gt; FileBrowser n -&gt; FileBrowser n
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Set FilePath -&gt; Set FilePath
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374858"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>
</span><span id="line-730"></span><span class="hs-comment">-- | Render a file browser. This renders a list of entries in the</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- working directory, a cursor to select from among the entries, a</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- header displaying the working directory, and a footer displaying</span><span>
</span><span id="line-733"></span><span class="hs-comment">-- information about the selected entry.</span><span>
</span><span id="line-734"></span><span class="hs-comment">--</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- Note that if the most recent file browser operation produced an</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- exception in 'fileBrowserException', that exception is not rendered</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- by this function. That exception needs to be rendered (if at all) by</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- the calling application.</span><span>
</span><span id="line-739"></span><span class="hs-comment">--</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- The file browser is greedy in both dimensions.</span><span>
</span><span id="line-741"></span><span id="local-6989586621679374857"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#renderFileBrowser"><span class="hs-identifier hs-type">renderFileBrowser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679374857"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679374857"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-742"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-743"></span><span>                  </span><span class="hs-comment">-- ^ Whether the file browser has input focus.</span><span>
</span><span id="line-744"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileBrowser"><span class="hs-identifier hs-type">FileBrowser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374857"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-745"></span><span>                  </span><span class="hs-comment">-- ^ The browser to render.</span><span>
</span><span id="line-746"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679374857"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-747"></span><span id="renderFileBrowser"><span class="annot"><span class="annottext">renderFileBrowser :: Bool -&gt; FileBrowser n -&gt; Widget n
</span><a href="Brick.Widgets.FileBrowser.html#renderFileBrowser"><span class="hs-identifier hs-var hs-var">renderFileBrowser</span></a></span></span><span> </span><span id="local-6989586621679374856"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374856"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679374855"><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-748"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374854"><span class="annot"><span class="annottext">maxFilenameLength :: Int
</span><a href="#local-6989586621679374854"><span class="hs-identifier hs-var hs-var">maxFilenameLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericList n Vector Int -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">(GenericList n Vector Int -&gt; Int)
-&gt; GenericList n Vector Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Int) -&gt; (FileInfo -&gt; FilePath) -&gt; FileInfo -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FileInfo -&gt; Int)
-&gt; GenericList n Vector FileInfo -&gt; GenericList n Vector Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting
     (GenericList n Vector FileInfo)
     (FileBrowser n)
     (GenericList n Vector FileInfo)
-&gt; GenericList n Vector FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (GenericList n Vector FileInfo)
  (FileBrowser n)
  (GenericList n Vector FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>        </span><span id="local-6989586621679374852"><span class="annot"><span class="annottext">cwdHeader :: Widget n
</span><a href="#local-6989586621679374852"><span class="hs-identifier hs-var hs-var">cwdHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Padding -&gt; Widget n -&gt; Widget n
forall n. Padding -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#padRight"><span class="hs-identifier hs-var">padRight</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="Brick.Types.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-750"></span><span>                    </span><span class="annot"><span class="annottext">FilePath -&gt; Widget n
forall n. FilePath -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#str"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Widget n) -&gt; FilePath -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Brick.Widgets.FileBrowser.html#sanitizeFilename"><span class="hs-identifier hs-var">sanitizeFilename</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileBrowser n -&gt; FilePath
forall n. FileBrowser n -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserWorkingDirectory"><span class="hs-identifier hs-var hs-var">fileBrowserWorkingDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-751"></span><span>        </span><span id="local-6989586621679374848"><span class="annot"><span class="annottext">selInfo :: Widget n
</span><a href="#local-6989586621679374848"><span class="hs-identifier hs-var hs-var">selInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenericList n Vector FileInfo -&gt; Maybe (Int, FileInfo)
forall (t :: * -&gt; *) n e.
(Splittable t, Foldable t) =&gt;
GenericList n t e -&gt; Maybe (Int, e)
</span><a href="Brick.Widgets.List.html#listSelectedElement"><span class="hs-identifier hs-var">listSelectedElement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting
     (GenericList n Vector FileInfo)
     (FileBrowser n)
     (GenericList n Vector FileInfo)
-&gt; GenericList n Vector FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (GenericList n Vector FileInfo)
  (FileBrowser n)
  (GenericList n Vector FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-752"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Int, FileInfo)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Widget n -&gt; Widget n
forall n. Int -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#vLimit"><span class="hs-identifier hs-var">vLimit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Widget n
forall n. Char -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#fill"><span class="hs-identifier hs-var">fill</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-753"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679374845"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374845"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Padding -&gt; Widget n -&gt; Widget n
forall n. Padding -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#padRight"><span class="hs-identifier hs-var">padRight</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="Brick.Types.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Widget n
forall n. FileInfo -&gt; Widget n
</span><a href="#local-6989586621679374844"><span class="hs-identifier hs-var">selInfoFor</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374845"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-754"></span><span>        </span><span id="local-6989586621679374843"><span class="annot"><span class="annottext">fileTypeLabel :: Maybe FileType -&gt; p
</span><a href="#local-6989586621679374843"><span class="hs-identifier hs-var hs-var">fileTypeLabel</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;unknown&quot;</span></span><span>
</span><span id="line-755"></span><span>        </span><span class="annot"><a href="#local-6989586621679374843"><span class="hs-identifier hs-var">fileTypeLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679374842"><span class="annot"><span class="annottext">FileType
</span><a href="#local-6989586621679374842"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-756"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="#local-6989586621679374842"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-757"></span><span>                </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#RegularFile"><span class="hs-identifier hs-var">RegularFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;file&quot;</span></span><span>
</span><span id="line-758"></span><span>                </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#BlockDevice"><span class="hs-identifier hs-var">BlockDevice</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;block device&quot;</span></span><span>
</span><span id="line-759"></span><span>                </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#CharacterDevice"><span class="hs-identifier hs-var">CharacterDevice</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;character device&quot;</span></span><span>
</span><span id="line-760"></span><span>                </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#NamedPipe"><span class="hs-identifier hs-var">NamedPipe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;pipe&quot;</span></span><span>
</span><span id="line-761"></span><span>                </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;directory&quot;</span></span><span>
</span><span id="line-762"></span><span>                </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;symbolic link&quot;</span></span><span>
</span><span id="line-763"></span><span>                </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#UnixSocket"><span class="hs-identifier hs-var">UnixSocket</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;socket&quot;</span></span><span>
</span><span id="line-764"></span><span>        </span><span id="local-6989586621679374844"><span class="annot"><span class="annottext">selInfoFor :: FileInfo -&gt; Widget n
</span><a href="#local-6989586621679374844"><span class="hs-identifier hs-var hs-var">selInfoFor</span></a></span></span><span> </span><span id="local-6989586621679374841"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374841"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-765"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374840"><span class="annot"><span class="annottext">label :: Text
</span><a href="#local-6989586621679374840"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Either IOException FileStatus
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileStatus"><span class="hs-identifier hs-var hs-var">fileInfoFileStatus</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374841"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-766"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;unknown&quot;</span></span><span>
</span><span id="line-767"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679374839"><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374839"><span class="hs-identifier hs-var">stat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-768"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679374838"><span class="annot"><span class="annottext">maybeSize :: Text
</span><a href="#local-6989586621679374838"><span class="hs-identifier hs-var hs-var">maybeSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusFileType"><span class="hs-identifier hs-var hs-var">fileStatusFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374839"><span class="hs-identifier hs-var">stat</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Maybe FileType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#RegularFile"><span class="hs-identifier hs-var">RegularFile</span></a></span><span>
</span><span id="line-769"></span><span>                                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text
</span><a href="Brick.Widgets.FileBrowser.html#prettyFileSize"><span class="hs-identifier hs-var">prettyFileSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileStatus -&gt; Int64
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusSize"><span class="hs-identifier hs-var hs-var">fileStatusSize</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374839"><span class="hs-identifier hs-var">stat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>                                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-771"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Text
forall p. IsString p =&gt; Maybe FileType -&gt; p
</span><a href="#local-6989586621679374843"><span class="hs-identifier hs-var">fileTypeLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileStatus -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileStatusFileType"><span class="hs-identifier hs-var hs-var">fileStatusFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679374839"><span class="hs-identifier hs-var">stat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374838"><span class="hs-identifier hs-var">maybeSize</span></a></span><span>
</span><span id="line-772"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Widget n) -&gt; Text -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoSanitizedFilename"><span class="hs-identifier hs-var hs-var">fileInfoSanitizedFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374841"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374840"><span class="hs-keyword hs-var">label</span></a></span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span>        </span><span id="local-6989586621679374836"><span class="annot"><span class="annottext">maybeSearchInfo :: Widget n
</span><a href="#local-6989586621679374836"><span class="hs-identifier hs-var hs-var">maybeSearchInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (Maybe Text) (FileBrowser n) (Maybe Text) -&gt; Maybe Text
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Text) (FileBrowser n) (Maybe Text)
forall n. Lens' (FileBrowser n) (Maybe Text)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSearchStringL"><span class="hs-identifier hs-var">fileBrowserSearchStringL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-775"></span><span>            </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Widget n
forall n. Widget n
</span><a href="Brick.Widgets.Core.html#emptyWidget"><span class="hs-identifier hs-var">emptyWidget</span></a></span><span>
</span><span id="line-776"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679374834"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374834"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Padding -&gt; Widget n -&gt; Widget n
forall n. Padding -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#padRight"><span class="hs-identifier hs-var">padRight</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="Brick.Types.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-777"></span><span>                      </span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Search: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n -&gt; Widget n
forall n. Widget n -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-778"></span><span>                      </span><span class="annot"><span class="annottext">n -&gt; Location -&gt; Widget n -&gt; Widget n
forall n. n -&gt; Location -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#showCursor"><span class="hs-identifier hs-var">showCursor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n -&gt; Getting n (FileBrowser n) n -&gt; n
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting n (FileBrowser n) n
forall n. Lens' (FileBrowser n) n
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserNameL"><span class="hs-identifier hs-var">fileBrowserNameL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Location
</span><a href="Brick.Types.Common.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374834"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679374834"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#withDefAttr"><span class="hs-identifier hs-var">withDefAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-781"></span><span>       </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
forall n. [Widget n] -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#vBox"><span class="hs-identifier hs-var">vBox</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#withDefAttr"><span class="hs-identifier hs-var">withDefAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserCurrentDirectoryAttr"><span class="hs-identifier hs-var">fileBrowserCurrentDirectoryAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Widget n
forall n. Widget n
</span><a href="#local-6989586621679374852"><span class="hs-identifier hs-var">cwdHeader</span></a></span><span>
</span><span id="line-782"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; FileInfo -&gt; Widget n)
-&gt; Bool -&gt; GenericList n Vector FileInfo -&gt; Widget n
forall (t :: * -&gt; *) n e.
(Traversable t, Splittable t, Ord n, Show n) =&gt;
(Bool -&gt; e -&gt; Widget n) -&gt; Bool -&gt; GenericList n t e -&gt; Widget n
</span><a href="Brick.Widgets.List.html#renderList"><span class="hs-identifier hs-var">renderList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Set FilePath -&gt; n -&gt; Bool -&gt; FileInfo -&gt; Widget n
forall n.
Bool -&gt; Int -&gt; Set FilePath -&gt; n -&gt; Bool -&gt; FileInfo -&gt; Widget n
</span><a href="Brick.Widgets.FileBrowser.html#renderFileInfo"><span class="hs-identifier hs-var">renderFileInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374856"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679374854"><span class="hs-identifier hs-var">maxFilenameLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting (Set FilePath) (FileBrowser n) (Set FilePath)
-&gt; Set FilePath
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Set FilePath) (FileBrowser n) (Set FilePath)
forall n. Lens' (FileBrowser n) (Set FilePath)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedFilesL"><span class="hs-identifier hs-var">fileBrowserSelectedFilesL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n -&gt; Getting n (FileBrowser n) n -&gt; n
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting n (FileBrowser n) n
forall n. Lens' (FileBrowser n) n
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserNameL"><span class="hs-identifier hs-var">fileBrowserNameL</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>                         </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374856"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileBrowser n
</span><a href="#local-6989586621679374855"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">FileBrowser n
-&gt; Getting
     (GenericList n Vector FileInfo)
     (FileBrowser n)
     (GenericList n Vector FileInfo)
-&gt; GenericList n Vector FileInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (GenericList n Vector FileInfo)
  (FileBrowser n)
  (GenericList n Vector FileInfo)
forall n. Lens' (FileBrowser n) (List n FileInfo)
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserEntriesL"><span class="hs-identifier hs-var">fileBrowserEntriesL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Widget n
</span><a href="#local-6989586621679374836"><span class="hs-identifier hs-var">maybeSearchInfo</span></a></span><span>
</span><span id="line-785"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#withDefAttr"><span class="hs-identifier hs-var">withDefAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectionInfoAttr"><span class="hs-identifier hs-var">fileBrowserSelectionInfoAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Widget n
forall n. Widget n
</span><a href="#local-6989586621679374848"><span class="hs-identifier hs-var">selInfo</span></a></span><span>
</span><span id="line-786"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span id="local-6989586621679375195"><span class="annot"><a href="Brick.Widgets.FileBrowser.html#renderFileInfo"><span class="hs-identifier hs-type">renderFileInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375195"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375195"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-789"></span><span id="renderFileInfo"><span class="annot"><span class="annottext">renderFileInfo :: Bool -&gt; Int -&gt; Set FilePath -&gt; n -&gt; Bool -&gt; FileInfo -&gt; Widget n
</span><a href="Brick.Widgets.FileBrowser.html#renderFileInfo"><span class="hs-identifier hs-var hs-var">renderFileInfo</span></a></span></span><span> </span><span id="local-6989586621679374826"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374826"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679374825"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679374825"><span class="hs-identifier hs-var">maxLen</span></a></span></span><span> </span><span id="local-6989586621679374824"><span class="annot"><span class="annottext">Set FilePath
</span><a href="#local-6989586621679374824"><span class="hs-identifier hs-var">selFiles</span></a></span></span><span> </span><span id="local-6989586621679374823"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679374823"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679374822"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374822"><span class="hs-identifier hs-var">listSel</span></a></span></span><span> </span><span id="local-6989586621679374821"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374821"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-790"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374826"><span class="hs-identifier hs-var">foc</span></a></span><span>
</span><span id="line-791"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374822"><span class="hs-identifier hs-var">listSel</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#forceAttr"><span class="hs-identifier hs-var">forceAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.List.html#listSelectedFocusedAttr"><span class="hs-identifier hs-var">listSelectedFocusedAttr</span></a></span><span>
</span><span id="line-792"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374818"><span class="hs-identifier hs-var">sel</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#forceAttr"><span class="hs-identifier hs-var">forceAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedAttr"><span class="hs-identifier hs-var">fileBrowserSelectedAttr</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374822"><span class="hs-identifier hs-var">listSel</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#forceAttr"><span class="hs-identifier hs-var">forceAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.List.html#listSelectedAttr"><span class="hs-identifier hs-var">listSelectedAttr</span></a></span><span>
</span><span id="line-794"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374818"><span class="hs-identifier hs-var">sel</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#forceAttr"><span class="hs-identifier hs-var">forceAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedAttr"><span class="hs-identifier hs-var">fileBrowserSelectedAttr</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-795"></span><span>    </span><span class="annot"><span class="annottext">Padding -&gt; Widget n -&gt; Widget n
forall n. Padding -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#padRight"><span class="hs-identifier hs-var">padRight</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="Brick.Types.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Widget n
</span><a href="#local-6989586621679374815"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-796"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-797"></span><span>        </span><span id="local-6989586621679374818"><span class="annot"><span class="annottext">sel :: Bool
</span><a href="#local-6989586621679374818"><span class="hs-identifier hs-var hs-var">sel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374821"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Set FilePath -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set FilePath
</span><a href="#local-6989586621679374824"><span class="hs-identifier hs-var">selFiles</span></a></span><span>
</span><span id="line-798"></span><span>        </span><span id="local-6989586621679374813"><span class="annot"><span class="annottext">addAttr :: Widget n -&gt; Widget n
</span><a href="#local-6989586621679374813"><span class="hs-identifier hs-var hs-var">addAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n)
-&gt; (FileType -&gt; Widget n -&gt; Widget n)
-&gt; Maybe FileType
-&gt; Widget n
-&gt; Widget n
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#withDefAttr"><span class="hs-identifier hs-var">withDefAttr</span></a></span><span> </span><span class="annot"><span class="annottext">(AttrName -&gt; Widget n -&gt; Widget n)
-&gt; (FileType -&gt; AttrName) -&gt; FileType -&gt; Widget n -&gt; Widget n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; AttrName
</span><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-var">attrForFileType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374821"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>        </span><span id="local-6989586621679374815"><span class="annot"><span class="annottext">body :: Widget n
</span><a href="#local-6989586621679374815"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall n. Widget n -&gt; Widget n
</span><a href="#local-6989586621679374813"><span class="hs-identifier hs-var">addAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Widget n -&gt; Widget n
forall n. Int -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#hLimit"><span class="hs-identifier hs-var">hLimit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679374825"><span class="hs-identifier hs-var">maxLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-800"></span><span>               </span><span class="annot"><span class="annottext">Padding -&gt; Widget n -&gt; Widget n
forall n. Padding -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#padRight"><span class="hs-identifier hs-var">padRight</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="Brick.Types.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-801"></span><span>               </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374826"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374822"><span class="hs-identifier hs-var">listSel</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">n -&gt; Location -&gt; Widget n -&gt; Widget n
forall n. n -&gt; Location -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#showCursor"><span class="hs-identifier hs-var">showCursor</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679374823"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Location
</span><a href="Brick.Types.Common.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-802"></span><span>               </span><span class="annot"><span class="annottext">FilePath -&gt; Widget n
forall n. FilePath -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#str"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Widget n) -&gt; FilePath -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoSanitizedFilename"><span class="hs-identifier hs-var hs-var">fileInfoSanitizedFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374821"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374809"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>        </span><span id="local-6989586621679374809"><span class="annot"><span class="annottext">suffix :: FilePath
</span><a href="#local-6989586621679374809"><span class="hs-identifier hs-var hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374821"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FileType -&gt; Maybe FileType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FileType -&gt; Maybe FileType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-804"></span><span>                 </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679374818"><span class="hs-identifier hs-var">sel</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span class="hs-comment">-- | Sanitize a filename for terminal display, replacing non-printable</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- characters with '?'.</span><span>
</span><span id="line-808"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#sanitizeFilename"><span class="hs-identifier hs-type">sanitizeFilename</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-809"></span><span id="sanitizeFilename"><span class="annot"><span class="annottext">sanitizeFilename :: ShowS
</span><a href="Brick.Widgets.FileBrowser.html#sanitizeFilename"><span class="hs-identifier hs-var hs-var">sanitizeFilename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><a href="#local-6989586621679374808"><span class="hs-identifier hs-var">toPrint</span></a></span><span>
</span><span id="line-810"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-811"></span><span>        </span><span id="local-6989586621679374808"><span class="annot"><span class="annottext">toPrint :: Char -&gt; Char
</span><a href="#local-6989586621679374808"><span class="hs-identifier hs-var hs-var">toPrint</span></a></span></span><span> </span><span id="local-6989586621679374807"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679374807"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPrint</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679374807"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679374807"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-812"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-type">attrForFileType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileType"><span class="hs-identifier hs-type">FileType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-815"></span><span id="attrForFileType"><span class="annot"><span class="annottext">attrForFileType :: FileType -&gt; AttrName
</span><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-var hs-var">attrForFileType</span></a></span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#RegularFile"><span class="hs-identifier hs-var">RegularFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserRegularFileAttr"><span class="hs-identifier hs-var">fileBrowserRegularFileAttr</span></a></span><span>
</span><span id="line-816"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-var">attrForFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#BlockDevice"><span class="hs-identifier hs-var">BlockDevice</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserBlockDeviceAttr"><span class="hs-identifier hs-var">fileBrowserBlockDeviceAttr</span></a></span><span>
</span><span id="line-817"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-var">attrForFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#CharacterDevice"><span class="hs-identifier hs-var">CharacterDevice</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserCharacterDeviceAttr"><span class="hs-identifier hs-var">fileBrowserCharacterDeviceAttr</span></a></span><span>
</span><span id="line-818"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-var">attrForFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#NamedPipe"><span class="hs-identifier hs-var">NamedPipe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserNamedPipeAttr"><span class="hs-identifier hs-var">fileBrowserNamedPipeAttr</span></a></span><span>
</span><span id="line-819"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-var">attrForFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserDirectoryAttr"><span class="hs-identifier hs-var">fileBrowserDirectoryAttr</span></a></span><span>
</span><span id="line-820"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-var">attrForFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSymbolicLinkAttr"><span class="hs-identifier hs-var">fileBrowserSymbolicLinkAttr</span></a></span><span>
</span><span id="line-821"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#attrForFileType"><span class="hs-identifier hs-var">attrForFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#UnixSocket"><span class="hs-identifier hs-var">UnixSocket</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserUnixSocketAttr"><span class="hs-identifier hs-var">fileBrowserUnixSocketAttr</span></a></span><span>
</span><span id="line-822"></span><span>
</span><span id="line-823"></span><span class="hs-comment">-- | The base attribute for all file browser attributes.</span><span>
</span><span id="line-824"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-type">fileBrowserAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-825"></span><span id="fileBrowserAttr"><span class="annot"><span class="annottext">fileBrowserAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var hs-var">fileBrowserAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;fileBrowser&quot;</span></span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span class="hs-comment">-- | The attribute used for the current directory displayed at the top</span><span>
</span><span id="line-828"></span><span class="hs-comment">-- of the browser.</span><span>
</span><span id="line-829"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserCurrentDirectoryAttr"><span class="hs-identifier hs-type">fileBrowserCurrentDirectoryAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-830"></span><span id="fileBrowserCurrentDirectoryAttr"><span class="annot"><span class="annottext">fileBrowserCurrentDirectoryAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserCurrentDirectoryAttr"><span class="hs-identifier hs-var hs-var">fileBrowserCurrentDirectoryAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;currentDirectory&quot;</span></span><span>
</span><span id="line-831"></span><span>
</span><span id="line-832"></span><span class="hs-comment">-- | The attribute used for the entry information displayed at the</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- bottom of the browser.</span><span>
</span><span id="line-834"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectionInfoAttr"><span class="hs-identifier hs-type">fileBrowserSelectionInfoAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-835"></span><span id="fileBrowserSelectionInfoAttr"><span class="annot"><span class="annottext">fileBrowserSelectionInfoAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectionInfoAttr"><span class="hs-identifier hs-var hs-var">fileBrowserSelectionInfoAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;selectionInfo&quot;</span></span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="hs-comment">-- | The attribute used to render directory entries.</span><span>
</span><span id="line-838"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserDirectoryAttr"><span class="hs-identifier hs-type">fileBrowserDirectoryAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-839"></span><span id="fileBrowserDirectoryAttr"><span class="annot"><span class="annottext">fileBrowserDirectoryAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserDirectoryAttr"><span class="hs-identifier hs-var hs-var">fileBrowserDirectoryAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;directory&quot;</span></span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span class="hs-comment">-- | The attribute used to render block device entries.</span><span>
</span><span id="line-842"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserBlockDeviceAttr"><span class="hs-identifier hs-type">fileBrowserBlockDeviceAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-843"></span><span id="fileBrowserBlockDeviceAttr"><span class="annot"><span class="annottext">fileBrowserBlockDeviceAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserBlockDeviceAttr"><span class="hs-identifier hs-var hs-var">fileBrowserBlockDeviceAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;block&quot;</span></span><span>
</span><span id="line-844"></span><span>
</span><span id="line-845"></span><span class="hs-comment">-- | The attribute used to render regular file entries.</span><span>
</span><span id="line-846"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserRegularFileAttr"><span class="hs-identifier hs-type">fileBrowserRegularFileAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-847"></span><span id="fileBrowserRegularFileAttr"><span class="annot"><span class="annottext">fileBrowserRegularFileAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserRegularFileAttr"><span class="hs-identifier hs-var hs-var">fileBrowserRegularFileAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;regular&quot;</span></span><span>
</span><span id="line-848"></span><span>
</span><span id="line-849"></span><span class="hs-comment">-- | The attribute used to render character device entries.</span><span>
</span><span id="line-850"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserCharacterDeviceAttr"><span class="hs-identifier hs-type">fileBrowserCharacterDeviceAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-851"></span><span id="fileBrowserCharacterDeviceAttr"><span class="annot"><span class="annottext">fileBrowserCharacterDeviceAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserCharacterDeviceAttr"><span class="hs-identifier hs-var hs-var">fileBrowserCharacterDeviceAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;char&quot;</span></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span class="hs-comment">-- | The attribute used to render named pipe entries.</span><span>
</span><span id="line-854"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserNamedPipeAttr"><span class="hs-identifier hs-type">fileBrowserNamedPipeAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-855"></span><span id="fileBrowserNamedPipeAttr"><span class="annot"><span class="annottext">fileBrowserNamedPipeAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserNamedPipeAttr"><span class="hs-identifier hs-var hs-var">fileBrowserNamedPipeAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;pipe&quot;</span></span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span class="hs-comment">-- | The attribute used to render symbolic link entries.</span><span>
</span><span id="line-858"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSymbolicLinkAttr"><span class="hs-identifier hs-type">fileBrowserSymbolicLinkAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-859"></span><span id="fileBrowserSymbolicLinkAttr"><span class="annot"><span class="annottext">fileBrowserSymbolicLinkAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSymbolicLinkAttr"><span class="hs-identifier hs-var hs-var">fileBrowserSymbolicLinkAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;symlink&quot;</span></span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span class="hs-comment">-- | The attribute used to render Unix socket entries.</span><span>
</span><span id="line-862"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserUnixSocketAttr"><span class="hs-identifier hs-type">fileBrowserUnixSocketAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-863"></span><span id="fileBrowserUnixSocketAttr"><span class="annot"><span class="annottext">fileBrowserUnixSocketAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserUnixSocketAttr"><span class="hs-identifier hs-var hs-var">fileBrowserUnixSocketAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;unixSocket&quot;</span></span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span class="hs-comment">-- | The attribute used for selected entries in the file browser.</span><span>
</span><span id="line-866"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedAttr"><span class="hs-identifier hs-type">fileBrowserSelectedAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-867"></span><span id="fileBrowserSelectedAttr"><span class="annot"><span class="annottext">fileBrowserSelectedAttr :: AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserSelectedAttr"><span class="hs-identifier hs-var hs-var">fileBrowserSelectedAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Widgets.FileBrowser.html#fileBrowserAttr"><span class="hs-identifier hs-var">fileBrowserAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;selected&quot;</span></span><span>
</span><span id="line-868"></span><span>
</span><span id="line-869"></span><span class="hs-comment">-- | A file type filter for use with 'setFileBrowserEntryFilter'. This</span><span>
</span><span id="line-870"></span><span class="hs-comment">-- filter permits entries whose file types are in the specified list.</span><span>
</span><span id="line-871"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileTypeMatch"><span class="hs-identifier hs-type">fileTypeMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileType"><span class="hs-identifier hs-type">FileType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-872"></span><span id="fileTypeMatch"><span class="annot"><span class="annottext">fileTypeMatch :: [FileType] -&gt; FileInfo -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#fileTypeMatch"><span class="hs-identifier hs-var hs-var">fileTypeMatch</span></a></span></span><span> </span><span id="local-6989586621679374806"><span class="annot"><span class="annottext">[FileType]
</span><a href="#local-6989586621679374806"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621679374805"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374805"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (FileType -&gt; Bool) -&gt; Maybe FileType -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileType -&gt; [FileType] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[FileType]
</span><a href="#local-6989586621679374806"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe FileType -&gt; Bool) -&gt; Maybe FileType -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374805"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-873"></span><span>
</span><span id="line-874"></span><span class="hs-comment">-- | A filter that matches any directory regardless of name, or any</span><span>
</span><span id="line-875"></span><span class="hs-comment">-- regular file with the specified extension. For example, an extension</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- argument of @&quot;xml&quot;@ would match regular files @test.xml@ and</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- @TEST.XML@ and it will match directories regardless of name.</span><span>
</span><span id="line-878"></span><span class="hs-comment">--</span><span>
</span><span id="line-879"></span><span class="hs-comment">-- This matcher also matches symlinks if and only if their targets are</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- directories. This is intended to make it possible to use this matcher</span><span>
</span><span id="line-881"></span><span class="hs-comment">-- to find files with certain extensions, but also support directory</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- traversal via symlinks.</span><span>
</span><span id="line-883"></span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#fileExtensionMatch"><span class="hs-identifier hs-type">fileExtensionMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Widgets.FileBrowser.html#FileInfo"><span class="hs-identifier hs-type">FileInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-884"></span><span id="fileExtensionMatch"><span class="annot"><span class="annottext">fileExtensionMatch :: FilePath -&gt; FileInfo -&gt; Bool
</span><a href="Brick.Widgets.FileBrowser.html#fileExtensionMatch"><span class="hs-identifier hs-var hs-var">fileExtensionMatch</span></a></span></span><span> </span><span id="local-6989586621679374804"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374804"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span id="local-6989586621679374803"><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374803"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFileType"><span class="hs-identifier hs-var">fileInfoFileType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374803"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-885"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-886"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#RegularFile"><span class="hs-identifier hs-var">RegularFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679374804"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isSuffixOf`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; FilePath
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoFilename"><span class="hs-identifier hs-var hs-var">fileInfoFilename</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374803"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#SymbolicLink"><span class="hs-identifier hs-var">SymbolicLink</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FileInfo -&gt; Maybe FileType
</span><a href="Brick.Widgets.FileBrowser.html#fileInfoLinkTargetType"><span class="hs-identifier hs-var hs-var">fileInfoLinkTargetType</span></a></span><span> </span><span class="annot"><span class="annottext">FileInfo
</span><a href="#local-6989586621679374803"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-888"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FileType
</span><a href="Brick.Widgets.FileBrowser.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-889"></span><span>        </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-890"></span><span>    </span><span class="annot"><span class="annottext">Maybe FileType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-891"></span></pre></body></html>