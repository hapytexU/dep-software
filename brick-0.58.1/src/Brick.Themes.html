<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | Support for representing attribute themes and loading and saving</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- theme customizations in INI-style files.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- The file format is as follows:</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Customization files are INI-style files with two sections, both</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- optional: @&quot;default&quot;@ and @&quot;other&quot;@.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- The @&quot;default&quot;@ section specifies three optional fields:</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">--  * @&quot;default.fg&quot;@ - a color specification</span><span>
</span><span id="line-17"></span><span class="hs-comment">--  * @&quot;default.bg&quot;@ - a color specification</span><span>
</span><span id="line-18"></span><span class="hs-comment">--  * @&quot;default.style&quot;@ - a style specification</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- A color specification can be any of the strings @black@, @red@,</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- @green@, @yellow@, @blue@, @magenta@, @cyan@, @white@, @brightBlack@,</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- @brightRed@, @brightGreen@, @brightYellow@, @brightBlue@,</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- @brightMagenta@, @brightCyan@, @brightWhite@, or @default@.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- We also support color specifications in the common hex format @#RRGGBB@, but</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- note that this specification is lossy: terminals can only display 256 colors,</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- but hex codes can specify @256^3 = 16777216@ colors.</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- A style specification can be either one of the following values</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- (without quotes) or a comma-delimited list of one or more of the</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- following values (e.g. @&quot;[bold,underline]&quot;@) indicating that all</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- of the specified styles be used. Valid styles are @standout@,</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- @underline@, @reverseVideo@, @blink@, @dim@, @italic@,</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- @strikethrough@, and @bold@.</span><span>
</span><span id="line-35"></span><span class="hs-comment">--</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- The @other@ section specifies for each attribute name in the theme</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- the same @fg@, @bg@, and @style@ settings as for the default</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- attribute. Furthermore, if an attribute name has multiple components,</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- the fields in the INI file should use periods as delimiters. For</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- example, if a theme has an attribute name (@&quot;foo&quot; &lt;&gt; &quot;bar&quot;@), then</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- the file may specify three fields:</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">--  * @foo.bar.fg@ - a color specification</span><span>
</span><span id="line-44"></span><span class="hs-comment">--  * @foo.bar.bg@ - a color specification</span><span>
</span><span id="line-45"></span><span class="hs-comment">--  * @foo.bar.style@ - a style specification</span><span>
</span><span id="line-46"></span><span class="hs-comment">--</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- Any color or style specifications omitted from the file mean that</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- those attribute or style settings will use the theme's default value</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- instead.</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- Attribute names with multiple components (e.g. @attr1 &lt;&gt; attr2@) can</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- be referenced in customization files by separating the names with</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- a dot. For example, the attribute name @&quot;list&quot; &lt;&gt; &quot;selected&quot;@ can be</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- referenced by using the string &quot;list.selected&quot;.</span><span>
</span><span id="line-55"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Brick.Themes</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier">CustomAttr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#customFgL"><span class="hs-identifier">customFgL</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#customBgL"><span class="hs-identifier">customBgL</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#customStyleL"><span class="hs-identifier">customStyleL</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier">Theme</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#newTheme"><span class="hs-identifier">newTheme</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#themeDefaultAttrL"><span class="hs-identifier">themeDefaultAttrL</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#themeDefaultMappingL"><span class="hs-identifier">themeDefaultMappingL</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#themeCustomMappingL"><span class="hs-identifier">themeCustomMappingL</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#themeCustomDefaultAttrL"><span class="hs-identifier">themeCustomDefaultAttrL</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#ThemeDocumentation"><span class="hs-identifier">ThemeDocumentation</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#themeDescriptionsL"><span class="hs-identifier">themeDescriptionsL</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#themeToAttrMap"><span class="hs-identifier">themeToAttrMap</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#applyCustomizations"><span class="hs-identifier">applyCustomizations</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#loadCustomizations"><span class="hs-identifier">loadCustomizations</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#saveCustomizations"><span class="hs-identifier">saveCustomizations</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Themes.html#saveTheme"><span class="hs-identifier">saveTheme</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Vty</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Read</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Sem</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">swap</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.|.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !(MIN_VERSION_base(4,11,0))
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ini.Config</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.AttrMap.html"><span class="hs-identifier">Brick.AttrMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.AttrMap.html#AttrMap"><span class="hs-identifier">AttrMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier">AttrName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#attrMap"><span class="hs-identifier">attrMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#attrNameComponents"><span class="hs-identifier">attrNameComponents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.Types.TH.html"><span class="hs-identifier">Brick.Types.TH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.TH.html#suffixLenses"><span class="hs-identifier">suffixLenses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | An attribute customization can specify which aspects of an</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- attribute to customize.</span><span>
</span><span id="line-107"></span><span id="local-6989586621679369163"><span id="local-6989586621679369164"></span></span><span class="hs-keyword">data</span><span> </span><span id="CustomAttr"><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-var">CustomAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>    </span><span id="CustomAttr"><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-var">CustomAttr</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="customFg"><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customFg"><span class="hs-identifier hs-var hs-var">customFg</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeDefault</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>               </span><span class="hs-comment">-- ^ The customized foreground, if any.</span><span>
</span><span id="line-110"></span><span>               </span><span class="hs-special">,</span><span> </span><span id="customBg"><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customBg"><span class="hs-identifier hs-var hs-var">customBg</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeDefault</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>               </span><span class="hs-comment">-- ^ The customized background, if any.</span><span>
</span><span id="line-112"></span><span>               </span><span class="hs-special">,</span><span> </span><span id="customStyle"><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe Style
</span><a href="Brick.Themes.html#customStyle"><span class="hs-identifier hs-var hs-var">customStyle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Style</span></span><span>
</span><span id="line-113"></span><span>               </span><span class="hs-comment">-- ^ The customized style, if any.</span><span>
</span><span id="line-114"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-115"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679369155"><span id="local-6989586621679369157"><span class="annot"><span class="annottext">CustomAttr -&gt; CustomAttr -&gt; Bool
(CustomAttr -&gt; CustomAttr -&gt; Bool)
-&gt; (CustomAttr -&gt; CustomAttr -&gt; Bool) -&gt; Eq CustomAttr
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CustomAttr -&gt; CustomAttr -&gt; Bool
$c/= :: CustomAttr -&gt; CustomAttr -&gt; Bool
== :: CustomAttr -&gt; CustomAttr -&gt; Bool
$c== :: CustomAttr -&gt; CustomAttr -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369146"><span id="local-6989586621679369148"><span id="local-6989586621679369150"><span id="local-6989586621679369152"><span class="annot"><span class="annottext">ReadPrec [CustomAttr]
ReadPrec CustomAttr
Int -&gt; ReadS CustomAttr
ReadS [CustomAttr]
(Int -&gt; ReadS CustomAttr)
-&gt; ReadS [CustomAttr]
-&gt; ReadPrec CustomAttr
-&gt; ReadPrec [CustomAttr]
-&gt; Read CustomAttr
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [CustomAttr]
$creadListPrec :: ReadPrec [CustomAttr]
readPrec :: ReadPrec CustomAttr
$creadPrec :: ReadPrec CustomAttr
readList :: ReadS [CustomAttr]
$creadList :: ReadS [CustomAttr]
readsPrec :: Int -&gt; ReadS CustomAttr
$creadsPrec :: Int -&gt; ReadS CustomAttr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369139"><span id="local-6989586621679369141"><span id="local-6989586621679369143"><span class="annot"><span class="annottext">Int -&gt; CustomAttr -&gt; ShowS
[CustomAttr] -&gt; ShowS
CustomAttr -&gt; String
(Int -&gt; CustomAttr -&gt; ShowS)
-&gt; (CustomAttr -&gt; String)
-&gt; ([CustomAttr] -&gt; ShowS)
-&gt; Show CustomAttr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CustomAttr] -&gt; ShowS
$cshowList :: [CustomAttr] -&gt; ShowS
show :: CustomAttr -&gt; String
$cshow :: CustomAttr -&gt; String
showsPrec :: Int -&gt; CustomAttr -&gt; ShowS
$cshowsPrec :: Int -&gt; CustomAttr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. CustomAttr -&gt; Rep CustomAttr x)
-&gt; (forall x. Rep CustomAttr x -&gt; CustomAttr) -&gt; Generic CustomAttr
forall x. Rep CustomAttr x -&gt; CustomAttr
forall x. CustomAttr -&gt; Rep CustomAttr x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep CustomAttr x -&gt; CustomAttr
$cfrom :: forall x. CustomAttr -&gt; Rep CustomAttr x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369133"><span class="annot"><span class="annottext">CustomAttr -&gt; ()
(CustomAttr -&gt; ()) -&gt; NFData CustomAttr
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: CustomAttr -&gt; ()
$crnf :: CustomAttr -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679369127"><span id="local-6989586621679369129"><span class="annot"><span class="hs-identifier hs-type">Sem.Semigroup</span></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679369125"><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369125"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679369124"><span class="annot"><span class="annottext">&lt;&gt; :: CustomAttr -&gt; CustomAttr -&gt; CustomAttr
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621679369123"><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369123"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="annottext">CustomAttr :: Maybe (MaybeDefault Color)
-&gt; Maybe (MaybeDefault Color) -&gt; Maybe Style -&gt; CustomAttr
</span><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">customFg :: Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customFg"><span class="hs-identifier hs-var">customFg</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customFg"><span class="hs-identifier hs-var hs-var">customFg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369125"><span class="hs-identifier hs-var">a</span></a></span><span>    </span><span class="annot"><span class="annottext">Maybe (MaybeDefault Color)
-&gt; Maybe (MaybeDefault Color) -&gt; Maybe (MaybeDefault Color)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customFg"><span class="hs-identifier hs-var hs-var">customFg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369123"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-120"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">customBg :: Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customBg"><span class="hs-identifier hs-var">customBg</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customBg"><span class="hs-identifier hs-var hs-var">customBg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369125"><span class="hs-identifier hs-var">a</span></a></span><span>    </span><span class="annot"><span class="annottext">Maybe (MaybeDefault Color)
-&gt; Maybe (MaybeDefault Color) -&gt; Maybe (MaybeDefault Color)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customBg"><span class="hs-identifier hs-var hs-var">customBg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369123"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-121"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">customStyle :: Maybe Style
</span><a href="Brick.Themes.html#customStyle"><span class="hs-identifier hs-var">customStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe Style
</span><a href="Brick.Themes.html#customStyle"><span class="hs-identifier hs-var hs-var">customStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369125"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Style -&gt; Maybe Style -&gt; Maybe Style
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe Style
</span><a href="Brick.Themes.html#customStyle"><span class="hs-identifier hs-var hs-var">customStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369123"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-122"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679369118"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679369116"><span class="annot"><span class="annottext">mempty :: CustomAttr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (MaybeDefault Color)
-&gt; Maybe (MaybeDefault Color) -&gt; Maybe Style -&gt; CustomAttr
</span><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-var">CustomAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (MaybeDefault Color)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (MaybeDefault Color)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Style
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679369115"><span class="annot"><span class="annottext">mappend :: CustomAttr -&gt; CustomAttr -&gt; CustomAttr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; CustomAttr -&gt; CustomAttr
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(Sem.&lt;&gt;)</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Documentation for a theme's attributes.</span><span>
</span><span id="line-129"></span><span id="local-6989586621679369113"><span id="local-6989586621679369114"></span></span><span class="hs-keyword">data</span><span> </span><span id="ThemeDocumentation"><span class="annot"><a href="Brick.Themes.html#ThemeDocumentation"><span class="hs-identifier hs-var">ThemeDocumentation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>    </span><span id="ThemeDocumentation"><span class="annot"><a href="Brick.Themes.html#ThemeDocumentation"><span class="hs-identifier hs-var">ThemeDocumentation</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="themeDescriptions"><span class="annot"><span class="annottext">ThemeDocumentation -&gt; Map AttrName Text
</span><a href="Brick.Themes.html#themeDescriptions"><span class="hs-identifier hs-var hs-var">themeDescriptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-131"></span><span>                       </span><span class="hs-comment">-- ^ The per-attribute documentation for a theme</span><span>
</span><span id="line-132"></span><span>                       </span><span class="hs-comment">-- so e.g. documentation for theme customization</span><span>
</span><span id="line-133"></span><span>                       </span><span class="hs-comment">-- can be generated mechanically.</span><span>
</span><span id="line-134"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>                       </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679369107"><span id="local-6989586621679369109"><span class="annot"><span class="annottext">ThemeDocumentation -&gt; ThemeDocumentation -&gt; Bool
(ThemeDocumentation -&gt; ThemeDocumentation -&gt; Bool)
-&gt; (ThemeDocumentation -&gt; ThemeDocumentation -&gt; Bool)
-&gt; Eq ThemeDocumentation
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ThemeDocumentation -&gt; ThemeDocumentation -&gt; Bool
$c/= :: ThemeDocumentation -&gt; ThemeDocumentation -&gt; Bool
== :: ThemeDocumentation -&gt; ThemeDocumentation -&gt; Bool
$c== :: ThemeDocumentation -&gt; ThemeDocumentation -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369099"><span id="local-6989586621679369101"><span id="local-6989586621679369103"><span id="local-6989586621679369105"><span class="annot"><span class="annottext">ReadPrec [ThemeDocumentation]
ReadPrec ThemeDocumentation
Int -&gt; ReadS ThemeDocumentation
ReadS [ThemeDocumentation]
(Int -&gt; ReadS ThemeDocumentation)
-&gt; ReadS [ThemeDocumentation]
-&gt; ReadPrec ThemeDocumentation
-&gt; ReadPrec [ThemeDocumentation]
-&gt; Read ThemeDocumentation
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [ThemeDocumentation]
$creadListPrec :: ReadPrec [ThemeDocumentation]
readPrec :: ReadPrec ThemeDocumentation
$creadPrec :: ReadPrec ThemeDocumentation
readList :: ReadS [ThemeDocumentation]
$creadList :: ReadS [ThemeDocumentation]
readsPrec :: Int -&gt; ReadS ThemeDocumentation
$creadsPrec :: Int -&gt; ReadS ThemeDocumentation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369093"><span id="local-6989586621679369095"><span id="local-6989586621679369097"><span class="annot"><span class="annottext">Int -&gt; ThemeDocumentation -&gt; ShowS
[ThemeDocumentation] -&gt; ShowS
ThemeDocumentation -&gt; String
(Int -&gt; ThemeDocumentation -&gt; ShowS)
-&gt; (ThemeDocumentation -&gt; String)
-&gt; ([ThemeDocumentation] -&gt; ShowS)
-&gt; Show ThemeDocumentation
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ThemeDocumentation] -&gt; ShowS
$cshowList :: [ThemeDocumentation] -&gt; ShowS
show :: ThemeDocumentation -&gt; String
$cshow :: ThemeDocumentation -&gt; String
showsPrec :: Int -&gt; ThemeDocumentation -&gt; ShowS
$cshowsPrec :: Int -&gt; ThemeDocumentation -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. ThemeDocumentation -&gt; Rep ThemeDocumentation x)
-&gt; (forall x. Rep ThemeDocumentation x -&gt; ThemeDocumentation)
-&gt; Generic ThemeDocumentation
forall x. Rep ThemeDocumentation x -&gt; ThemeDocumentation
forall x. ThemeDocumentation -&gt; Rep ThemeDocumentation x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep ThemeDocumentation x -&gt; ThemeDocumentation
$cfrom :: forall x. ThemeDocumentation -&gt; Rep ThemeDocumentation x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369089"><span class="annot"><span class="annottext">ThemeDocumentation -&gt; ()
(ThemeDocumentation -&gt; ()) -&gt; NFData ThemeDocumentation
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: ThemeDocumentation -&gt; ()
$crnf :: ThemeDocumentation -&gt; ()
</span><a href="#local-6989586621679369089"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | A theme provides a set of default attribute mappings, a default</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- attribute, and a set of customizations for the default mapping</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- and default attribute. The idea here is that the application will</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- always need to provide a complete specification of its attribute</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- mapping, but if the user wants to customize any aspect of that</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- default mapping, it can be contained here and then built into an</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- 'AttrMap' (see 'themeToAttrMap'). We keep the defaults separate</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- from customizations to permit users to serialize themes and their</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- customizations to, say, disk files.</span><span>
</span><span id="line-146"></span><span id="local-6989586621679369087"><span id="local-6989586621679369088"></span></span><span class="hs-keyword">data</span><span> </span><span id="Theme"><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-var">Theme</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>    </span><span id="Theme"><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-var">Theme</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="themeDefaultAttr"><span class="annot"><span class="annottext">Theme -&gt; Attr
</span><a href="Brick.Themes.html#themeDefaultAttr"><span class="hs-identifier hs-var hs-var">themeDefaultAttr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Attr</span></span><span>
</span><span id="line-148"></span><span>          </span><span class="hs-comment">-- ^ The default attribute to use.</span><span>
</span><span id="line-149"></span><span>          </span><span class="hs-special">,</span><span> </span><span id="themeDefaultMapping"><span class="annot"><span class="annottext">Theme -&gt; Map AttrName Attr
</span><a href="Brick.Themes.html#themeDefaultMapping"><span class="hs-identifier hs-var hs-var">themeDefaultMapping</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Attr</span></span><span>
</span><span id="line-150"></span><span>          </span><span class="hs-comment">-- ^ The default attribute mapping to use.</span><span>
</span><span id="line-151"></span><span>          </span><span class="hs-special">,</span><span> </span><span id="themeCustomDefaultAttr"><span class="annot"><span class="annottext">Theme -&gt; Maybe CustomAttr
</span><a href="Brick.Themes.html#themeCustomDefaultAttr"><span class="hs-identifier hs-var hs-var">themeCustomDefaultAttr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span>
</span><span id="line-152"></span><span>          </span><span class="hs-comment">-- ^ Customization for the theme's default attribute.</span><span>
</span><span id="line-153"></span><span>          </span><span class="hs-special">,</span><span> </span><span id="themeCustomMapping"><span class="annot"><span class="annottext">Theme -&gt; Map AttrName CustomAttr
</span><a href="Brick.Themes.html#themeCustomMapping"><span class="hs-identifier hs-var hs-var">themeCustomMapping</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span>
</span><span id="line-154"></span><span>          </span><span class="hs-comment">-- ^ Customizations for individual entries of the default</span><span>
</span><span id="line-155"></span><span>          </span><span class="hs-comment">-- mapping. Note that this will only affect entries in the</span><span>
</span><span id="line-156"></span><span>          </span><span class="hs-comment">-- default mapping; any attributes named here that are not</span><span>
</span><span id="line-157"></span><span>          </span><span class="hs-comment">-- present in the default mapping will not be considered.</span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-159"></span><span>          </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679369078"><span id="local-6989586621679369080"><span class="annot"><span class="annottext">Theme -&gt; Theme -&gt; Bool
(Theme -&gt; Theme -&gt; Bool) -&gt; (Theme -&gt; Theme -&gt; Bool) -&gt; Eq Theme
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Theme -&gt; Theme -&gt; Bool
$c/= :: Theme -&gt; Theme -&gt; Bool
== :: Theme -&gt; Theme -&gt; Bool
$c== :: Theme -&gt; Theme -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369070"><span id="local-6989586621679369072"><span id="local-6989586621679369074"><span id="local-6989586621679369076"><span class="annot"><span class="annottext">ReadPrec [Theme]
ReadPrec Theme
Int -&gt; ReadS Theme
ReadS [Theme]
(Int -&gt; ReadS Theme)
-&gt; ReadS [Theme]
-&gt; ReadPrec Theme
-&gt; ReadPrec [Theme]
-&gt; Read Theme
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Theme]
$creadListPrec :: ReadPrec [Theme]
readPrec :: ReadPrec Theme
$creadPrec :: ReadPrec Theme
readList :: ReadS [Theme]
$creadList :: ReadS [Theme]
readsPrec :: Int -&gt; ReadS Theme
$creadsPrec :: Int -&gt; ReadS Theme
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369064"><span id="local-6989586621679369066"><span id="local-6989586621679369068"><span class="annot"><span class="annottext">Int -&gt; Theme -&gt; ShowS
[Theme] -&gt; ShowS
Theme -&gt; String
(Int -&gt; Theme -&gt; ShowS)
-&gt; (Theme -&gt; String) -&gt; ([Theme] -&gt; ShowS) -&gt; Show Theme
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Theme] -&gt; ShowS
$cshowList :: [Theme] -&gt; ShowS
show :: Theme -&gt; String
$cshow :: Theme -&gt; String
showsPrec :: Int -&gt; Theme -&gt; ShowS
$cshowsPrec :: Int -&gt; Theme -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Theme -&gt; Rep Theme x)
-&gt; (forall x. Rep Theme x -&gt; Theme) -&gt; Generic Theme
forall x. Rep Theme x -&gt; Theme
forall x. Theme -&gt; Rep Theme x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Theme x -&gt; Theme
$cfrom :: forall x. Theme -&gt; Rep Theme x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369060"><span class="annot"><span class="annottext">Theme -&gt; ()
(Theme -&gt; ()) -&gt; NFData Theme
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Theme -&gt; ()
$crnf :: Theme -&gt; ()
</span><a href="#local-6989586621679369060"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="customStyleL"><span id="customBgL"><span id="customFgL"><span class="hs-identifier">suffixLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">CustomAttr</span></span></span></span><span>
</span><span id="line-162"></span><span id="themeCustomDefaultAttrL"><span id="themeCustomMappingL"><span id="themeDefaultMappingL"><span id="themeDefaultAttrL"><span class="hs-identifier">suffixLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Theme</span></span></span></span></span><span>
</span><span id="line-163"></span><span id="themeDescriptionsL"><span class="hs-identifier">suffixLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ThemeDocumentation</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Brick.Themes.html#defaultSectionName"><span class="hs-identifier hs-type">defaultSectionName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-166"></span><span id="defaultSectionName"><span class="annot"><span class="annottext">defaultSectionName :: Text
</span><a href="Brick.Themes.html#defaultSectionName"><span class="hs-identifier hs-var hs-var">defaultSectionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Brick.Themes.html#otherSectionName"><span class="hs-identifier hs-type">otherSectionName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-169"></span><span id="otherSectionName"><span class="annot"><span class="annottext">otherSectionName :: Text
</span><a href="Brick.Themes.html#otherSectionName"><span class="hs-identifier hs-var hs-var">otherSectionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;other&quot;</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Create a new theme with the specified default attribute and</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- attribute mapping. The theme will have no customizations.</span><span>
</span><span id="line-173"></span><span class="annot"><a href="Brick.Themes.html#newTheme"><span class="hs-identifier hs-type">newTheme</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Attr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Attr</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span>
</span><span id="line-174"></span><span id="newTheme"><span class="annot"><span class="annottext">newTheme :: Attr -&gt; [(AttrName, Attr)] -&gt; Theme
</span><a href="Brick.Themes.html#newTheme"><span class="hs-identifier hs-var hs-var">newTheme</span></a></span></span><span> </span><span id="local-6989586621679369057"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369057"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621679369056"><span class="annot"><span class="annottext">[(AttrName, Attr)]
</span><a href="#local-6989586621679369056"><span class="hs-identifier hs-var">mapping</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">Theme :: Attr
-&gt; Map AttrName Attr
-&gt; Maybe CustomAttr
-&gt; Map AttrName CustomAttr
-&gt; Theme
</span><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">themeDefaultAttr :: Attr
</span><a href="Brick.Themes.html#themeDefaultAttr"><span class="hs-identifier hs-var">themeDefaultAttr</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369057"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">themeDefaultMapping :: Map AttrName Attr
</span><a href="Brick.Themes.html#themeDefaultMapping"><span class="hs-identifier hs-var">themeDefaultMapping</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AttrName, Attr)] -&gt; Map AttrName Attr
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(AttrName, Attr)]
</span><a href="#local-6989586621679369056"><span class="hs-identifier hs-var">mapping</span></a></span><span>
</span><span id="line-177"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">themeCustomDefaultAttr :: Maybe CustomAttr
</span><a href="Brick.Themes.html#themeCustomDefaultAttr"><span class="hs-identifier hs-var">themeCustomDefaultAttr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CustomAttr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">themeCustomMapping :: Map AttrName CustomAttr
</span><a href="Brick.Themes.html#themeCustomMapping"><span class="hs-identifier hs-var">themeCustomMapping</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map AttrName CustomAttr
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Build an 'AttrMap' from a 'Theme'. This applies all customizations</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- in the returned 'AttrMap'.</span><span>
</span><span id="line-183"></span><span class="annot"><a href="Brick.Themes.html#themeToAttrMap"><span class="hs-identifier hs-type">themeToAttrMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrMap"><span class="hs-identifier hs-type">AttrMap</span></a></span><span>
</span><span id="line-184"></span><span id="themeToAttrMap"><span class="annot"><span class="annottext">themeToAttrMap :: Theme -&gt; AttrMap
</span><a href="Brick.Themes.html#themeToAttrMap"><span class="hs-identifier hs-var hs-var">themeToAttrMap</span></a></span></span><span> </span><span id="local-6989586621679369054"><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679369054"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="annottext">Attr -&gt; [(AttrName, Attr)] -&gt; AttrMap
</span><a href="Brick.AttrMap.html#attrMap"><span class="hs-identifier hs-var">attrMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe CustomAttr -&gt; Attr -&gt; Attr
</span><a href="Brick.Themes.html#customizeAttr"><span class="hs-identifier hs-var">customizeAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Theme -&gt; Maybe CustomAttr
</span><a href="Brick.Themes.html#themeCustomDefaultAttr"><span class="hs-identifier hs-var hs-var">themeCustomDefaultAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679369054"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Theme -&gt; Attr
</span><a href="Brick.Themes.html#themeDefaultAttr"><span class="hs-identifier hs-var hs-var">themeDefaultAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679369054"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(AttrName, Attr)]
</span><a href="#local-6989586621679369052"><span class="hs-identifier hs-var">customMap</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679369052"><span class="annot"><span class="annottext">customMap :: [(AttrName, Attr)]
</span><a href="#local-6989586621679369052"><span class="hs-identifier hs-var hs-var">customMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((AttrName, Attr) -&gt; [(AttrName, Attr)] -&gt; [(AttrName, Attr)])
-&gt; [(AttrName, Attr)] -&gt; [(AttrName, Attr)] -&gt; [(AttrName, Attr)]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">F.foldr</span></span><span> </span><span class="annot"><span class="annottext">(AttrName, Attr) -&gt; [(AttrName, Attr)] -&gt; [(AttrName, Attr)]
</span><a href="#local-6989586621679369050"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AttrName Attr -&gt; [(AttrName, Attr)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map AttrName Attr -&gt; [(AttrName, Attr)])
-&gt; Map AttrName Attr -&gt; [(AttrName, Attr)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Map AttrName Attr
</span><a href="Brick.Themes.html#themeDefaultMapping"><span class="hs-identifier hs-var hs-var">themeDefaultMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679369054"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>        </span><span id="local-6989586621679369050"><span class="annot"><span class="annottext">f :: (AttrName, Attr) -&gt; [(AttrName, Attr)] -&gt; [(AttrName, Attr)]
</span><a href="#local-6989586621679369050"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679369048"><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679369048"><span class="hs-identifier hs-var">aName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369047"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369047"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679369046"><span class="annot"><span class="annottext">[(AttrName, Attr)]
</span><a href="#local-6989586621679369046"><span class="hs-identifier hs-var">mapping</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369045"><span class="annot"><span class="annottext">a' :: Attr
</span><a href="#local-6989586621679369045"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CustomAttr -&gt; Attr -&gt; Attr
</span><a href="Brick.Themes.html#customizeAttr"><span class="hs-identifier hs-var">customizeAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AttrName -&gt; Map AttrName CustomAttr -&gt; Maybe CustomAttr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679369048"><span class="hs-identifier hs-var">aName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Theme -&gt; Map AttrName CustomAttr
</span><a href="Brick.Themes.html#themeCustomMapping"><span class="hs-identifier hs-var hs-var">themeCustomMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679369054"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369047"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-190"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679369048"><span class="hs-identifier hs-var">aName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369045"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(AttrName, Attr) -&gt; [(AttrName, Attr)] -&gt; [(AttrName, Attr)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(AttrName, Attr)]
</span><a href="#local-6989586621679369046"><span class="hs-identifier hs-var">mapping</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Brick.Themes.html#customizeAttr"><span class="hs-identifier hs-type">customizeAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Attr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Attr</span></span><span>
</span><span id="line-193"></span><span id="customizeAttr"><span class="annot"><span class="annottext">customizeAttr :: Maybe CustomAttr -&gt; Attr -&gt; Attr
</span><a href="Brick.Themes.html#customizeAttr"><span class="hs-identifier hs-var hs-var">customizeAttr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe CustomAttr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679369043"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369043"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369043"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Brick.Themes.html#customizeAttr"><span class="hs-identifier hs-var">customizeAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679369042"><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369042"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679369041"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369041"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369040"><span class="annot"><span class="annottext">fg :: MaybeDefault Color
</span><a href="#local-6989586621679369040"><span class="hs-identifier hs-var hs-var">fg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color
-&gt; Maybe (MaybeDefault Color) -&gt; MaybeDefault Color
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; MaybeDefault Color
</span><span class="hs-identifier hs-var hs-var">attrForeColor</span></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369041"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customFg"><span class="hs-identifier hs-var hs-var">customFg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369042"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>        </span><span id="local-6989586621679369038"><span class="annot"><span class="annottext">bg :: MaybeDefault Color
</span><a href="#local-6989586621679369038"><span class="hs-identifier hs-var hs-var">bg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color
-&gt; Maybe (MaybeDefault Color) -&gt; MaybeDefault Color
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; MaybeDefault Color
</span><span class="hs-identifier hs-var hs-var">attrBackColor</span></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369041"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customBg"><span class="hs-identifier hs-var hs-var">customBg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369042"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>        </span><span id="local-6989586621679369036"><span class="annot"><span class="annottext">sty :: MaybeDefault Style
</span><a href="#local-6989586621679369036"><span class="hs-identifier hs-var hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Style
-&gt; (Style -&gt; MaybeDefault Style)
-&gt; Maybe Style
-&gt; MaybeDefault Style
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; MaybeDefault Style
</span><span class="hs-identifier hs-var hs-var">attrStyle</span></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369041"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Style -&gt; MaybeDefault Style
forall v. (Eq v, Show v, Read v) =&gt; v -&gt; MaybeDefault v
</span><span class="hs-identifier hs-var">SetTo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe Style
</span><a href="Brick.Themes.html#customStyle"><span class="hs-identifier hs-var hs-var">customStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369042"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679369041"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">attrForeColor :: MaybeDefault Color
</span><span class="hs-identifier hs-var">attrForeColor</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color
</span><a href="#local-6989586621679369040"><span class="hs-identifier hs-var">fg</span></a></span><span>
</span><span id="line-199"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">attrBackColor :: MaybeDefault Color
</span><span class="hs-identifier hs-var">attrBackColor</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color
</span><a href="#local-6989586621679369038"><span class="hs-identifier hs-var">bg</span></a></span><span>
</span><span id="line-200"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">attrStyle :: MaybeDefault Style
</span><span class="hs-identifier hs-var">attrStyle</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Style
</span><a href="#local-6989586621679369036"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-201"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Brick.Themes.html#isNullCustomization"><span class="hs-identifier hs-type">isNullCustomization</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-204"></span><span id="isNullCustomization"><span class="annot"><span class="annottext">isNullCustomization :: CustomAttr -&gt; Bool
</span><a href="Brick.Themes.html#isNullCustomization"><span class="hs-identifier hs-var hs-var">isNullCustomization</span></a></span></span><span> </span><span id="local-6989586621679369031"><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369031"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">Maybe (MaybeDefault Color) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customFg"><span class="hs-identifier hs-var hs-var">customFg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369031"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">Maybe (MaybeDefault Color) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customBg"><span class="hs-identifier hs-var hs-var">customBg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369031"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Maybe Style -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe Style
</span><a href="Brick.Themes.html#customStyle"><span class="hs-identifier hs-var hs-var">customStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679369031"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- |  This function is lossy in the sense that we only internally support 240 colors but</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- the #RRGGBB format supports 16^3 colors.</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Brick.Themes.html#parseColor"><span class="hs-identifier hs-type">parseColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeDefault</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span id="parseColor"><span class="annot"><span class="annottext">parseColor :: Text -&gt; Either String (MaybeDefault Color)
</span><a href="Brick.Themes.html#parseColor"><span class="hs-identifier hs-var hs-var">parseColor</span></a></span></span><span> </span><span id="local-6989586621679369028"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369028"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679369027"><span class="annot"><span class="annottext">stripped :: Text
</span><a href="#local-6989586621679369027"><span class="hs-identifier hs-var hs-var">stripped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369028"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621679369024"><span class="annot"><span class="annottext">normalize :: (Text, b) -&gt; (Text, b)
</span><a href="#local-6989586621679369024"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679369023"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369023"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679369022"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679369022"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369023"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679369022"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369027"><span class="hs-identifier hs-var">stripped</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span>
</span><span id="line-216"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color -&gt; Either String (MaybeDefault Color)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color
forall v. MaybeDefault v
</span><span class="hs-identifier hs-var">Default</span></span><span>
</span><span id="line-217"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Color
</span><a href="#local-6989586621679369020"><span class="hs-identifier hs-var">parseRGB</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369027"><span class="hs-identifier hs-var">stripped</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-218"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679369019"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679369019"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color -&gt; Either String (MaybeDefault Color)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; MaybeDefault Color
forall v. (Eq v, Show v, Read v) =&gt; v -&gt; MaybeDefault v
</span><span class="hs-identifier hs-var">SetTo</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679369019"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>              </span><span class="annot"><span class="annottext">Maybe Color
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either String (MaybeDefault Color)
-&gt; (Color -&gt; Either String (MaybeDefault Color))
-&gt; Maybe Color
-&gt; Either String (MaybeDefault Color)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Either String (MaybeDefault Color)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String (MaybeDefault Color))
-&gt; String -&gt; Either String (MaybeDefault Color)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid color: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369027"><span class="hs-identifier hs-var">stripped</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeDefault Color -&gt; Either String (MaybeDefault Color)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(MaybeDefault Color -&gt; Either String (MaybeDefault Color))
-&gt; (Color -&gt; MaybeDefault Color)
-&gt; Color
-&gt; Either String (MaybeDefault Color)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; MaybeDefault Color
forall v. (Eq v, Show v, Read v) =&gt; v -&gt; MaybeDefault v
</span><span class="hs-identifier hs-var">SetTo</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Color -&gt; Either String (MaybeDefault Color))
-&gt; Maybe Color -&gt; Either String (MaybeDefault Color)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-220"></span><span>                             </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Color)] -&gt; Maybe Color
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369027"><span class="hs-identifier hs-var">stripped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text, Color) -&gt; (Text, Color)
forall b. (Text, b) -&gt; (Text, b)
</span><a href="#local-6989586621679369024"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">((Text, Color) -&gt; (Text, Color))
-&gt; ((Color, Text) -&gt; (Text, Color))
-&gt; (Color, Text)
-&gt; (Text, Color)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Color, Text) -&gt; (Text, Color)
forall a b. (a, b) -&gt; (b, a)
</span><span class="hs-identifier hs-var">swap</span></span><span> </span><span class="annot"><span class="annottext">((Color, Text) -&gt; (Text, Color))
-&gt; [(Color, Text)] -&gt; [(Text, Color)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Color, Text)]
</span><a href="Brick.Themes.html#allColors"><span class="hs-identifier hs-var">allColors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679369020"><span class="annot"><span class="annottext">parseRGB :: Text -&gt; Maybe Color
</span><a href="#local-6989586621679369020"><span class="hs-identifier hs-var hs-var">parseRGB</span></a></span></span><span> </span><span id="local-6989586621679369013"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369013"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Char
</span><span class="hs-identifier hs-var">T.head</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369013"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'#'</span></span><span>
</span><span id="line-223"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Color
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-224"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Int) -&gt; [Text] -&gt; [Int]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Int
</span><a href="#local-6989586621679369010"><span class="hs-identifier hs-var">readHex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.chunksOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369013"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-225"></span><span>                            </span><span class="hs-special">[</span><span id="local-6989586621679369007"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679369007"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679369006"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679369006"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679369005"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679369005"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Color -&gt; Maybe Color
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Color
forall i. Integral i =&gt; i -&gt; i -&gt; i -&gt; Color
</span><span class="hs-identifier hs-var">rgbColor</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679369007"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679369006"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679369005"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>                            </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Color
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="#local-6989586621679369010"><span class="hs-identifier hs-type">readHex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679369010"><span class="annot"><span class="annottext">readHex :: Text -&gt; Maybe Int
</span><a href="#local-6989586621679369010"><span class="hs-identifier hs-var hs-var">readHex</span></a></span></span><span> </span><span id="local-6989586621679369003"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369003"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Int)
-&gt; ((Int, Text) -&gt; Maybe Int)
-&gt; Either String (Int, Text)
-&gt; Maybe Int
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; String -&gt; Maybe Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe Int)
-&gt; ((Int, Text) -&gt; Int) -&gt; (Int, Text) -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, Text) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader Int
forall a. Integral a =&gt; Reader a
</span><span class="hs-identifier hs-var">T.hexadecimal</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679369003"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><a href="Brick.Themes.html#allColors"><span class="hs-identifier hs-type">allColors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span id="allColors"><span class="annot"><span class="annottext">allColors :: [(Color, Text)]
</span><a href="Brick.Themes.html#allColors"><span class="hs-identifier hs-var hs-var">allColors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">black</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;black&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">red</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;red&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">green</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;green&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">yellow</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;yellow&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">blue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;blue&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">magenta</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;magenta&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">cyan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cyan&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">white</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">brightBlack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;brightBlack&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">brightRed</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;brightRed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">brightGreen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;brightGreen&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">brightYellow</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;brightYellow&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">brightBlue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;brightBlue&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">brightMagenta</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;brightMagenta&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">brightCyan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;brightCyan&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">brightWhite</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;brightWhite&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><a href="Brick.Themes.html#allStyles"><span class="hs-identifier hs-type">allStyles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Style</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-252"></span><span id="allStyles"><span class="annot"><span class="annottext">allStyles :: [(Text, Style)]
</span><a href="Brick.Themes.html#allStyles"><span class="hs-identifier hs-var hs-var">allStyles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;standout&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier hs-var">standout</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;underline&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier hs-var">underline</span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;strikethrough&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier hs-var">strikethrough</span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;reversevideo&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier hs-var">reverseVideo</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;blink&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier hs-var">blink</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;dim&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier hs-var">dim</span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bold&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier hs-var">bold</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;italic&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier hs-var">italic</span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Brick.Themes.html#parseStyle"><span class="hs-identifier hs-type">parseStyle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Style</span></span><span>
</span><span id="line-264"></span><span id="parseStyle"><span class="annot"><span class="annottext">parseStyle :: Text -&gt; Either String Style
</span><a href="Brick.Themes.html#parseStyle"><span class="hs-identifier hs-var hs-var">parseStyle</span></a></span></span><span> </span><span id="local-6989586621679368973"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368973"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368972"><span class="annot"><span class="annottext">lookupStyle :: Text -&gt; Either String (Maybe Style)
</span><a href="#local-6989586621679368972"><span class="hs-identifier hs-var hs-var">lookupStyle</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Style -&gt; Either String (Maybe Style)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe Style
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><a href="#local-6989586621679368972"><span class="hs-identifier hs-var">lookupStyle</span></a></span><span> </span><span id="local-6989586621679368971"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368971"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Style)] -&gt; Maybe Style
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368971"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Style)]
</span><a href="#local-6989586621679368970"><span class="hs-identifier hs-var">normalizedStyles</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-267"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679368969"><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368969"><span class="hs-identifier hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Style -&gt; Either String (Maybe Style)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Style -&gt; Either String (Maybe Style))
-&gt; Maybe Style -&gt; Either String (Maybe Style)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Style -&gt; Maybe Style
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368969"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-268"></span><span>            </span><span class="annot"><span class="annottext">Maybe Style
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Maybe Style)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String (Maybe Style))
-&gt; String -&gt; Either String (Maybe Style)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Text -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Invalid style: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368971"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-269"></span><span>        </span><span id="local-6989586621679368967"><span class="annot"><span class="annottext">stripped :: Text
</span><a href="#local-6989586621679368967"><span class="hs-identifier hs-var hs-var">stripped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368973"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621679368966"><span class="annot"><span class="annottext">normalize :: (Text, b) -&gt; (Text, b)
</span><a href="#local-6989586621679368966"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679368965"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368965"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679368964"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679368964"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368965"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679368964"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>        </span><span id="local-6989586621679368970"><span class="annot"><span class="annottext">normalizedStyles :: [(Text, Style)]
</span><a href="#local-6989586621679368970"><span class="hs-identifier hs-var hs-var">normalizedStyles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text, Style) -&gt; (Text, Style)
forall b. (Text, b) -&gt; (Text, b)
</span><a href="#local-6989586621679368966"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">((Text, Style) -&gt; (Text, Style))
-&gt; [(Text, Style)] -&gt; [(Text, Style)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Style)]
</span><a href="Brick.Themes.html#allStyles"><span class="hs-identifier hs-var">allStyles</span></a></span><span>
</span><span id="line-272"></span><span>        </span><span id="local-6989586621679368963"><span class="annot"><span class="annottext">bracketed :: Bool
</span><a href="#local-6989586621679368963"><span class="hs-identifier hs-var hs-var">bracketed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368967"><span class="hs-identifier hs-var">stripped</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-273"></span><span>                    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;]&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isSuffixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368967"><span class="hs-identifier hs-var">stripped</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span id="local-6989586621679368960"><span class="annot"><span class="annottext">unbracketed :: Text
</span><a href="#local-6989586621679368960"><span class="hs-identifier hs-var hs-var">unbracketed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.init</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368967"><span class="hs-identifier hs-var">stripped</span></a></span><span>
</span><span id="line-275"></span><span>        </span><span id="local-6989586621679368958"><span class="annot"><span class="annottext">parseStyleList :: Either String Style
</span><a href="#local-6989586621679368958"><span class="hs-identifier hs-var hs-var">parseStyleList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>            </span><span id="local-6989586621679368957"><span class="annot"><span class="annottext">[Maybe Style]
</span><a href="#local-6989586621679368957"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either String (Maybe Style))
-&gt; [Text] -&gt; Either String [Maybe Style]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String (Maybe Style)
</span><a href="#local-6989586621679368972"><span class="hs-identifier hs-var">lookupStyle</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Either String [Maybe Style])
-&gt; [Text] -&gt; Either String [Maybe Style]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; [Text] -&gt; [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.splitOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368960"><span class="hs-identifier hs-var">unbracketed</span></a></span><span>
</span><span id="line-277"></span><span>            </span><span class="annot"><span class="annottext">Style -&gt; Either String Style
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Style -&gt; Either String Style) -&gt; Style -&gt; Either String Style
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Style -&gt; Style -&gt; Style) -&gt; Style -&gt; [Style] -&gt; Style
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Style -&gt; Style -&gt; Style
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">([Style] -&gt; Style) -&gt; [Style] -&gt; Style
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Style] -&gt; [Style]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Style]
</span><a href="#local-6989586621679368957"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679368963"><span class="hs-identifier hs-var">bracketed</span></a></span><span>
</span><span id="line-280"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either String Style
</span><a href="#local-6989586621679368958"><span class="hs-identifier hs-var">parseStyleList</span></a></span><span>
</span><span id="line-281"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>           </span><span id="local-6989586621679368954"><span class="annot"><span class="annottext">Maybe Style
</span><a href="#local-6989586621679368954"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String (Maybe Style)
</span><a href="#local-6989586621679368972"><span class="hs-identifier hs-var">lookupStyle</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368967"><span class="hs-identifier hs-var">stripped</span></a></span><span>
</span><span id="line-283"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Style
</span><a href="#local-6989586621679368954"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-284"></span><span>               </span><span class="annot"><span class="annottext">Maybe Style
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Style
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Style) -&gt; String -&gt; Either String Style
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid style: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368967"><span class="hs-identifier hs-var">stripped</span></a></span><span>
</span><span id="line-285"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679368953"><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368953"><span class="hs-identifier hs-var">sty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Style -&gt; Either String Style
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368953"><span class="hs-identifier hs-var">sty</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Brick.Themes.html#themeParser"><span class="hs-identifier hs-type">themeParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IniParser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span id="themeParser"><span class="annot"><span class="annottext">themeParser :: Theme -&gt; IniParser (Maybe CustomAttr, Map AttrName CustomAttr)
</span><a href="Brick.Themes.html#themeParser"><span class="hs-identifier hs-var hs-var">themeParser</span></a></span></span><span> </span><span id="local-6989586621679368951"><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368951"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368950"><span class="annot"><span class="annottext">parseCustomAttr :: Text -&gt; SectionParser (Maybe CustomAttr)
</span><a href="#local-6989586621679368950"><span class="hs-identifier hs-var hs-var">parseCustomAttr</span></a></span></span><span> </span><span id="local-6989586621679368949"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368949"><span class="hs-identifier hs-var">basename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>          </span><span id="local-6989586621679368948"><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368948"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (MaybeDefault Color)
-&gt; Maybe (MaybeDefault Color) -&gt; Maybe Style -&gt; CustomAttr
</span><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-var">CustomAttr</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (MaybeDefault Color)
 -&gt; Maybe (MaybeDefault Color) -&gt; Maybe Style -&gt; CustomAttr)
-&gt; SectionParser (Maybe (MaybeDefault Color))
-&gt; SectionParser
     (Maybe (MaybeDefault Color) -&gt; Maybe Style -&gt; CustomAttr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; (Text -&gt; Either String (MaybeDefault Color))
-&gt; SectionParser (Maybe (MaybeDefault Color))
forall a.
Text -&gt; (Text -&gt; Either String a) -&gt; SectionParser (Maybe a)
</span><span class="hs-identifier hs-var">fieldMbOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368949"><span class="hs-identifier hs-var">basename</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.fg&quot;</span></span><span class="hs-special">)</span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Either String (MaybeDefault Color)
</span><a href="Brick.Themes.html#parseColor"><span class="hs-identifier hs-var">parseColor</span></a></span><span>
</span><span id="line-291"></span><span>                          </span><span class="annot"><span class="annottext">SectionParser
  (Maybe (MaybeDefault Color) -&gt; Maybe Style -&gt; CustomAttr)
-&gt; SectionParser (Maybe (MaybeDefault Color))
-&gt; SectionParser (Maybe Style -&gt; CustomAttr)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; (Text -&gt; Either String (MaybeDefault Color))
-&gt; SectionParser (Maybe (MaybeDefault Color))
forall a.
Text -&gt; (Text -&gt; Either String a) -&gt; SectionParser (Maybe a)
</span><span class="hs-identifier hs-var">fieldMbOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368949"><span class="hs-identifier hs-var">basename</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.bg&quot;</span></span><span class="hs-special">)</span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Either String (MaybeDefault Color)
</span><a href="Brick.Themes.html#parseColor"><span class="hs-identifier hs-var">parseColor</span></a></span><span>
</span><span id="line-292"></span><span>                          </span><span class="annot"><span class="annottext">SectionParser (Maybe Style -&gt; CustomAttr)
-&gt; SectionParser (Maybe Style) -&gt; SectionParser CustomAttr
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; (Text -&gt; Either String Style) -&gt; SectionParser (Maybe Style)
forall a.
Text -&gt; (Text -&gt; Either String a) -&gt; SectionParser (Maybe a)
</span><span class="hs-identifier hs-var">fieldMbOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368949"><span class="hs-identifier hs-var">basename</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.style&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String Style
</span><a href="Brick.Themes.html#parseStyle"><span class="hs-identifier hs-var">parseStyle</span></a></span><span>
</span><span id="line-293"></span><span>          </span><span class="annot"><span class="annottext">Maybe CustomAttr -&gt; SectionParser (Maybe CustomAttr)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe CustomAttr -&gt; SectionParser (Maybe CustomAttr))
-&gt; Maybe CustomAttr -&gt; SectionParser (Maybe CustomAttr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Bool
</span><a href="Brick.Themes.html#isNullCustomization"><span class="hs-identifier hs-var">isNullCustomization</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368948"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe CustomAttr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe CustomAttr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368948"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679368946"><span class="annot"><span class="annottext">Maybe (Maybe CustomAttr)
</span><a href="#local-6989586621679368946"><span class="hs-identifier hs-var">defCustom</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; SectionParser (Maybe CustomAttr)
-&gt; IniParser (Maybe (Maybe CustomAttr))
forall a. Text -&gt; SectionParser a -&gt; IniParser (Maybe a)
</span><span class="hs-identifier hs-var">sectionMb</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Brick.Themes.html#defaultSectionName"><span class="hs-identifier hs-var">defaultSectionName</span></a></span><span> </span><span class="annot"><span class="annottext">(SectionParser (Maybe CustomAttr)
 -&gt; IniParser (Maybe (Maybe CustomAttr)))
-&gt; SectionParser (Maybe CustomAttr)
-&gt; IniParser (Maybe (Maybe CustomAttr))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; SectionParser (Maybe CustomAttr)
</span><a href="#local-6989586621679368950"><span class="hs-identifier hs-var">parseCustomAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621679368944"><span class="annot"><span class="annottext">Maybe [(AttrName, CustomAttr)]
</span><a href="#local-6989586621679368944"><span class="hs-identifier hs-var">customMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; SectionParser [(AttrName, CustomAttr)]
-&gt; IniParser (Maybe [(AttrName, CustomAttr)])
forall a. Text -&gt; SectionParser a -&gt; IniParser (Maybe a)
</span><span class="hs-identifier hs-var">sectionMb</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Brick.Themes.html#otherSectionName"><span class="hs-identifier hs-var">otherSectionName</span></a></span><span> </span><span class="annot"><span class="annottext">(SectionParser [(AttrName, CustomAttr)]
 -&gt; IniParser (Maybe [(AttrName, CustomAttr)]))
-&gt; SectionParser [(AttrName, CustomAttr)]
-&gt; IniParser (Maybe [(AttrName, CustomAttr)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">[Maybe (AttrName, CustomAttr)] -&gt; [(AttrName, CustomAttr)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe (AttrName, CustomAttr)] -&gt; [(AttrName, CustomAttr)])
-&gt; SectionParser [Maybe (AttrName, CustomAttr)]
-&gt; SectionParser [(AttrName, CustomAttr)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AttrName]
-&gt; (AttrName -&gt; SectionParser (Maybe (AttrName, CustomAttr)))
-&gt; SectionParser [Maybe (AttrName, CustomAttr)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AttrName Attr -&gt; [AttrName]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map AttrName Attr -&gt; [AttrName])
-&gt; Map AttrName Attr -&gt; [AttrName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Map AttrName Attr
</span><a href="Brick.Themes.html#themeDefaultMapping"><span class="hs-identifier hs-var hs-var">themeDefaultMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368951"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((AttrName -&gt; SectionParser (Maybe (AttrName, CustomAttr)))
 -&gt; SectionParser [Maybe (AttrName, CustomAttr)])
-&gt; (AttrName -&gt; SectionParser (Maybe (AttrName, CustomAttr)))
-&gt; SectionParser [Maybe (AttrName, CustomAttr)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679368942"><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368942"><span class="hs-identifier hs-var">an</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-300"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CustomAttr -&gt; (AttrName, CustomAttr))
-&gt; Maybe CustomAttr -&gt; Maybe (AttrName, CustomAttr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368942"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe CustomAttr -&gt; Maybe (AttrName, CustomAttr))
-&gt; SectionParser (Maybe CustomAttr)
-&gt; SectionParser (Maybe (AttrName, CustomAttr))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SectionParser (Maybe CustomAttr)
</span><a href="#local-6989586621679368950"><span class="hs-identifier hs-var">parseCustomAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Text
</span><a href="Brick.Themes.html#makeFieldName"><span class="hs-identifier hs-var">makeFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Text) -&gt; [String] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; [String]
</span><a href="Brick.AttrMap.html#attrNameComponents"><span class="hs-identifier hs-var">attrNameComponents</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368942"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">(Maybe CustomAttr, Map AttrName CustomAttr)
-&gt; IniParser (Maybe CustomAttr, Map AttrName CustomAttr)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Maybe CustomAttr) -&gt; Maybe CustomAttr
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe CustomAttr)
</span><a href="#local-6989586621679368946"><span class="hs-identifier hs-var">defCustom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(AttrName, CustomAttr)] -&gt; Map AttrName CustomAttr
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(AttrName, CustomAttr)] -&gt; Map AttrName CustomAttr)
-&gt; [(AttrName, CustomAttr)] -&gt; Map AttrName CustomAttr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(AttrName, CustomAttr)]
-&gt; Maybe [(AttrName, CustomAttr)] -&gt; [(AttrName, CustomAttr)]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe [(AttrName, CustomAttr)]
</span><a href="#local-6989586621679368944"><span class="hs-identifier hs-var">customMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Apply customizations using a custom lookup function. Customizations</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- are obtained for each attribute name in the theme. Any customizations</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- already set are lost.</span><span>
</span><span id="line-308"></span><span class="annot"><a href="Brick.Themes.html#applyCustomizations"><span class="hs-identifier hs-type">applyCustomizations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span>
</span><span id="line-309"></span><span>                    </span><span class="hs-comment">-- ^ An optional customization for the theme's</span><span>
</span><span id="line-310"></span><span>                    </span><span class="hs-comment">-- default attribute.</span><span>
</span><span id="line-311"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>                    </span><span class="hs-comment">-- ^ A function to obtain a customization for the</span><span>
</span><span id="line-313"></span><span>                    </span><span class="hs-comment">-- specified attribute.</span><span>
</span><span id="line-314"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span>
</span><span id="line-315"></span><span>                    </span><span class="hs-comment">-- ^ The theme to customize.</span><span>
</span><span id="line-316"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span>
</span><span id="line-317"></span><span id="applyCustomizations"><span class="annot"><span class="annottext">applyCustomizations :: Maybe CustomAttr
-&gt; (AttrName -&gt; Maybe CustomAttr) -&gt; Theme -&gt; Theme
</span><a href="Brick.Themes.html#applyCustomizations"><span class="hs-identifier hs-var hs-var">applyCustomizations</span></a></span></span><span> </span><span id="local-6989586621679368940"><span class="annot"><span class="annottext">Maybe CustomAttr
</span><a href="#local-6989586621679368940"><span class="hs-identifier hs-var">customDefAttr</span></a></span></span><span> </span><span id="local-6989586621679368939"><span class="annot"><span class="annottext">AttrName -&gt; Maybe CustomAttr
</span><a href="#local-6989586621679368939"><span class="hs-identifier hs-var">lookupAttr</span></a></span></span><span> </span><span id="local-6989586621679368938"><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368938"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368937"><span class="annot"><span class="annottext">customMap :: Map AttrName CustomAttr
</span><a href="#local-6989586621679368937"><span class="hs-identifier hs-var hs-var">customMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AttrName -&gt; Map AttrName CustomAttr -&gt; Map AttrName CustomAttr)
-&gt; Map AttrName CustomAttr -&gt; [AttrName] -&gt; Map AttrName CustomAttr
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Map AttrName CustomAttr -&gt; Map AttrName CustomAttr
</span><a href="#local-6989586621679368936"><span class="hs-identifier hs-var">nextAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Map AttrName CustomAttr
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AttrName Attr -&gt; [AttrName]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map AttrName Attr -&gt; [AttrName])
-&gt; Map AttrName Attr -&gt; [AttrName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Map AttrName Attr
</span><a href="Brick.Themes.html#themeDefaultMapping"><span class="hs-identifier hs-var hs-var">themeDefaultMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368938"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>        </span><span id="local-6989586621679368936"><span class="annot"><span class="annottext">nextAttr :: AttrName -&gt; Map AttrName CustomAttr -&gt; Map AttrName CustomAttr
</span><a href="#local-6989586621679368936"><span class="hs-identifier hs-var hs-var">nextAttr</span></a></span></span><span> </span><span id="local-6989586621679368935"><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368935"><span class="hs-identifier hs-var">an</span></a></span></span><span> </span><span id="local-6989586621679368934"><span class="annot"><span class="annottext">Map AttrName CustomAttr
</span><a href="#local-6989586621679368934"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Maybe CustomAttr
</span><a href="#local-6989586621679368939"><span class="hs-identifier hs-var">lookupAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368935"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-320"></span><span>            </span><span class="annot"><span class="annottext">Maybe CustomAttr
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map AttrName CustomAttr
</span><a href="#local-6989586621679368934"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-321"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679368933"><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368933"><span class="hs-identifier hs-var">custom</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AttrName
-&gt; CustomAttr -&gt; Map AttrName CustomAttr -&gt; Map AttrName CustomAttr
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368935"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368933"><span class="hs-identifier hs-var">custom</span></a></span><span> </span><span class="annot"><span class="annottext">Map AttrName CustomAttr
</span><a href="#local-6989586621679368934"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368938"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">themeCustomDefaultAttr :: Maybe CustomAttr
</span><a href="Brick.Themes.html#themeCustomDefaultAttr"><span class="hs-identifier hs-var">themeCustomDefaultAttr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CustomAttr
</span><a href="#local-6989586621679368940"><span class="hs-identifier hs-var">customDefAttr</span></a></span><span>
</span><span id="line-323"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">themeCustomMapping :: Map AttrName CustomAttr
</span><a href="Brick.Themes.html#themeCustomMapping"><span class="hs-identifier hs-var">themeCustomMapping</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map AttrName CustomAttr
</span><a href="#local-6989586621679368937"><span class="hs-identifier hs-var">customMap</span></a></span><span>
</span><span id="line-324"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">-- | Load an INI file containing theme customizations. Use the specified</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- theme to determine which customizations to load. Return the specified</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- theme with customizations set. See the module documentation for the</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- theme file format.</span><span>
</span><span id="line-330"></span><span class="annot"><a href="Brick.Themes.html#loadCustomizations"><span class="hs-identifier hs-type">loadCustomizations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span id="loadCustomizations"><span class="annot"><span class="annottext">loadCustomizations :: String -&gt; Theme -&gt; IO (Either String Theme)
</span><a href="Brick.Themes.html#loadCustomizations"><span class="hs-identifier hs-var hs-var">loadCustomizations</span></a></span></span><span> </span><span id="local-6989586621679368930"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368930"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679368929"><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368929"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679368928"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368928"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Text
</span><span class="hs-identifier hs-var">T.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368930"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; IniParser (Maybe CustomAttr, Map AttrName CustomAttr)
-&gt; Either String (Maybe CustomAttr, Map AttrName CustomAttr)
forall a. Text -&gt; IniParser a -&gt; Either String a
</span><span class="hs-identifier hs-var">parseIniFile</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368928"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Theme -&gt; IniParser (Maybe CustomAttr, Map AttrName CustomAttr)
</span><a href="Brick.Themes.html#themeParser"><span class="hs-identifier hs-var">themeParser</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368929"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679368925"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368925"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either String Theme -&gt; IO (Either String Theme)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String Theme -&gt; IO (Either String Theme))
-&gt; Either String Theme -&gt; IO (Either String Theme)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Theme
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368925"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-335"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679368924"><span class="annot"><span class="annottext">Maybe CustomAttr
</span><a href="#local-6989586621679368924"><span class="hs-identifier hs-var">customDef</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679368923"><span class="annot"><span class="annottext">Map AttrName CustomAttr
</span><a href="#local-6989586621679368923"><span class="hs-identifier hs-var">customMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>            </span><span class="annot"><span class="annottext">Either String Theme -&gt; IO (Either String Theme)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String Theme -&gt; IO (Either String Theme))
-&gt; Either String Theme -&gt; IO (Either String Theme)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Either String Theme
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Theme -&gt; Either String Theme) -&gt; Theme -&gt; Either String Theme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe CustomAttr
-&gt; (AttrName -&gt; Maybe CustomAttr) -&gt; Theme -&gt; Theme
</span><a href="Brick.Themes.html#applyCustomizations"><span class="hs-identifier hs-var">applyCustomizations</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CustomAttr
</span><a href="#local-6989586621679368924"><span class="hs-identifier hs-var">customDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AttrName -&gt; Map AttrName CustomAttr -&gt; Maybe CustomAttr)
-&gt; Map AttrName CustomAttr -&gt; AttrName -&gt; Maybe CustomAttr
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Map AttrName CustomAttr -&gt; Maybe CustomAttr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Map AttrName CustomAttr
</span><a href="#local-6989586621679368923"><span class="hs-identifier hs-var">customMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368929"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Brick.Themes.html#vtyColorName"><span class="hs-identifier hs-type">vtyColorName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-339"></span><span id="vtyColorName"><span class="annot"><span class="annottext">vtyColorName :: Color -&gt; Text
</span><a href="Brick.Themes.html#vtyColorName"><span class="hs-identifier hs-var hs-var">vtyColorName</span></a></span></span><span> </span><span id="local-6989586621679368920"><span class="annot"><span class="annottext">c :: Color
</span><a href="#local-6989586621679368920"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Color240</span></span><span> </span><span id="local-6989586621679368918"><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368918"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Style -&gt; Maybe (Int, Int, Int)
</span><span class="hs-identifier hs-var">color240CodeToRGB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style -&gt; Style
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368918"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679368916"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679368916"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679368915"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679368915"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679368914"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679368914"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int -&gt; Int -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#%02x%02x%02x&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679368916"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679368915"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679368914"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Int, Int, Int)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid color: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679368920"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span class="annot"><a href="Brick.Themes.html#vtyColorName"><span class="hs-identifier hs-var">vtyColorName</span></a></span><span> </span><span id="local-6989586621679368910"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679368910"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Text
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid color: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679368910"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Color -&gt; [(Color, Text)] -&gt; Maybe Text
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679368910"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[(Color, Text)]
</span><a href="Brick.Themes.html#allColors"><span class="hs-identifier hs-var">allColors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="annot"><a href="Brick.Themes.html#makeFieldName"><span class="hs-identifier hs-type">makeFieldName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-347"></span><span id="makeFieldName"><span class="annot"><span class="annottext">makeFieldName :: [String] -&gt; Text
</span><a href="Brick.Themes.html#makeFieldName"><span class="hs-identifier hs-var hs-var">makeFieldName</span></a></span></span><span> </span><span id="local-6989586621679368909"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368909"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368909"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Brick.Themes.html#serializeCustomColor"><span class="hs-identifier hs-type">serializeCustomColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaybeDefault</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-350"></span><span id="serializeCustomColor"><span class="annot"><span class="annottext">serializeCustomColor :: [String] -&gt; MaybeDefault Color -&gt; Text
</span><a href="Brick.Themes.html#serializeCustomColor"><span class="hs-identifier hs-var hs-var">serializeCustomColor</span></a></span></span><span> </span><span id="local-6989586621679368907"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368907"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679368906"><span class="annot"><span class="annottext">MaybeDefault Color
</span><a href="#local-6989586621679368906"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368905"><span class="annot"><span class="annottext">cName :: Text
</span><a href="#local-6989586621679368905"><span class="hs-identifier hs-var hs-var">cName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color
</span><a href="#local-6989586621679368906"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-352"></span><span>          </span><span class="annot"><span class="annottext">MaybeDefault Color
</span><span class="hs-identifier hs-var">Default</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span>
</span><span id="line-353"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">SetTo</span></span><span> </span><span id="local-6989586621679368904"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679368904"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Color -&gt; Text
</span><a href="Brick.Themes.html#vtyColorName"><span class="hs-identifier hs-var">vtyColorName</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679368904"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-354"></span><span>          </span><span class="annot"><span class="annottext">MaybeDefault Color
</span><span class="hs-identifier hs-var">KeepCurrent</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;serializeCustomColor does not support KeepCurrent&quot;</span></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Text
</span><a href="Brick.Themes.html#makeFieldName"><span class="hs-identifier hs-var">makeFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368907"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368905"><span class="hs-identifier hs-var">cName</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Brick.Themes.html#serializeCustomStyle"><span class="hs-identifier hs-type">serializeCustomStyle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Style</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-358"></span><span id="serializeCustomStyle"><span class="annot"><span class="annottext">serializeCustomStyle :: [String] -&gt; Style -&gt; Text
</span><a href="Brick.Themes.html#serializeCustomStyle"><span class="hs-identifier hs-var hs-var">serializeCustomStyle</span></a></span></span><span> </span><span id="local-6989586621679368901"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368901"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679368900"><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368900"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368899"><span class="annot"><span class="annottext">activeStyles :: [(Text, Style)]
</span><a href="#local-6989586621679368899"><span class="hs-identifier hs-var hs-var">activeStyles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Text, Style) -&gt; Bool) -&gt; [(Text, Style)] -&gt; [(Text, Style)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679368898"><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368898"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368898"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Style -&gt; Style -&gt; Style
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368900"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Style -&gt; Style -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368898"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Style)]
</span><a href="Brick.Themes.html#allStyles"><span class="hs-identifier hs-var">allStyles</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span id="local-6989586621679368897"><span class="annot"><span class="annottext">styleStr :: Text
</span><a href="#local-6989586621679368897"><span class="hs-identifier hs-var hs-var">styleStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Text, Style)]
</span><a href="#local-6989586621679368899"><span class="hs-identifier hs-var">activeStyles</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-361"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679368896"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368896"><span class="hs-identifier hs-var">single</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368896"><span class="hs-identifier hs-var">single</span></a></span><span>
</span><span id="line-362"></span><span>            </span><span id="local-6989586621679368895"><span class="annot"><span class="annottext">[(Text, Style)]
</span><a href="#local-6989586621679368895"><span class="hs-identifier hs-var">many</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Text, Style) -&gt; Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Text, Style) -&gt; Text) -&gt; [(Text, Style)] -&gt; [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Style)]
</span><a href="#local-6989586621679368895"><span class="hs-identifier hs-var">many</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Text
</span><a href="Brick.Themes.html#makeFieldName"><span class="hs-identifier hs-var">makeFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368901"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368897"><span class="hs-identifier hs-var">styleStr</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="annot"><a href="Brick.Themes.html#serializeCustomAttr"><span class="hs-identifier hs-type">serializeCustomAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-366"></span><span id="serializeCustomAttr"><span class="annot"><span class="annottext">serializeCustomAttr :: [String] -&gt; CustomAttr -&gt; [Text]
</span><a href="Brick.Themes.html#serializeCustomAttr"><span class="hs-identifier hs-var hs-var">serializeCustomAttr</span></a></span></span><span> </span><span id="local-6989586621679368892"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368892"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679368891"><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368891"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">[Maybe Text] -&gt; [Text]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; MaybeDefault Color -&gt; Text
</span><a href="Brick.Themes.html#serializeCustomColor"><span class="hs-identifier hs-var">serializeCustomColor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368892"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fg&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MaybeDefault Color -&gt; Text)
-&gt; Maybe (MaybeDefault Color) -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customFg"><span class="hs-identifier hs-var hs-var">customFg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368891"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-368"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; MaybeDefault Color -&gt; Text
</span><a href="Brick.Themes.html#serializeCustomColor"><span class="hs-identifier hs-var">serializeCustomColor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368892"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bg&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MaybeDefault Color -&gt; Text)
-&gt; Maybe (MaybeDefault Color) -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customBg"><span class="hs-identifier hs-var hs-var">customBg</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368891"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-369"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Style -&gt; Text
</span><a href="Brick.Themes.html#serializeCustomStyle"><span class="hs-identifier hs-var">serializeCustomStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679368892"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;style&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Style -&gt; Text) -&gt; Maybe Style -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe Style
</span><a href="Brick.Themes.html#customStyle"><span class="hs-identifier hs-var hs-var">customStyle</span></a></span><span> </span><span class="annot"><span class="annottext">CustomAttr
</span><a href="#local-6989586621679368891"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-370"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="annot"><a href="Brick.Themes.html#emitSection"><span class="hs-identifier hs-type">emitSection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span id="emitSection"><span class="annot"><span class="annottext">emitSection :: Text -&gt; [Text] -&gt; [Text]
</span><a href="Brick.Themes.html#emitSection"><span class="hs-identifier hs-var hs-var">emitSection</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-374"></span><span class="annot"><a href="Brick.Themes.html#emitSection"><span class="hs-identifier hs-var">emitSection</span></a></span><span> </span><span id="local-6989586621679368889"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368889"><span class="hs-identifier hs-var">secName</span></a></span></span><span> </span><span id="local-6989586621679368888"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679368888"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368889"><span class="hs-identifier hs-var">secName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679368888"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Save an INI file containing theme customizations. Use the specified</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- theme to determine which customizations to save. See the module</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- documentation for the theme file format.</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Brick.Themes.html#saveCustomizations"><span class="hs-identifier hs-type">saveCustomizations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span id="saveCustomizations"><span class="annot"><span class="annottext">saveCustomizations :: String -&gt; Theme -&gt; IO ()
</span><a href="Brick.Themes.html#saveCustomizations"><span class="hs-identifier hs-var hs-var">saveCustomizations</span></a></span></span><span> </span><span id="local-6989586621679368887"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368887"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679368886"><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368886"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368885"><span class="annot"><span class="annottext">defSection :: [Text]
</span><a href="#local-6989586621679368885"><span class="hs-identifier hs-var hs-var">defSection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Maybe [Text] -&gt; [Text]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [Text] -&gt; [Text]) -&gt; Maybe [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-382"></span><span>                     </span><span class="annot"><span class="annottext">[String] -&gt; CustomAttr -&gt; [Text]
</span><a href="Brick.Themes.html#serializeCustomAttr"><span class="hs-identifier hs-var">serializeCustomAttr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;default&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(CustomAttr -&gt; [Text]) -&gt; Maybe CustomAttr -&gt; Maybe [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Maybe CustomAttr
</span><a href="Brick.Themes.html#themeCustomDefaultAttr"><span class="hs-identifier hs-var hs-var">themeCustomDefaultAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368886"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-383"></span><span>        </span><span id="local-6989586621679368884"><span class="annot"><span class="annottext">mapSection :: [Text]
</span><a href="#local-6989586621679368884"><span class="hs-identifier hs-var hs-var">mapSection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Text]] -&gt; [Text]) -&gt; [[Text]] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((AttrName -&gt; [Text]) -&gt; [AttrName] -&gt; [[Text]])
-&gt; [AttrName] -&gt; (AttrName -&gt; [Text]) -&gt; [[Text]]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(AttrName -&gt; [Text]) -&gt; [AttrName] -&gt; [[Text]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AttrName Attr -&gt; [AttrName]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map AttrName Attr -&gt; [AttrName])
-&gt; Map AttrName Attr -&gt; [AttrName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Map AttrName Attr
</span><a href="Brick.Themes.html#themeDefaultMapping"><span class="hs-identifier hs-var hs-var">themeDefaultMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368886"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((AttrName -&gt; [Text]) -&gt; [[Text]])
-&gt; (AttrName -&gt; [Text]) -&gt; [[Text]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679368882"><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368882"><span class="hs-identifier hs-var">an</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-384"></span><span>            </span><span class="annot"><span class="annottext">[Text] -&gt; (CustomAttr -&gt; [Text]) -&gt; Maybe CustomAttr -&gt; [Text]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; CustomAttr -&gt; [Text]
</span><a href="Brick.Themes.html#serializeCustomAttr"><span class="hs-identifier hs-var">serializeCustomAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AttrName -&gt; [String]
</span><a href="Brick.AttrMap.html#attrNameComponents"><span class="hs-identifier hs-var">attrNameComponents</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368882"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe CustomAttr -&gt; [Text]) -&gt; Maybe CustomAttr -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-385"></span><span>                     </span><span class="annot"><span class="annottext">AttrName -&gt; Map AttrName CustomAttr -&gt; Maybe CustomAttr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368882"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">(Map AttrName CustomAttr -&gt; Maybe CustomAttr)
-&gt; Map AttrName CustomAttr -&gt; Maybe CustomAttr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Map AttrName CustomAttr
</span><a href="Brick.Themes.html#themeCustomMapping"><span class="hs-identifier hs-var hs-var">themeCustomMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368886"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-386"></span><span>        </span><span id="local-6989586621679368881"><span class="annot"><span class="annottext">content :: Text
</span><a href="#local-6989586621679368881"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unlines</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
</span><a href="Brick.Themes.html#emitSection"><span class="hs-identifier hs-var">emitSection</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Brick.Themes.html#defaultSectionName"><span class="hs-identifier hs-var">defaultSectionName</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679368885"><span class="hs-identifier hs-var">defSection</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Text] -&gt; [Text]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-387"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
</span><a href="Brick.Themes.html#emitSection"><span class="hs-identifier hs-var">emitSection</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Brick.Themes.html#otherSectionName"><span class="hs-identifier hs-var">otherSectionName</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679368884"><span class="hs-identifier hs-var">mapSection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var">T.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368887"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368881"><span class="hs-identifier hs-var">content</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">-- | Save an INI file containing all attributes from the specified</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- theme. Customized attributes are saved, but if an attribute is not</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- customized, its default is saved instead. The file can later be</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- re-loaded as a customization file.</span><span>
</span><span id="line-394"></span><span class="annot"><a href="Brick.Themes.html#saveTheme"><span class="hs-identifier hs-type">saveTheme</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Themes.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span id="saveTheme"><span class="annot"><span class="annottext">saveTheme :: String -&gt; Theme -&gt; IO ()
</span><a href="Brick.Themes.html#saveTheme"><span class="hs-identifier hs-var hs-var">saveTheme</span></a></span></span><span> </span><span id="local-6989586621679368878"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368878"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679368877"><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368877"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679368876"><span class="annot"><span class="annottext">defSection :: [Text]
</span><a href="#local-6989586621679368876"><span class="hs-identifier hs-var hs-var">defSection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; CustomAttr -&gt; [Text]
</span><a href="Brick.Themes.html#serializeCustomAttr"><span class="hs-identifier hs-var">serializeCustomAttr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;default&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(CustomAttr -&gt; [Text]) -&gt; CustomAttr -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-397"></span><span>                     </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe CustomAttr -&gt; CustomAttr
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; CustomAttr
</span><a href="Brick.Themes.html#attrToCustom"><span class="hs-identifier hs-var">attrToCustom</span></a></span><span> </span><span class="annot"><span class="annottext">(Attr -&gt; CustomAttr) -&gt; Attr -&gt; CustomAttr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Attr
</span><a href="Brick.Themes.html#themeDefaultAttr"><span class="hs-identifier hs-var hs-var">themeDefaultAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368877"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Theme -&gt; Maybe CustomAttr
</span><a href="Brick.Themes.html#themeCustomDefaultAttr"><span class="hs-identifier hs-var hs-var">themeCustomDefaultAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368877"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>        </span><span id="local-6989586621679368874"><span class="annot"><span class="annottext">mapSection :: [Text]
</span><a href="#local-6989586621679368874"><span class="hs-identifier hs-var hs-var">mapSection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Text]] -&gt; [Text]) -&gt; [[Text]] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((AttrName, Attr) -&gt; [Text]) -&gt; [(AttrName, Attr)] -&gt; [[Text]])
-&gt; [(AttrName, Attr)] -&gt; ((AttrName, Attr) -&gt; [Text]) -&gt; [[Text]]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((AttrName, Attr) -&gt; [Text]) -&gt; [(AttrName, Attr)] -&gt; [[Text]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map AttrName Attr -&gt; [(AttrName, Attr)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map AttrName Attr -&gt; [(AttrName, Attr)])
-&gt; Map AttrName Attr -&gt; [(AttrName, Attr)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Map AttrName Attr
</span><a href="Brick.Themes.html#themeDefaultMapping"><span class="hs-identifier hs-var hs-var">themeDefaultMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368877"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((AttrName, Attr) -&gt; [Text]) -&gt; [[Text]])
-&gt; ((AttrName, Attr) -&gt; [Text]) -&gt; [[Text]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679368873"><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368873"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679368872"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679368872"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; CustomAttr -&gt; [Text]
</span><a href="Brick.Themes.html#serializeCustomAttr"><span class="hs-identifier hs-var">serializeCustomAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AttrName -&gt; [String]
</span><a href="Brick.AttrMap.html#attrNameComponents"><span class="hs-identifier hs-var">attrNameComponents</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368873"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CustomAttr -&gt; [Text]) -&gt; CustomAttr -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-400"></span><span>                </span><span class="annot"><span class="annottext">CustomAttr -&gt; Maybe CustomAttr -&gt; CustomAttr
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; CustomAttr
</span><a href="Brick.Themes.html#attrToCustom"><span class="hs-identifier hs-var">attrToCustom</span></a></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679368872"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AttrName -&gt; Map AttrName CustomAttr -&gt; Maybe CustomAttr
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="#local-6989586621679368873"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">(Map AttrName CustomAttr -&gt; Maybe CustomAttr)
-&gt; Map AttrName CustomAttr -&gt; Maybe CustomAttr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Theme -&gt; Map AttrName CustomAttr
</span><a href="Brick.Themes.html#themeCustomMapping"><span class="hs-identifier hs-var hs-var">themeCustomMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Theme
</span><a href="#local-6989586621679368877"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>        </span><span id="local-6989586621679368871"><span class="annot"><span class="annottext">content :: Text
</span><a href="#local-6989586621679368871"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unlines</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
</span><a href="Brick.Themes.html#emitSection"><span class="hs-identifier hs-var">emitSection</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Brick.Themes.html#defaultSectionName"><span class="hs-identifier hs-var">defaultSectionName</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679368876"><span class="hs-identifier hs-var">defSection</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Text] -&gt; [Text]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-402"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
</span><a href="Brick.Themes.html#emitSection"><span class="hs-identifier hs-var">emitSection</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Brick.Themes.html#otherSectionName"><span class="hs-identifier hs-var">otherSectionName</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679368874"><span class="hs-identifier hs-var">mapSection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var">T.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679368878"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679368871"><span class="hs-identifier hs-var">content</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="annot"><a href="Brick.Themes.html#attrToCustom"><span class="hs-identifier hs-type">attrToCustom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Attr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span>
</span><span id="line-406"></span><span id="attrToCustom"><span class="annot"><span class="annottext">attrToCustom :: Attr -&gt; CustomAttr
</span><a href="Brick.Themes.html#attrToCustom"><span class="hs-identifier hs-var hs-var">attrToCustom</span></a></span></span><span> </span><span id="local-6989586621679368870"><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679368870"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">CustomAttr :: Maybe (MaybeDefault Color)
-&gt; Maybe (MaybeDefault Color) -&gt; Maybe Style -&gt; CustomAttr
</span><a href="Brick.Themes.html#CustomAttr"><span class="hs-identifier hs-type">CustomAttr</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">customFg :: Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customFg"><span class="hs-identifier hs-var">customFg</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color -&gt; Maybe (MaybeDefault Color)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MaybeDefault Color -&gt; Maybe (MaybeDefault Color))
-&gt; MaybeDefault Color -&gt; Maybe (MaybeDefault Color)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; MaybeDefault Color
</span><span class="hs-identifier hs-var hs-var">attrForeColor</span></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679368870"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-408"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">customBg :: Maybe (MaybeDefault Color)
</span><a href="Brick.Themes.html#customBg"><span class="hs-identifier hs-var">customBg</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeDefault Color -&gt; Maybe (MaybeDefault Color)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MaybeDefault Color -&gt; Maybe (MaybeDefault Color))
-&gt; MaybeDefault Color -&gt; Maybe (MaybeDefault Color)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; MaybeDefault Color
</span><span class="hs-identifier hs-var hs-var">attrForeColor</span></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679368870"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-409"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">customStyle :: Maybe Style
</span><a href="Brick.Themes.html#customStyle"><span class="hs-identifier hs-var">customStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Attr -&gt; MaybeDefault Style
</span><span class="hs-identifier hs-var hs-var">attrStyle</span></span><span> </span><span class="annot"><span class="annottext">Attr
</span><a href="#local-6989586621679368870"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-410"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">SetTo</span></span><span> </span><span id="local-6989586621679368869"><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368869"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Style -&gt; Maybe Style
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679368869"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-411"></span><span>                   </span><span class="annot"><span class="annottext">MaybeDefault Style
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Style
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-412"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-413"></span></pre></body></html>