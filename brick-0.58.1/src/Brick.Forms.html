<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | NOTE: This API is experimental and will probably change. Please try</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- it out! Feedback is very much appreciated, and your patience in the</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- face of breaking API changes is also appreciated! It's also worth</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- bearing in mind that this API is designed to support a narrow range</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- of use cases. If you find that you need more customization than this</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- offers, then you will need to consider building your own layout and</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- event handling for input fields.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- For a fuller introduction to this API, see the &quot;Input Forms&quot; section</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- of the Brick User Guide. Also see the demonstration programs for</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- examples of forms in action.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- This module provides an input form API. This API allows you to</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- construct an input interface based on a data type of your choice.</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Each input in the form corresponds to a field in your data type. This</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- API then automatically dispatches keyboard and mouse input events to</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- each form input field, manages rendering of the form, notifies the</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- user when a form field's value is invalid, and stores valid inputs in</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- your data type when possible.</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- A form has both a visual representation and a corresponding data</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- structure representing the latest valid values for that form</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- (referred to as the &quot;state&quot; of the form). A 'FormField' is a single</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- input component in the form and a 'FormFieldState' defines the</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- linkage between that visual input and the corresponding portion</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- of the state represented by that visual; there may be multiple</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- 'FormField's combined for a single 'FormFieldState' (e.g. a radio</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- button sequence).</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- Also note that, by default, forms and their field inputs are</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- concatenated together in a 'vBox'. This can be customized on a</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- per-field basis and for the entire form by using the functions</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- 'setFieldConcat' and 'setFormConcat', respectively.</span><span>
</span><span id="line-39"></span><span class="hs-comment">--</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- Bear in mind that for most uses, the 'FormField' and 'FormFieldState'</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- types will not be used directly. Instead, the constructors for</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- various field types (such as 'editTextField') will be used instead.</span><span>
</span><span id="line-43"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Brick.Forms</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Data types</span></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier">Form</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier">FormFieldState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormField"><span class="hs-identifier">FormField</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Creating and using forms</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#newForm"><span class="hs-identifier">newForm</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#formFocus"><span class="hs-identifier">formFocus</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#formState"><span class="hs-identifier">formState</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier">handleFormEvent</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#renderForm"><span class="hs-identifier">renderForm</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#renderFormFieldState"><span class="hs-identifier">renderFormFieldState</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#%40%40%3D"><span class="hs-operator">(@@=)</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#allFieldsValid"><span class="hs-identifier">allFieldsValid</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#invalidFields"><span class="hs-identifier">invalidFields</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#setFieldValid"><span class="hs-identifier">setFieldValid</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#setFormConcat"><span class="hs-identifier">setFormConcat</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#setFieldConcat"><span class="hs-identifier">setFieldConcat</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#setFormFocus"><span class="hs-identifier">setFormFocus</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#updateFormState"><span class="hs-identifier">updateFormState</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Simple form field constructors</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#editTextField"><span class="hs-identifier">editTextField</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#editShowableField"><span class="hs-identifier">editShowableField</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#editPasswordField"><span class="hs-identifier">editPasswordField</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#radioField"><span class="hs-identifier">radioField</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#checkboxField"><span class="hs-identifier">checkboxField</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#listField"><span class="hs-identifier">listField</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Advanced form field constructors</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#editField"><span class="hs-identifier">editField</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#radioCustomField"><span class="hs-identifier">radioCustomField</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#checkboxCustomField"><span class="hs-identifier">checkboxCustomField</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Attributes</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#formAttr"><span class="hs-identifier">formAttr</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#invalidFormInputAttr"><span class="hs-identifier">invalidFormInputAttr</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Brick.Forms.html#focusedFormInputAttr"><span class="hs-identifier">focusedFormInputAttr</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.Vty</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showCursor</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !(MIN_VERSION_base(4,11,0))
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">elemIndex</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.html"><span class="hs-identifier">Brick</span></a></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.Focus.html"><span class="hs-identifier">Brick.Focus</span></a></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.Widgets.Edit.html"><span class="hs-identifier">Brick.Widgets.Edit</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Brick.Widgets.List.html"><span class="hs-identifier">Brick.Widgets.List</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Zipper</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Z</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | A form field. This represents an interactive input field in the</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- form. Its user input is validated and thus converted into a type of</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- your choosing.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- Type variables are as follows:</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">--  * @a@ - the type of the field in your form state that this field</span><span>
</span><span id="line-111"></span><span class="hs-comment">--    manipulates</span><span>
</span><span id="line-112"></span><span class="hs-comment">--  * @b@ - the form field's internal state type</span><span>
</span><span id="line-113"></span><span class="hs-comment">--  * @e@ - your application's event type</span><span>
</span><span id="line-114"></span><span class="hs-comment">--  * @n@ - your application's resource name type</span><span>
</span><span id="line-115"></span><span class="hs-keyword">data</span><span> </span><span id="FormField"><span class="annot"><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-var">FormField</span></a></span></span><span> </span><span id="local-6989586621679376068"><span class="annot"><a href="#local-6989586621679376068"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679376067"><span class="annot"><a href="#local-6989586621679376067"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679376066"><span class="annot"><a href="#local-6989586621679376066"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679376065"><span class="annot"><a href="#local-6989586621679376065"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>    </span><span id="FormField"><span class="annot"><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-var">FormField</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="formFieldName"><span class="annot"><span class="annottext">FormField a b e n -&gt; n
</span><a href="Brick.Forms.html#formFieldName"><span class="hs-identifier hs-var hs-var">formFieldName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679376065"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-117"></span><span>              </span><span class="hs-comment">-- ^ The name identifying this form field.</span><span>
</span><span id="line-118"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="formFieldValidate"><span class="annot"><span class="annottext">FormField a b e n -&gt; b -&gt; Maybe a
</span><a href="Brick.Forms.html#formFieldValidate"><span class="hs-identifier hs-var hs-var">formFieldValidate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679376067"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679376068"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-119"></span><span>              </span><span class="hs-comment">-- ^ A validation function converting this field's state</span><span>
</span><span id="line-120"></span><span>              </span><span class="hs-comment">-- into a value of your choosing. @Nothing@ indicates a</span><span>
</span><span id="line-121"></span><span>              </span><span class="hs-comment">-- validation failure. For example, this might validate</span><span>
</span><span id="line-122"></span><span>              </span><span class="hs-comment">-- an 'Editor' state value by parsing its text contents s</span><span>
</span><span id="line-123"></span><span>              </span><span class="hs-comment">-- aan integer and return 'Maybe' 'Int'. This is for pure</span><span>
</span><span id="line-124"></span><span>              </span><span class="hs-comment">-- avalue validation; if additional validation is required</span><span>
</span><span id="line-125"></span><span>              </span><span class="hs-comment">-- a(e.g. via 'IO'), use this field's state value in an</span><span>
</span><span id="line-126"></span><span>              </span><span class="hs-comment">-- aexternal validation routine and use 'setFieldValid' to</span><span>
</span><span id="line-127"></span><span>              </span><span class="hs-comment">-- afeed the result back into the form.</span><span>
</span><span id="line-128"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="formFieldExternallyValid"><span class="annot"><span class="annottext">FormField a b e n -&gt; Bool
</span><a href="Brick.Forms.html#formFieldExternallyValid"><span class="hs-identifier hs-var hs-var">formFieldExternallyValid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-129"></span><span>              </span><span class="hs-comment">-- ^ Whether the field is valid according to an external</span><span>
</span><span id="line-130"></span><span>              </span><span class="hs-comment">-- validation source. Defaults to always being 'True' and</span><span>
</span><span id="line-131"></span><span>              </span><span class="hs-comment">-- can be set with 'setFieldValid'. The value of this</span><span>
</span><span id="line-132"></span><span>              </span><span class="hs-comment">-- field also affects the behavior of 'allFieldsValid' and</span><span>
</span><span id="line-133"></span><span>              </span><span class="hs-comment">-- 'getInvalidFields'.</span><span>
</span><span id="line-134"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="formFieldRender"><span class="annot"><span class="annottext">FormField a b e n -&gt; Bool -&gt; b -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldRender"><span class="hs-identifier hs-var hs-var">formFieldRender</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679376067"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376065"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-135"></span><span>              </span><span class="hs-comment">-- ^ A function to render this form field. Parameters are</span><span>
</span><span id="line-136"></span><span>              </span><span class="hs-comment">-- whether the field is currently focused, followed by the</span><span>
</span><span id="line-137"></span><span>              </span><span class="hs-comment">-- field state.</span><span>
</span><span id="line-138"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="formFieldHandleEvent"><span class="annot"><span class="annottext">FormField a b e n -&gt; BrickEvent n e -&gt; b -&gt; EventM n b
</span><a href="Brick.Forms.html#formFieldHandleEvent"><span class="hs-identifier hs-var hs-var">formFieldHandleEvent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Types.Internal.html#BrickEvent"><span class="hs-identifier hs-type">BrickEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376065"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376066"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679376067"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376065"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376067"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-139"></span><span>              </span><span class="hs-comment">-- ^ An event handler for this field. This receives the</span><span>
</span><span id="line-140"></span><span>              </span><span class="hs-comment">-- event and the field state and returns a new field</span><span>
</span><span id="line-141"></span><span>              </span><span class="hs-comment">-- state.</span><span>
</span><span id="line-142"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | A form field state accompanied by the fields that manipulate that</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- state. The idea is that some record field in your form state has</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- one or more form fields that manipulate that value. This data type</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- maps that state field (using a lens into your state) to the form</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- input fields responsible for managing that state field, along with</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- a current value for that state field and an optional function to</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- control how the form inputs are rendered.</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- Most form fields will just have one input, such as text editors, but</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- others, such as radio button collections, will have many, which is</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- why this type supports more than one input corresponding to a state</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- field.</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- Type variables are as follows:</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">--  * @s@ - the data type containing the value manipulated by these form</span><span>
</span><span id="line-160"></span><span class="hs-comment">--    fields.</span><span>
</span><span id="line-161"></span><span class="hs-comment">--  * @e@ - your application's event type</span><span>
</span><span id="line-162"></span><span class="hs-comment">--  * @n@ - your application's resource name type</span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="FormFieldState"><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-var">FormFieldState</span></a></span></span><span> </span><span id="local-6989586621679375820"><span class="annot"><a href="#local-6989586621679375820"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679375819"><span class="annot"><a href="#local-6989586621679375819"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679375818"><span class="annot"><a href="#local-6989586621679375818"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679375816"><span id="local-6989586621679375817"><span id="local-6989586621679376118"><span id="local-6989586621679376119"><span id="local-6989586621679376120"><span id="FormFieldState"><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-var">FormFieldState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><span id="formFieldState"><span class="annot"><span class="annottext">()
</span><a href="Brick.Forms.html#formFieldState"><span class="hs-identifier hs-var hs-var">formFieldState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679375817"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-165"></span><span>                      </span><span class="hs-comment">-- ^ The current state value associated with</span><span>
</span><span id="line-166"></span><span>                      </span><span class="hs-comment">-- the field collection. Note that this type is</span><span>
</span><span id="line-167"></span><span>                      </span><span class="hs-comment">-- existential. All form fields in the collection</span><span>
</span><span id="line-168"></span><span>                      </span><span class="hs-comment">-- must validate to this type.</span><span>
</span><span id="line-169"></span><span>                      </span><span class="hs-special">,</span><span> </span><span id="formFieldLens"><span class="annot"><span class="annottext">()
</span><a href="Brick.Forms.html#formFieldLens"><span class="hs-identifier hs-var hs-var">formFieldLens</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679376120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375816"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-170"></span><span>                      </span><span class="hs-comment">-- ^ A lens to extract and store a</span><span>
</span><span id="line-171"></span><span>                      </span><span class="hs-comment">-- successfully-validated form input back into</span><span>
</span><span id="line-172"></span><span>                      </span><span class="hs-comment">-- your form state.</span><span>
</span><span id="line-173"></span><span>                      </span><span class="hs-special">,</span><span> </span><span id="formFieldUpdate"><span class="annot"><span class="annottext">()
</span><a href="Brick.Forms.html#formFieldUpdate"><span class="hs-identifier hs-var hs-var">formFieldUpdate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679375816"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375817"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375817"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-174"></span><span>                      </span><span class="hs-comment">-- ^ Given a new form state value, update the form</span><span>
</span><span id="line-175"></span><span>                      </span><span class="hs-comment">-- field state in place.</span><span>
</span><span id="line-176"></span><span>                      </span><span class="hs-special">,</span><span> </span><span id="formFields"><span class="annot"><span class="annottext">()
</span><a href="Brick.Forms.html#formFields"><span class="hs-identifier hs-var hs-var">formFields</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-type">FormField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375816"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375817"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376119"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376118"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>                      </span><span class="hs-comment">-- ^ The form fields, in order, that the user will</span><span>
</span><span id="line-178"></span><span>                      </span><span class="hs-comment">-- interact with to manipulate this state value.</span><span>
</span><span id="line-179"></span><span>                      </span><span class="hs-special">,</span><span> </span><span id="formFieldRenderHelper"><span class="annot"><span class="annottext">FormFieldState s e n -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldRenderHelper"><span class="hs-identifier hs-var hs-var">formFieldRenderHelper</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376118"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376118"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-180"></span><span>                      </span><span class="hs-comment">-- ^ A helper function to augment the rendered</span><span>
</span><span id="line-181"></span><span>                      </span><span class="hs-comment">-- representation of this collection of form</span><span>
</span><span id="line-182"></span><span>                      </span><span class="hs-comment">-- fields. It receives the default representation</span><span>
</span><span id="line-183"></span><span>                      </span><span class="hs-comment">-- and can augment it, for example, by adding a</span><span>
</span><span id="line-184"></span><span>                      </span><span class="hs-comment">-- label on the left.</span><span>
</span><span id="line-185"></span><span>                      </span><span class="hs-special">,</span><span> </span><span id="formFieldConcat"><span class="annot"><span class="annottext">FormFieldState s e n -&gt; [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldConcat"><span class="hs-identifier hs-var hs-var">formFieldConcat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376118"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376118"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-186"></span><span>                      </span><span class="hs-comment">-- ^ Concatenation function for this field's input</span><span>
</span><span id="line-187"></span><span>                      </span><span class="hs-comment">-- renderings.</span><span>
</span><span id="line-188"></span><span>                      </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376120"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376119"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376118"><span class="hs-identifier hs-type">n</span></a></span></span></span></span></span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | A form: a sequence of input fields that manipulate the fields of an</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- underlying state that you choose.</span><span>
</span><span id="line-192"></span><span class="hs-comment">--</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- Type variables are as follows:</span><span>
</span><span id="line-194"></span><span class="hs-comment">--</span><span>
</span><span id="line-195"></span><span class="hs-comment">--  * @s@ - the data type of your choosing containing the values</span><span>
</span><span id="line-196"></span><span class="hs-comment">--    manipulated by the fields in this form.</span><span>
</span><span id="line-197"></span><span class="hs-comment">--  * @e@ - your application's event type</span><span>
</span><span id="line-198"></span><span class="hs-comment">--  * @n@ - your application's resource name type</span><span>
</span><span id="line-199"></span><span class="hs-keyword">data</span><span> </span><span id="Form"><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-var">Form</span></a></span></span><span> </span><span id="local-6989586621679376103"><span class="annot"><a href="#local-6989586621679376103"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679376102"><span class="annot"><a href="#local-6989586621679376102"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679376101"><span class="annot"><a href="#local-6989586621679376101"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>    </span><span id="Form"><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-var">Form</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="formFieldStates"><span class="annot"><span class="annottext">Form s e n -&gt; [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var hs-var">formFieldStates</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376103"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376102"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376101"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="formFocus"><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Focus.html#FocusRing"><span class="hs-identifier hs-type">FocusRing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376101"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-202"></span><span>         </span><span class="hs-comment">-- ^ The focus ring for the form, indicating which form field</span><span>
</span><span id="line-203"></span><span>         </span><span class="hs-comment">-- has input focus.</span><span>
</span><span id="line-204"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="formState"><span class="annot"><span class="annottext">Form s e n -&gt; s
</span><a href="Brick.Forms.html#formState"><span class="hs-identifier hs-var hs-var">formState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679376103"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-205"></span><span>         </span><span class="hs-comment">-- ^ The current state of the form. Forms guarantee that only</span><span>
</span><span id="line-206"></span><span>         </span><span class="hs-comment">-- valid inputs ever get stored in the state, and that after</span><span>
</span><span id="line-207"></span><span>         </span><span class="hs-comment">-- each input event on a form field, if that field contains a</span><span>
</span><span id="line-208"></span><span>         </span><span class="hs-comment">-- valid state value then the value is immediately saved to its</span><span>
</span><span id="line-209"></span><span>         </span><span class="hs-comment">-- corresponding field in this state value using the form</span><span>
</span><span id="line-210"></span><span>         </span><span class="hs-comment">-- field's lens over @s@.</span><span>
</span><span id="line-211"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="formConcatAll"><span class="annot"><span class="annottext">Form s e n -&gt; [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formConcatAll"><span class="hs-identifier hs-var hs-var">formConcatAll</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376101"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376101"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-212"></span><span>         </span><span class="hs-comment">-- ^ Concatenation function for this form's field renderings.</span><span>
</span><span id="line-213"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Compose a new rendering augmentation function with the one in the</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- form field collection. For example, we might put a label on the left</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- side of a form field:</span><span>
</span><span id="line-218"></span><span class="hs-comment">--</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- &gt; (str &quot;Please check: &quot; &lt;+&gt;) @@= checkboxField alive AliveField &quot;Alive?&quot;</span><span>
</span><span id="line-220"></span><span class="hs-comment">--</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- This can also be used to add multiple augmentations and associates</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- right:</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- &gt; (withDefAttr someAttribute) @@=</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- &gt; (str &quot;Please check: &quot; &lt;+&gt;) @@=</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- &gt;   checkboxField alive AliveField &quot;Alive?&quot;</span><span>
</span><span id="line-227"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Brick.Forms.html#%40%40%3D"><span class="hs-operator hs-type">@@=</span></a></span><span>
</span><span id="line-228"></span><span id="local-6989586621679375803"><span id="local-6989586621679375804"><span id="local-6989586621679375805"><span class="annot"><a href="Brick.Forms.html#%40%40%3D"><span class="hs-operator hs-type">(@@=)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375805"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375805"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679375804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375803"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375805"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375803"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375805"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-229"></span><span id="%40%40%3D"><span class="annot"><span class="annottext">@@= :: (Widget n -&gt; Widget n)
-&gt; (s -&gt; FormFieldState s e n) -&gt; s -&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#%40%40%3D"><span class="hs-operator hs-var hs-var">(@@=)</span></a></span></span><span> </span><span id="local-6989586621679375802"><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375802"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679375801"><span class="annot"><span class="annottext">s -&gt; FormFieldState s e n
</span><a href="#local-6989586621679375801"><span class="hs-identifier hs-var">mkFs</span></a></span></span><span> </span><span id="local-6989586621679375800"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375800"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375799"><span class="annot"><span class="annottext">v :: FormFieldState s e n
</span><a href="#local-6989586621679375799"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; FormFieldState s e n
</span><a href="#local-6989586621679375801"><span class="hs-identifier hs-var">mkFs</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375800"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375799"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldRenderHelper :: Widget n -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldRenderHelper"><span class="hs-identifier hs-var">formFieldRenderHelper</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375802"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FormFieldState s e n -&gt; Widget n -&gt; Widget n
forall s e n. FormFieldState s e n -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldRenderHelper"><span class="hs-identifier hs-var hs-var">formFieldRenderHelper</span></a></span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375799"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- | Update the state contained in a form.</span><span>
</span><span id="line-234"></span><span class="hs-comment">--</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- This updates all form fields to be consistent with the new form</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- state. Where possible, this attempts to maintain other input state,</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- such as text editor cursor position.</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- Note that since this updates the form fields, this means that any</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- field values will be completely overwritten! This may or may not</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- be what you want, since a user actively using the form could get</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- confused if their edits go away. Use carefully.</span><span>
</span><span id="line-243"></span><span id="local-6989586621679375795"><span id="local-6989586621679375796"><span id="local-6989586621679375797"><span class="annot"><a href="Brick.Forms.html#updateFormState"><span class="hs-identifier hs-type">updateFormState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679375797"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375797"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375796"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375795"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375797"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375796"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375795"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-244"></span><span id="updateFormState"><span class="annot"><span class="annottext">updateFormState :: s -&gt; Form s e n -&gt; Form s e n
</span><a href="Brick.Forms.html#updateFormState"><span class="hs-identifier hs-var hs-var">updateFormState</span></a></span></span><span> </span><span id="local-6989586621679375794"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375794"><span class="hs-identifier hs-var">newState</span></a></span></span><span> </span><span id="local-6989586621679375793"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375793"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375792"><span class="annot"><span class="annottext">updateField :: FormFieldState s e n -&gt; FormFieldState s e n
</span><a href="#local-6989586621679375792"><span class="hs-identifier hs-var hs-var">updateField</span></a></span></span><span> </span><span id="local-6989586621679375791"><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375791"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375791"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-246"></span><span>            </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span id="local-6989586621679375790"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375790"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679375789"><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375789"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679375788"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679375788"><span class="hs-identifier hs-var">upd</span></a></span></span><span> </span><span id="local-6989586621679375787"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375787"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679375786"><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375786"><span class="hs-identifier hs-var">rh</span></a></span></span><span> </span><span id="local-6989586621679375785"><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375785"><span class="hs-identifier hs-var">concatAll</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>                </span><span class="annot"><span class="annottext">b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
forall b s a e n.
b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-var">FormFieldState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679375788"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375794"><span class="hs-identifier hs-var">newState</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting a s a -&gt; a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting a s a
Lens' s a
</span><a href="#local-6989586621679375789"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375790"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375789"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679375788"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375787"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375786"><span class="hs-identifier hs-var">rh</span></a></span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375785"><span class="hs-identifier hs-var">concatAll</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375793"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formState :: s
</span><a href="Brick.Forms.html#formState"><span class="hs-identifier hs-var">formState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375794"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-249"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldStates :: [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var">formFieldStates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n -&gt; FormFieldState s e n
</span><a href="#local-6989586621679375792"><span class="hs-identifier hs-var">updateField</span></a></span><span> </span><span class="annot"><span class="annottext">(FormFieldState s e n -&gt; FormFieldState s e n)
-&gt; [FormFieldState s e n] -&gt; [FormFieldState s e n]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; [FormFieldState s e n]
forall s e n. Form s e n -&gt; [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var hs-var">formFieldStates</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375793"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-250"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Set the focused field of a form.</span><span>
</span><span id="line-253"></span><span id="local-6989586621679375780"><span id="local-6989586621679375781"><span id="local-6989586621679375782"><span class="annot"><a href="Brick.Forms.html#setFormFocus"><span class="hs-identifier hs-type">setFormFocus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375782"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375782"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375781"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375780"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375782"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375781"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375780"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375782"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-254"></span><span id="setFormFocus"><span class="annot"><span class="annottext">setFormFocus :: n -&gt; Form s e n -&gt; Form s e n
</span><a href="Brick.Forms.html#setFormFocus"><span class="hs-identifier hs-var hs-var">setFormFocus</span></a></span></span><span> </span><span id="local-6989586621679375779"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375779"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679375778"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375778"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375778"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; FocusRing n -&gt; FocusRing n
forall n. Eq n =&gt; n -&gt; FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusSetCurrent"><span class="hs-identifier hs-var">focusSetCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375779"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(FocusRing n -&gt; FocusRing n) -&gt; FocusRing n -&gt; FocusRing n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375778"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Set a form field's concatenation function.</span><span>
</span><span id="line-257"></span><span id="local-6989586621679375774"><span id="local-6989586621679375775"><span id="local-6989586621679375776"><span class="annot"><a href="Brick.Forms.html#setFieldConcat"><span class="hs-identifier hs-type">setFieldConcat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375776"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375776"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375775"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375774"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375776"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375775"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375774"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375776"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-258"></span><span id="setFieldConcat"><span class="annot"><span class="annottext">setFieldConcat :: ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n -&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#setFieldConcat"><span class="hs-identifier hs-var hs-var">setFieldConcat</span></a></span></span><span> </span><span id="local-6989586621679375773"><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375773"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679375772"><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375772"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375772"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldConcat :: [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldConcat"><span class="hs-identifier hs-var">formFieldConcat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375773"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | Set a form's concatenation function.</span><span>
</span><span id="line-261"></span><span id="local-6989586621679375769"><span id="local-6989586621679375770"><span id="local-6989586621679375771"><span class="annot"><a href="Brick.Forms.html#setFormConcat"><span class="hs-identifier hs-type">setFormConcat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375771"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375771"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375770"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375769"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375771"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375770"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375769"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375771"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-262"></span><span id="setFormConcat"><span class="annot"><span class="annottext">setFormConcat :: ([Widget n] -&gt; Widget n) -&gt; Form s e n -&gt; Form s e n
</span><a href="Brick.Forms.html#setFormConcat"><span class="hs-identifier hs-var hs-var">setFormConcat</span></a></span></span><span> </span><span id="local-6989586621679375768"><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375768"><span class="hs-identifier hs-var">func</span></a></span></span><span> </span><span id="local-6989586621679375767"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375767"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375767"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formConcatAll :: [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formConcatAll"><span class="hs-identifier hs-var">formConcatAll</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375768"><span class="hs-identifier hs-var">func</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Create a new form with the specified input fields and an initial</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- form state. The fields are initialized from the state using their</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- state lenses and the first form input is focused initially.</span><span>
</span><span id="line-267"></span><span id="local-6989586621679375764"><span id="local-6989586621679375765"><span id="local-6989586621679375766"><span class="annot"><a href="Brick.Forms.html#newForm"><span class="hs-identifier hs-type">newForm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679375766"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375766"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375764"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-comment">-- ^ The form field constructors. This is intended to be</span><span>
</span><span id="line-269"></span><span>        </span><span class="hs-comment">-- populated using the various field constructors in this</span><span>
</span><span id="line-270"></span><span>        </span><span class="hs-comment">-- module.</span><span>
</span><span id="line-271"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375766"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-272"></span><span>        </span><span class="hs-comment">-- ^ The initial form state used to populate the fields.</span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375766"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375764"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-274"></span><span id="newForm"><span class="annot"><span class="annottext">newForm :: [s -&gt; FormFieldState s e n] -&gt; s -&gt; Form s e n
</span><a href="Brick.Forms.html#newForm"><span class="hs-identifier hs-var hs-var">newForm</span></a></span></span><span> </span><span id="local-6989586621679375763"><span class="annot"><span class="annottext">[s -&gt; FormFieldState s e n]
</span><a href="#local-6989586621679375763"><span class="hs-identifier hs-var">mkEs</span></a></span></span><span> </span><span id="local-6989586621679375762"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375762"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375761"><span class="annot"><span class="annottext">es :: [FormFieldState s e n]
</span><a href="#local-6989586621679375761"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[s -&gt; FormFieldState s e n]
</span><a href="#local-6989586621679375763"><span class="hs-identifier hs-var">mkEs</span></a></span><span> </span><span class="annot"><span class="annottext">[s -&gt; FormFieldState s e n] -&gt; [s] -&gt; [FormFieldState s e n]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; [s]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375762"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Form :: forall s e n.
[FormFieldState s e n]
-&gt; FocusRing n -&gt; s -&gt; ([Widget n] -&gt; Widget n) -&gt; Form s e n
</span><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldStates :: [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var">formFieldStates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375761"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-277"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; FocusRing n
forall n. [n] -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusRing"><span class="hs-identifier hs-var">focusRing</span></a></span><span> </span><span class="annot"><span class="annottext">([n] -&gt; FocusRing n) -&gt; [n] -&gt; FocusRing n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[n]] -&gt; [n]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[n]] -&gt; [n]) -&gt; [[n]] -&gt; [n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n -&gt; [n]
forall s e n. FormFieldState s e n -&gt; [n]
</span><a href="Brick.Forms.html#formFieldNames"><span class="hs-identifier hs-var">formFieldNames</span></a></span><span> </span><span class="annot"><span class="annottext">(FormFieldState s e n -&gt; [n]) -&gt; [FormFieldState s e n] -&gt; [[n]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375761"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-278"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formState :: s
</span><a href="Brick.Forms.html#formState"><span class="hs-identifier hs-var">formState</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375762"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-279"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formConcatAll :: [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formConcatAll"><span class="hs-identifier hs-var">formConcatAll</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
forall n. [Widget n] -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#vBox"><span class="hs-identifier hs-var">vBox</span></a></span><span>
</span><span id="line-280"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span id="local-6989586621679376075"><span id="local-6989586621679376076"><span id="local-6989586621679376077"><span class="annot"><a href="Brick.Forms.html#formFieldNames"><span class="hs-identifier hs-type">formFieldNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376077"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376076"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376075"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679376075"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-283"></span><span id="formFieldNames"><span class="annot"><span class="annottext">formFieldNames :: FormFieldState s e n -&gt; [n]
</span><a href="Brick.Forms.html#formFieldNames"><span class="hs-identifier hs-var hs-var">formFieldNames</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375756"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375756"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormField a b e n -&gt; n
forall a b e n. FormField a b e n -&gt; n
</span><a href="Brick.Forms.html#formFieldName"><span class="hs-identifier hs-var hs-var">formFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(FormField a b e n -&gt; n) -&gt; [FormField a b e n] -&gt; [n]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375756"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | A form field for manipulating a boolean value. This represents</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- 'True' as @[X] label@ and 'False' as @[ ] label@.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- This field responds to `Space` keypresses to toggle the checkbox and</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- to mouse clicks.</span><span>
</span><span id="line-290"></span><span id="local-6989586621679375753"><span id="local-6989586621679375754"><span id="local-6989586621679375755"><span class="annot"><a href="Brick.Forms.html#checkboxField"><span class="hs-identifier hs-type">checkboxField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375755"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375755"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375754"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-292"></span><span>              </span><span class="hs-comment">-- ^ The state lens for this value.</span><span>
</span><span id="line-293"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375755"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-294"></span><span>              </span><span class="hs-comment">-- ^ The resource name for the input field.</span><span>
</span><span id="line-295"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-296"></span><span>              </span><span class="hs-comment">-- ^ The label for the check box, to appear at its right.</span><span>
</span><span id="line-297"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375754"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-298"></span><span>              </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-299"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375754"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375753"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375755"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-300"></span><span id="checkboxField"><span class="annot"><span class="annottext">checkboxField :: Lens' s Bool -&gt; n -&gt; Text -&gt; s -&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#checkboxField"><span class="hs-identifier hs-var hs-var">checkboxField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
-&gt; Char
-&gt; Char
-&gt; Lens' s Bool
-&gt; n
-&gt; Text
-&gt; s
-&gt; FormFieldState s e n
forall n s e.
(Ord n, Show n) =&gt;
Char
-&gt; Char
-&gt; Char
-&gt; Lens' s Bool
-&gt; n
-&gt; Text
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#checkboxCustomField"><span class="hs-identifier hs-var">checkboxCustomField</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'X'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | A form field for manipulating a boolean value. This represents</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- 'True' as @[X] label@ and 'False' as @[ ] label@. This function</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- permits the customization of the @[X]@ notation characters.</span><span>
</span><span id="line-305"></span><span class="hs-comment">--</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- This field responds to `Space` keypresses to toggle the checkbox and</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- to mouse clicks.</span><span>
</span><span id="line-308"></span><span id="local-6989586621679376058"><span id="local-6989586621679376059"><span id="local-6989586621679376060"><span class="annot"><a href="Brick.Forms.html#checkboxCustomField"><span class="hs-identifier hs-type">checkboxCustomField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679376060"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679376060"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-310"></span><span>                    </span><span class="hs-comment">-- ^ Left bracket character.</span><span>
</span><span id="line-311"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-312"></span><span>                    </span><span class="hs-comment">-- ^ Checkmark character.</span><span>
</span><span id="line-313"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-314"></span><span>                    </span><span class="hs-comment">-- ^ Right bracket character.</span><span>
</span><span id="line-315"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679376059"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-316"></span><span>                    </span><span class="hs-comment">-- ^ The state lens for this value.</span><span>
</span><span id="line-317"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679376060"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-318"></span><span>                    </span><span class="hs-comment">-- ^ The resource name for the input field.</span><span>
</span><span id="line-319"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-320"></span><span>                    </span><span class="hs-comment">-- ^ The label for the check box, to appear at its right.</span><span>
</span><span id="line-321"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679376059"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-322"></span><span>                    </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-323"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376059"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376058"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376060"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-324"></span><span id="checkboxCustomField"><span class="annot"><span class="annottext">checkboxCustomField :: Char
-&gt; Char
-&gt; Char
-&gt; Lens' s Bool
-&gt; n
-&gt; Text
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#checkboxCustomField"><span class="hs-identifier hs-var hs-var">checkboxCustomField</span></a></span></span><span> </span><span id="local-6989586621679375752"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375752"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span id="local-6989586621679375751"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375751"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span id="local-6989586621679375750"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375750"><span class="hs-identifier hs-var">rb</span></a></span></span><span> </span><span id="local-6989586621679375749"><span class="annot"><span class="annottext">Lens' s Bool
</span><a href="#local-6989586621679375749"><span class="hs-identifier hs-var">stLens</span></a></span></span><span> </span><span id="local-6989586621679375748"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375748"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679375747"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375747"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679375746"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375746"><span class="hs-identifier hs-var">initialState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375745"><span class="annot"><span class="annottext">initVal :: Bool
</span><a href="#local-6989586621679375745"><span class="hs-identifier hs-var hs-var">initVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375746"><span class="hs-identifier hs-var">initialState</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Getting Bool s Bool -&gt; Bool
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool s Bool
Lens' s Bool
</span><a href="#local-6989586621679375749"><span class="hs-identifier hs-var">stLens</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>        </span><span id="local-6989586621679375744"><span class="annot"><span class="annottext">handleEvent :: BrickEvent n e -&gt; Bool -&gt; EventM n Bool
</span><a href="#local-6989586621679375744"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#MouseDown"><span class="hs-identifier hs-type">MouseDown</span></a></span><span> </span><span id="local-6989586621679375742"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375742"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Button
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Modifier]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Location
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375741"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375741"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375742"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375748"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; EventM n Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; EventM n Bool) -&gt; Bool -&gt; EventM n Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375741"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><a href="#local-6989586621679375744"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375736"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375736"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; EventM n Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; EventM n Bool) -&gt; Bool -&gt; EventM n Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375736"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><a href="#local-6989586621679375744"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375735"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375735"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; EventM n Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375735"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FormFieldState :: forall b s a e n.
b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldState :: Bool
</span><a href="Brick.Forms.html#formFieldState"><span class="hs-identifier hs-var">formFieldState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375745"><span class="hs-identifier hs-var">initVal</span></a></span><span>
</span><span id="line-332"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFields :: [FormField Bool Bool e n]
</span><a href="Brick.Forms.html#formFields"><span class="hs-identifier hs-var">formFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">n
-&gt; (Bool -&gt; Maybe Bool)
-&gt; Bool
-&gt; (Bool -&gt; Bool -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; Bool -&gt; EventM n Bool)
-&gt; FormField Bool Bool e n
forall a b e n.
n
-&gt; (b -&gt; Maybe a)
-&gt; Bool
-&gt; (Bool -&gt; b -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; b -&gt; EventM n b)
-&gt; FormField a b e n
</span><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-var">FormField</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375748"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-333"></span><span>                                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Char -&gt; Text -&gt; n -&gt; Bool -&gt; Bool -&gt; Widget n
forall n.
Char -&gt; Char -&gt; Char -&gt; Text -&gt; n -&gt; Bool -&gt; Bool -&gt; Widget n
</span><a href="Brick.Forms.html#renderCheckbox"><span class="hs-identifier hs-var">renderCheckbox</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375752"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375751"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375750"><span class="hs-identifier hs-var">rb</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375747"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375748"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>                                                 </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; Bool -&gt; EventM n Bool
</span><a href="#local-6989586621679375744"><span class="hs-identifier hs-var">handleEvent</span></a></span><span>
</span><span id="line-335"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldLens :: Lens' s Bool
</span><a href="Brick.Forms.html#formFieldLens"><span class="hs-identifier hs-var">formFieldLens</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' s Bool
</span><a href="#local-6989586621679375749"><span class="hs-identifier hs-var">stLens</span></a></span><span>
</span><span id="line-337"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldUpdate :: Bool -&gt; Bool -&gt; Bool
</span><a href="Brick.Forms.html#formFieldUpdate"><span class="hs-identifier hs-var">formFieldUpdate</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>                          </span><span class="hs-glyph">\</span><span id="local-6989586621679375733"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375733"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375733"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-339"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldRenderHelper :: Widget n -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldRenderHelper"><span class="hs-identifier hs-var">formFieldRenderHelper</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-340"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldConcat :: [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldConcat"><span class="hs-identifier hs-var">formFieldConcat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
forall n. [Widget n] -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#vBox"><span class="hs-identifier hs-var">vBox</span></a></span><span>
</span><span id="line-341"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span id="local-6989586621679376045"><span class="annot"><a href="Brick.Forms.html#renderCheckbox"><span class="hs-identifier hs-type">renderCheckbox</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679376045"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679376045"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-344"></span><span id="renderCheckbox"><span class="annot"><span class="annottext">renderCheckbox :: Char -&gt; Char -&gt; Char -&gt; Text -&gt; n -&gt; Bool -&gt; Bool -&gt; Widget n
</span><a href="Brick.Forms.html#renderCheckbox"><span class="hs-identifier hs-var hs-var">renderCheckbox</span></a></span></span><span> </span><span id="local-6989586621679375731"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375731"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span id="local-6989586621679375730"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375730"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span id="local-6989586621679375729"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375729"><span class="hs-identifier hs-var">rb</span></a></span></span><span> </span><span id="local-6989586621679375728"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375728"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679375727"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375727"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679375726"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375726"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679375725"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375725"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375724"><span class="annot"><span class="annottext">addAttr :: Widget n -&gt; Widget n
</span><a href="#local-6989586621679375724"><span class="hs-identifier hs-var hs-var">addAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375726"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#withDefAttr"><span class="hs-identifier hs-var">withDefAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Forms.html#focusedFormInputAttr"><span class="hs-identifier hs-var">focusedFormInputAttr</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-346"></span><span>        </span><span id="local-6989586621679375722"><span class="annot"><span class="annottext">csr :: Widget n -&gt; Widget n
</span><a href="#local-6989586621679375722"><span class="hs-identifier hs-var hs-var">csr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375726"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">n -&gt; Location -&gt; Widget n -&gt; Widget n
forall n. n -&gt; Location -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#showCursor"><span class="hs-identifier hs-var">showCursor</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375727"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Location
</span><a href="Brick.Types.Common.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">n -&gt; Widget n -&gt; Widget n
forall n. n -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#clickable"><span class="hs-identifier hs-var">clickable</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375727"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-348"></span><span>       </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375724"><span class="hs-identifier hs-var">addAttr</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375722"><span class="hs-identifier hs-var">csr</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-349"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Widget n) -&gt; Text -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375731"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375725"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375730"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-350"></span><span>              </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375729"><span class="hs-identifier hs-var">rb</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n -&gt; Widget n
forall n. Widget n -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375728"><span class="hs-keyword hs-var">label</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- | A form field for selecting a single choice from a set of possible</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- choices in a scrollable list. This uses a 'List' internally.</span><span>
</span><span id="line-354"></span><span class="hs-comment">--</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- This field responds to the same input events that a 'List' does.</span><span>
</span><span id="line-356"></span><span class="annot"><a href="Brick.Forms.html#listField"><span class="hs-identifier hs-type">listField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679375715"><span class="annot"><a href="#local-6989586621679375715"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679375714"><span class="annot"><a href="#local-6989586621679375714"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679375713"><span class="annot"><a href="#local-6989586621679375713"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679375712"><span class="annot"><a href="#local-6989586621679375712"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375713"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375713"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375712"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679375715"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679375712"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>          </span><span class="hs-comment">-- ^ Possible choices.</span><span>
</span><span id="line-359"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375715"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679375712"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>          </span><span class="hs-comment">-- ^ The state lens for the initially/finally selected</span><span>
</span><span id="line-361"></span><span>          </span><span class="hs-comment">-- element.</span><span>
</span><span id="line-362"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375712"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375713"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>          </span><span class="hs-comment">-- ^ List item rendering function.</span><span>
</span><span id="line-364"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-365"></span><span>          </span><span class="hs-comment">-- ^ List item height in rows.</span><span>
</span><span id="line-366"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375713"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-367"></span><span>          </span><span class="hs-comment">-- ^ The resource name for the input field.</span><span>
</span><span id="line-368"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375715"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-369"></span><span>          </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-370"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375715"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375714"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375713"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-371"></span><span id="listField"><span class="annot"><span class="annottext">listField :: (s -&gt; Vector a)
-&gt; Lens' s (Maybe a)
-&gt; (Bool -&gt; a -&gt; Widget n)
-&gt; Int
-&gt; n
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#listField"><span class="hs-identifier hs-var hs-var">listField</span></a></span></span><span> </span><span id="local-6989586621679375711"><span class="annot"><span class="annottext">s -&gt; Vector a
</span><a href="#local-6989586621679375711"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621679375710"><span class="annot"><span class="annottext">Lens' s (Maybe a)
</span><a href="#local-6989586621679375710"><span class="hs-identifier hs-var">stLens</span></a></span></span><span> </span><span id="local-6989586621679375709"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Widget n
</span><a href="#local-6989586621679375709"><span class="hs-identifier hs-var">renderItem</span></a></span></span><span> </span><span id="local-6989586621679375708"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375708"><span class="hs-identifier hs-var">itemHeight</span></a></span></span><span> </span><span id="local-6989586621679375707"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375707"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679375706"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375706"><span class="hs-identifier hs-var">initialState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375705"><span class="annot"><span class="annottext">optionsVector :: Vector a
</span><a href="#local-6989586621679375705"><span class="hs-identifier hs-var hs-var">optionsVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; Vector a
</span><a href="#local-6989586621679375711"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375706"><span class="hs-identifier hs-var">initialState</span></a></span><span>
</span><span id="line-373"></span><span>        </span><span id="local-6989586621679375704"><span class="annot"><span class="annottext">initVal :: List n a
</span><a href="#local-6989586621679375704"><span class="hs-identifier hs-var hs-var">initVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375706"><span class="hs-identifier hs-var">initialState</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Getting (List n a) s (List n a) -&gt; List n a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (List n a) s (List n a)
Lens' s (List n a)
</span><a href="#local-6989586621679375703"><span class="hs-identifier hs-var">customStLens</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><a href="#local-6989586621679375703"><span class="hs-identifier hs-type">customStLens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375715"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Widgets.List.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375713"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375712"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>        </span><span id="local-6989586621679375703"><span class="annot"><span class="annottext">customStLens :: (List n a -&gt; f (List n a)) -&gt; s -&gt; f s
</span><a href="#local-6989586621679375703"><span class="hs-identifier hs-var hs-var">customStLens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; List n a) -&gt; (s -&gt; List n a -&gt; s) -&gt; Lens' s (List n a)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; List n a
</span><a href="#local-6989586621679375701"><span class="hs-identifier hs-var">getList</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; List n a -&gt; s
</span><a href="#local-6989586621679375700"><span class="hs-identifier hs-var">setList</span></a></span><span>
</span><span id="line-377"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>               </span><span id="local-6989586621679375701"><span class="annot"><span class="annottext">getList :: s -&gt; List n a
</span><a href="#local-6989586621679375701"><span class="hs-identifier hs-var hs-var">getList</span></a></span></span><span> </span><span id="local-6989586621679375699"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375699"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375698"><span class="annot"><span class="annottext">l :: List n a
</span><a href="#local-6989586621679375698"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Vector a -&gt; Int -&gt; List n a
forall (t :: * -&gt; *) n e.
Foldable t =&gt;
n -&gt; t e -&gt; Int -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#list"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375707"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679375705"><span class="hs-identifier hs-var">optionsVector</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375708"><span class="hs-identifier hs-var">itemHeight</span></a></span><span>
</span><span id="line-379"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375699"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Getting (Maybe a) s (Maybe a) -&gt; Maybe a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe a) s (Maybe a)
Lens' s (Maybe a)
</span><a href="#local-6989586621679375710"><span class="hs-identifier hs-var">stLens</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-380"></span><span>                               </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375698"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-381"></span><span>                               </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375696"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375696"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; List n a -&gt; List n a
forall e (t :: * -&gt; *) n.
(Eq e, Foldable t, Splittable t) =&gt;
e -&gt; GenericList n t e -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#listMoveToElement"><span class="hs-identifier hs-var">listMoveToElement</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375696"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375698"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-382"></span><span>               </span><span id="local-6989586621679375700"><span class="annot"><span class="annottext">setList :: s -&gt; List n a -&gt; s
</span><a href="#local-6989586621679375700"><span class="hs-identifier hs-var hs-var">setList</span></a></span></span><span> </span><span id="local-6989586621679375694"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375694"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679375693"><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375693"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375694"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; (s -&gt; s) -&gt; s
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Identity (Maybe a)) -&gt; s -&gt; Identity s
Lens' s (Maybe a)
</span><a href="#local-6989586621679375710"><span class="hs-identifier hs-var">stLens</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe a -&gt; Identity (Maybe a)) -&gt; s -&gt; Identity s)
-&gt; Maybe a -&gt; s -&gt; s
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, a) -&gt; a) -&gt; Maybe (Int, a) -&gt; Maybe a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">List n a -&gt; Maybe (Int, a)
forall (t :: * -&gt; *) n e.
(Splittable t, Foldable t) =&gt;
GenericList n t e -&gt; Maybe (Int, e)
</span><a href="Brick.Widgets.List.html#listSelectedElement"><span class="hs-identifier hs-var">listSelectedElement</span></a></span><span> </span><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375693"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>        </span><span id="local-6989586621679375689"><span class="annot"><span class="annottext">handleEvent :: BrickEvent n e -&gt; GenericList n t e -&gt; EventM n (GenericList n t e)
</span><a href="#local-6989586621679375689"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span id="local-6989586621679375688"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679375688"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375687"><span class="annot"><span class="annottext">GenericList n t e
</span><a href="#local-6989586621679375687"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Event -&gt; GenericList n t e -&gt; EventM n (GenericList n t e)
forall (t :: * -&gt; *) n e.
(Foldable t, Splittable t, Ord n) =&gt;
Event -&gt; GenericList n t e -&gt; EventM n (GenericList n t e)
</span><a href="Brick.Widgets.List.html#handleListEvent"><span class="hs-identifier hs-var">handleListEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679375688"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">GenericList n t e
</span><a href="#local-6989586621679375687"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><a href="#local-6989586621679375689"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375685"><span class="annot"><span class="annottext">GenericList n t e
</span><a href="#local-6989586621679375685"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericList n t e -&gt; EventM n (GenericList n t e)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">GenericList n t e
</span><a href="#local-6989586621679375685"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FormFieldState :: forall b s a e n.
b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldState :: List n a
</span><a href="Brick.Forms.html#formFieldState"><span class="hs-identifier hs-var">formFieldState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375704"><span class="hs-identifier hs-var">initVal</span></a></span><span>
</span><span id="line-388"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFields :: [FormField (List n a) (List n a) e n]
</span><a href="Brick.Forms.html#formFields"><span class="hs-identifier hs-var">formFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">n
-&gt; (List n a -&gt; Maybe (List n a))
-&gt; Bool
-&gt; (Bool -&gt; List n a -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; List n a -&gt; EventM n (List n a))
-&gt; FormField (List n a) (List n a) e n
forall a b e n.
n
-&gt; (b -&gt; Maybe a)
-&gt; Bool
-&gt; (Bool -&gt; b -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; b -&gt; EventM n b)
-&gt; FormField a b e n
</span><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-var">FormField</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375707"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">List n a -&gt; Maybe (List n a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-389"></span><span>                                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; a -&gt; Widget n) -&gt; Bool -&gt; List n a -&gt; Widget n
forall (t :: * -&gt; *) n e.
(Traversable t, Splittable t, Ord n, Show n) =&gt;
(Bool -&gt; e -&gt; Widget n) -&gt; Bool -&gt; GenericList n t e -&gt; Widget n
</span><a href="Brick.Widgets.List.html#renderList"><span class="hs-identifier hs-var">renderList</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Widget n
</span><a href="#local-6989586621679375709"><span class="hs-identifier hs-var">renderItem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>                                                 </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; List n a -&gt; EventM n (List n a)
forall (t :: * -&gt; *) n n e e.
(Foldable t, Splittable t, Ord n) =&gt;
BrickEvent n e -&gt; GenericList n t e -&gt; EventM n (GenericList n t e)
</span><a href="#local-6989586621679375689"><span class="hs-identifier hs-var">handleEvent</span></a></span><span>
</span><span id="line-391"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-392"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldLens :: Lens' s (List n a)
</span><a href="Brick.Forms.html#formFieldLens"><span class="hs-identifier hs-var">formFieldLens</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' s (List n a)
</span><a href="#local-6989586621679375703"><span class="hs-identifier hs-var">customStLens</span></a></span><span>
</span><span id="line-393"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldUpdate :: List n a -&gt; List n a -&gt; List n a
</span><a href="Brick.Forms.html#formFieldUpdate"><span class="hs-identifier hs-var">formFieldUpdate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679375683"><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375683"><span class="hs-identifier hs-var">listState</span></a></span></span><span> </span><span id="local-6989586621679375682"><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375682"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-394"></span><span>                           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">List n a -&gt; Maybe (Int, a)
forall (t :: * -&gt; *) n e.
(Splittable t, Foldable t) =&gt;
GenericList n t e -&gt; Maybe (Int, e)
</span><a href="Brick.Widgets.List.html#listSelectedElement"><span class="hs-identifier hs-var">listSelectedElement</span></a></span><span> </span><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375683"><span class="hs-identifier hs-var">listState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-395"></span><span>                               </span><span class="annot"><span class="annottext">Maybe (Int, a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375682"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-396"></span><span>                               </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375681"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375681"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; List n a -&gt; List n a
forall e (t :: * -&gt; *) n.
(Eq e, Foldable t, Splittable t) =&gt;
e -&gt; GenericList n t e -&gt; GenericList n t e
</span><a href="Brick.Widgets.List.html#listMoveToElement"><span class="hs-identifier hs-var">listMoveToElement</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375681"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">List n a
</span><a href="#local-6989586621679375682"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-397"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldRenderHelper :: Widget n -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldRenderHelper"><span class="hs-identifier hs-var">formFieldRenderHelper</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-398"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldConcat :: [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldConcat"><span class="hs-identifier hs-var">formFieldConcat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
forall n. [Widget n] -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#vBox"><span class="hs-identifier hs-var">vBox</span></a></span><span>
</span><span id="line-399"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- | A form field for selecting a single choice from a set of possible</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- choices. Each choice has an associated value and text label.</span><span>
</span><span id="line-402"></span><span class="hs-comment">--</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- This field responds to `Space` keypresses to select a radio button</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- option and to mouse clicks.</span><span>
</span><span id="line-405"></span><span id="local-6989586621679375677"><span id="local-6989586621679375678"><span id="local-6989586621679375679"><span id="local-6989586621679375680"><span class="annot"><a href="Brick.Forms.html#radioField"><span class="hs-identifier hs-type">radioField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375680"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375680"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375679"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375678"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375679"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-407"></span><span>           </span><span class="hs-comment">-- ^ The state lens for this value.</span><span>
</span><span id="line-408"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679375679"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679375680"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span>           </span><span class="hs-comment">-- ^ The available choices, in order. Each choice has a value</span><span>
</span><span id="line-410"></span><span>           </span><span class="hs-comment">-- of type @a@, a resource name, and a text label.</span><span>
</span><span id="line-411"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375678"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-412"></span><span>           </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-413"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375678"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375677"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375680"><span class="hs-identifier hs-type">n</span></a></span></span></span></span></span><span>
</span><span id="line-414"></span><span id="radioField"><span class="annot"><span class="annottext">radioField :: Lens' s a -&gt; [(a, n, Text)] -&gt; s -&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#radioField"><span class="hs-identifier hs-var hs-var">radioField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
-&gt; Char
-&gt; Char
-&gt; Lens' s a
-&gt; [(a, n, Text)]
-&gt; s
-&gt; FormFieldState s e n
forall n a s e.
(Ord n, Show n, Eq a) =&gt;
Char
-&gt; Char
-&gt; Char
-&gt; Lens' s a
-&gt; [(a, n, Text)]
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#radioCustomField"><span class="hs-identifier hs-var">radioCustomField</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | A form field for selecting a single choice from a set of possible</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- choices. Each choice has an associated value and text label. This</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- function permits the customization of the @[*]@ notation characters.</span><span>
</span><span id="line-419"></span><span class="hs-comment">--</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- This field responds to `Space` keypresses to select a radio button</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- option and to mouse clicks.</span><span>
</span><span id="line-422"></span><span id="local-6989586621679375984"><span id="local-6989586621679375985"><span id="local-6989586621679375986"><span id="local-6989586621679375987"><span class="annot"><a href="Brick.Forms.html#radioCustomField"><span class="hs-identifier hs-type">radioCustomField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375987"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375987"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-424"></span><span>                 </span><span class="hs-comment">-- ^ Left bracket character.</span><span>
</span><span id="line-425"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-426"></span><span>                 </span><span class="hs-comment">-- ^ Checkmark character.</span><span>
</span><span id="line-427"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-428"></span><span>                 </span><span class="hs-comment">-- ^ Right bracket character.</span><span>
</span><span id="line-429"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375985"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375986"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-430"></span><span>                 </span><span class="hs-comment">-- ^ The state lens for this value.</span><span>
</span><span id="line-431"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679375986"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679375987"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-432"></span><span>                 </span><span class="hs-comment">-- ^ The available choices, in order. Each choice has a value</span><span>
</span><span id="line-433"></span><span>                 </span><span class="hs-comment">-- of type @a@, a resource name, and a text label.</span><span>
</span><span id="line-434"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375985"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-435"></span><span>                 </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-436"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375985"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375984"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375987"><span class="hs-identifier hs-type">n</span></a></span></span></span></span></span><span>
</span><span id="line-437"></span><span id="radioCustomField"><span class="annot"><span class="annottext">radioCustomField :: Char
-&gt; Char
-&gt; Char
-&gt; Lens' s a
-&gt; [(a, n, Text)]
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#radioCustomField"><span class="hs-identifier hs-var hs-var">radioCustomField</span></a></span></span><span> </span><span id="local-6989586621679375676"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375676"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span id="local-6989586621679375675"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375675"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span id="local-6989586621679375674"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375674"><span class="hs-identifier hs-var">rb</span></a></span></span><span> </span><span id="local-6989586621679375673"><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375673"><span class="hs-identifier hs-var">stLens</span></a></span></span><span> </span><span id="local-6989586621679375672"><span class="annot"><span class="annottext">[(a, n, Text)]
</span><a href="#local-6989586621679375672"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621679375671"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375671"><span class="hs-identifier hs-var">initialState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375670"><span class="annot"><span class="annottext">initVal :: a
</span><a href="#local-6989586621679375670"><span class="hs-identifier hs-var hs-var">initVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375671"><span class="hs-identifier hs-var">initialState</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Getting a s a -&gt; a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting a s a
Lens' s a
</span><a href="#local-6989586621679375673"><span class="hs-identifier hs-var">stLens</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span>        </span><span id="local-6989586621679375669"><span class="annot"><span class="annottext">lookupOptionValue :: n -&gt; Maybe a
</span><a href="#local-6989586621679375669"><span class="hs-identifier hs-var hs-var">lookupOptionValue</span></a></span></span><span> </span><span id="local-6989586621679375668"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375668"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-441"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375667"><span class="annot"><span class="annottext">results :: [(a, n, Text)]
</span><a href="#local-6989586621679375667"><span class="hs-identifier hs-var hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, n, Text) -&gt; Bool) -&gt; [(a, n, Text)] -&gt; [(a, n, Text)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375666"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375666"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375666"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, n, Text)]
</span><a href="#local-6989586621679375672"><span class="hs-identifier hs-var">options</span></a></span><span>
</span><span id="line-442"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(a, n, Text)]
</span><a href="#local-6989586621679375667"><span class="hs-identifier hs-var">results</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-443"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679375665"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375665"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375665"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-444"></span><span>                </span><span class="annot"><span class="annottext">[(a, n, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span>        </span><span id="local-6989586621679375664"><span class="annot"><span class="annottext">handleEvent :: a -&gt; BrickEvent n e -&gt; a -&gt; EventM n a
</span><a href="#local-6989586621679375664"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#MouseDown"><span class="hs-identifier hs-type">MouseDown</span></a></span><span> </span><span id="local-6989586621679375663"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375663"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Button
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Modifier]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Location
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375662"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375662"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-447"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">n -&gt; Maybe a
</span><a href="#local-6989586621679375669"><span class="hs-identifier hs-var">lookupOptionValue</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375663"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>                </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; EventM n a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375662"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-449"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375661"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375661"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; EventM n a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375661"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-450"></span><span>        </span><span class="annot"><a href="#local-6989586621679375664"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span id="local-6989586621679375660"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375660"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; EventM n a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375660"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-451"></span><span>        </span><span class="annot"><a href="#local-6989586621679375664"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375659"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375659"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; EventM n a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375659"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>        </span><span id="local-6989586621679375658"><span class="annot"><span class="annottext">optionFields :: [FormField a a e n]
</span><a href="#local-6989586621679375658"><span class="hs-identifier hs-var hs-var">optionFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, n, Text) -&gt; FormField a a e n
</span><a href="#local-6989586621679375657"><span class="hs-identifier hs-var">mkOptionField</span></a></span><span> </span><span class="annot"><span class="annottext">((a, n, Text) -&gt; FormField a a e n)
-&gt; [(a, n, Text)] -&gt; [FormField a a e n]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(a, n, Text)]
</span><a href="#local-6989586621679375672"><span class="hs-identifier hs-var">options</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span id="local-6989586621679375657"><span class="annot"><span class="annottext">mkOptionField :: (a, n, Text) -&gt; FormField a a e n
</span><a href="#local-6989586621679375657"><span class="hs-identifier hs-var hs-var">mkOptionField</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375656"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375656"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375655"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375655"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375654"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375654"><span class="hs-keyword hs-var">label</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>            </span><span class="annot"><span class="annottext">n
-&gt; (a -&gt; Maybe a)
-&gt; Bool
-&gt; (Bool -&gt; a -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; a -&gt; EventM n a)
-&gt; FormField a a e n
forall a b e n.
n
-&gt; (b -&gt; Maybe a)
-&gt; Bool
-&gt; (Bool -&gt; b -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; b -&gt; EventM n b)
-&gt; FormField a b e n
</span><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-var">FormField</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375655"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-456"></span><span>                      </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-457"></span><span>                      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-458"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Char -&gt; a -&gt; n -&gt; Text -&gt; Bool -&gt; a -&gt; Widget n
forall a n.
Eq a =&gt;
Char -&gt; Char -&gt; Char -&gt; a -&gt; n -&gt; Text -&gt; Bool -&gt; a -&gt; Widget n
</span><a href="Brick.Forms.html#renderRadio"><span class="hs-identifier hs-var">renderRadio</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375676"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375675"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375674"><span class="hs-identifier hs-var">rb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375656"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375655"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375654"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; BrickEvent n e -&gt; a -&gt; EventM n a
</span><a href="#local-6989586621679375664"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375656"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FormFieldState :: forall b s a e n.
b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldState :: a
</span><a href="Brick.Forms.html#formFieldState"><span class="hs-identifier hs-var">formFieldState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375670"><span class="hs-identifier hs-var">initVal</span></a></span><span>
</span><span id="line-462"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFields :: [FormField a a e n]
</span><a href="Brick.Forms.html#formFields"><span class="hs-identifier hs-var">formFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FormField a a e n]
</span><a href="#local-6989586621679375658"><span class="hs-identifier hs-var">optionFields</span></a></span><span>
</span><span id="line-463"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldLens :: Lens' s a
</span><a href="Brick.Forms.html#formFieldLens"><span class="hs-identifier hs-var">formFieldLens</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375673"><span class="hs-identifier hs-var">stLens</span></a></span><span>
</span><span id="line-464"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldUpdate :: a -&gt; a -&gt; a
</span><a href="Brick.Forms.html#formFieldUpdate"><span class="hs-identifier hs-var">formFieldUpdate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679375652"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375652"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375652"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-465"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldRenderHelper :: Widget n -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldRenderHelper"><span class="hs-identifier hs-var">formFieldRenderHelper</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-466"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldConcat :: [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldConcat"><span class="hs-identifier hs-var">formFieldConcat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
forall n. [Widget n] -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#vBox"><span class="hs-identifier hs-var">vBox</span></a></span><span>
</span><span id="line-467"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span id="local-6989586621679375977"><span id="local-6989586621679375978"><span class="annot"><a href="Brick.Forms.html#renderRadio"><span class="hs-identifier hs-type">renderRadio</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375978"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375978"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375977"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375978"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375977"><span class="hs-identifier hs-type">n</span></a></span></span></span><span>
</span><span id="line-470"></span><span id="renderRadio"><span class="annot"><span class="annottext">renderRadio :: Char -&gt; Char -&gt; Char -&gt; a -&gt; n -&gt; Text -&gt; Bool -&gt; a -&gt; Widget n
</span><a href="Brick.Forms.html#renderRadio"><span class="hs-identifier hs-var hs-var">renderRadio</span></a></span></span><span> </span><span id="local-6989586621679375651"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375651"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span id="local-6989586621679375650"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375650"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span id="local-6989586621679375649"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375649"><span class="hs-identifier hs-var">rb</span></a></span></span><span> </span><span id="local-6989586621679375648"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375648"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679375647"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375647"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679375646"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375646"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679375645"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375645"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679375644"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375644"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375643"><span class="annot"><span class="annottext">addAttr :: Widget n -&gt; Widget n
</span><a href="#local-6989586621679375643"><span class="hs-identifier hs-var hs-var">addAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375645"><span class="hs-identifier hs-var">foc</span></a></span><span>
</span><span id="line-472"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#withDefAttr"><span class="hs-identifier hs-var">withDefAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Forms.html#focusedFormInputAttr"><span class="hs-identifier hs-var">focusedFormInputAttr</span></a></span><span>
</span><span id="line-473"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-474"></span><span>        </span><span id="local-6989586621679375642"><span class="annot"><span class="annottext">isSet :: Bool
</span><a href="#local-6989586621679375642"><span class="hs-identifier hs-var hs-var">isSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375648"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375644"><span class="hs-identifier hs-var">cur</span></a></span><span>
</span><span id="line-475"></span><span>        </span><span id="local-6989586621679375641"><span class="annot"><span class="annottext">csr :: Widget n -&gt; Widget n
</span><a href="#local-6989586621679375641"><span class="hs-identifier hs-var hs-var">csr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375645"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">n -&gt; Location -&gt; Widget n -&gt; Widget n
forall n. n -&gt; Location -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#showCursor"><span class="hs-identifier hs-var">showCursor</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375647"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Location
</span><a href="Brick.Types.Common.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">n -&gt; Widget n -&gt; Widget n
forall n. n -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#clickable"><span class="hs-identifier hs-var">clickable</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375647"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-477"></span><span>       </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375643"><span class="hs-identifier hs-var">addAttr</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375641"><span class="hs-identifier hs-var">csr</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-478"></span><span>       </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
forall n. [Widget n] -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#hBox"><span class="hs-identifier hs-var">hBox</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Widget n) -&gt; Text -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375651"><span class="hs-identifier hs-var">lb</span></a></span><span>
</span><span id="line-479"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Widget n) -&gt; Text -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375642"><span class="hs-identifier hs-var">isSet</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375650"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-480"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Widget n) -&gt; Text -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679375649"><span class="hs-identifier hs-var">rb</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375646"><span class="hs-keyword hs-var">label</span></a></span><span>
</span><span id="line-481"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">-- | A form field for using an editor to edit the text representation of</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- a value. The other editing fields in this module are special cases of</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- this function.</span><span>
</span><span id="line-486"></span><span class="hs-comment">--</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- This field responds to all events handled by 'editor', including</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- mouse events.</span><span>
</span><span id="line-489"></span><span id="local-6989586621679375932"><span id="local-6989586621679375933"><span id="local-6989586621679375934"><span id="local-6989586621679375935"><span class="annot"><a href="Brick.Forms.html#editField"><span class="hs-identifier hs-type">editField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375935"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375935"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375934"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375933"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-491"></span><span>          </span><span class="hs-comment">-- ^ The state lens for this value.</span><span>
</span><span id="line-492"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375935"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-493"></span><span>          </span><span class="hs-comment">-- ^ The resource name for the input field.</span><span>
</span><span id="line-494"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-495"></span><span>          </span><span class="hs-comment">-- ^ The optional line limit for the editor (see 'editor').</span><span>
</span><span id="line-496"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679375933"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>          </span><span class="hs-comment">-- ^ The initialization function that turns your value into</span><span>
</span><span id="line-498"></span><span>          </span><span class="hs-comment">-- the editor's initial contents. The resulting text may</span><span>
</span><span id="line-499"></span><span>          </span><span class="hs-comment">-- contain newlines.</span><span>
</span><span id="line-500"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679375933"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>          </span><span class="hs-comment">-- ^ The validation function that converts the editor's</span><span>
</span><span id="line-502"></span><span>          </span><span class="hs-comment">-- contents into a valid value of type @a@.</span><span>
</span><span id="line-503"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375935"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>          </span><span class="hs-comment">-- ^ The rendering function for the editor's contents (see</span><span>
</span><span id="line-505"></span><span>          </span><span class="hs-comment">-- 'renderEditor').</span><span>
</span><span id="line-506"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375935"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375935"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>          </span><span class="hs-comment">-- ^ A rendering augmentation function to adjust the</span><span>
</span><span id="line-508"></span><span>          </span><span class="hs-comment">-- representation of the rendered editor.</span><span>
</span><span id="line-509"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375934"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-510"></span><span>          </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-511"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375934"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375932"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375935"><span class="hs-identifier hs-type">n</span></a></span></span></span></span></span><span>
</span><span id="line-512"></span><span id="editField"><span class="annot"><span class="annottext">editField :: Lens' s a
-&gt; n
-&gt; Maybe Int
-&gt; (a -&gt; Text)
-&gt; ([Text] -&gt; Maybe a)
-&gt; ([Text] -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n)
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#editField"><span class="hs-identifier hs-var hs-var">editField</span></a></span></span><span> </span><span id="local-6989586621679375639"><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375639"><span class="hs-identifier hs-var">stLens</span></a></span></span><span> </span><span id="local-6989586621679375638"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375638"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679375637"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679375637"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621679375636"><span class="annot"><span class="annottext">a -&gt; Text
</span><a href="#local-6989586621679375636"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span id="local-6989586621679375635"><span class="annot"><span class="annottext">[Text] -&gt; Maybe a
</span><a href="#local-6989586621679375635"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679375634"><span class="annot"><span class="annottext">[Text] -&gt; Widget n
</span><a href="#local-6989586621679375634"><span class="hs-identifier hs-var">renderText</span></a></span></span><span> </span><span id="local-6989586621679375633"><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375633"><span class="hs-identifier hs-var">wrapEditor</span></a></span></span><span> </span><span id="local-6989586621679375632"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375632"><span class="hs-identifier hs-var">initialState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-513"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375631"><span class="annot"><span class="annottext">initVal :: Editor Text n
</span><a href="#local-6989586621679375631"><span class="hs-identifier hs-var hs-var">initVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TextZipper Text -&gt; TextZipper Text)
-&gt; Editor Text n -&gt; Editor Text n
forall t n.
(TextZipper t -&gt; TextZipper t) -&gt; Editor t n -&gt; Editor t n
</span><a href="Brick.Widgets.Edit.html#applyEdit"><span class="hs-identifier hs-var">applyEdit</span></a></span><span> </span><span class="annot"><span class="annottext">TextZipper Text -&gt; TextZipper Text
</span><a href="#local-6989586621679375629"><span class="hs-identifier hs-var">gotoEnd</span></a></span><span> </span><span class="annot"><span class="annottext">(Editor Text n -&gt; Editor Text n) -&gt; Editor Text n -&gt; Editor Text n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-514"></span><span>                  </span><span class="annot"><span class="annottext">n -&gt; Maybe Int -&gt; Text -&gt; Editor Text n
forall a n.
GenericTextZipper a =&gt;
n -&gt; Maybe Int -&gt; a -&gt; Editor a n
</span><a href="Brick.Widgets.Edit.html#editor"><span class="hs-identifier hs-var">editor</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375638"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679375637"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375627"><span class="hs-identifier hs-var">initialText</span></a></span><span>
</span><span id="line-515"></span><span>        </span><span id="local-6989586621679375629"><span class="annot"><span class="annottext">gotoEnd :: TextZipper Text -&gt; TextZipper Text
</span><a href="#local-6989586621679375629"><span class="hs-identifier hs-var hs-var">gotoEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375626"><span class="annot"><span class="annottext">ls :: [Text]
</span><a href="#local-6989586621679375626"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.lines</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375627"><span class="hs-identifier hs-var">initialText</span></a></span><span>
</span><span id="line-516"></span><span>                      </span><span id="local-6989586621679375624"><span class="annot"><span class="annottext">pos :: (Int, Int)
</span><a href="#local-6989586621679375624"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679375626"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679375626"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679375626"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-518"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TextZipper Text -&gt; TextZipper Text
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-519"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; TextZipper Text -&gt; TextZipper Text
forall a. Monoid a =&gt; (Int, Int) -&gt; TextZipper a -&gt; TextZipper a
</span><span class="hs-identifier hs-var">Z.moveCursor</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679375624"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-520"></span><span>        </span><span id="local-6989586621679375627"><span class="annot"><span class="annottext">initialText :: Text
</span><a href="#local-6989586621679375627"><span class="hs-identifier hs-var hs-var">initialText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
</span><a href="#local-6989586621679375636"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Text) -&gt; a -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679375632"><span class="hs-identifier hs-var">initialState</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Getting a s a -&gt; a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting a s a
Lens' s a
</span><a href="#local-6989586621679375639"><span class="hs-identifier hs-var">stLens</span></a></span><span>
</span><span id="line-521"></span><span>        </span><span id="local-6989586621679375618"><span class="annot"><span class="annottext">handleEvent :: BrickEvent n e -&gt; Editor t n -&gt; EventM n (Editor t n)
</span><a href="#local-6989586621679375618"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span id="local-6989586621679375617"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679375617"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375616"><span class="annot"><span class="annottext">Editor t n
</span><a href="#local-6989586621679375616"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Editor t n -&gt; EventM n (Editor t n)
forall t n.
(DecodeUtf8 t, Eq t, Monoid t) =&gt;
Event -&gt; Editor t n -&gt; EventM n (Editor t n)
</span><a href="Brick.Widgets.Edit.html#handleEditorEvent"><span class="hs-identifier hs-var">handleEditorEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679375617"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Editor t n
</span><a href="#local-6989586621679375616"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-522"></span><span>        </span><span class="annot"><a href="#local-6989586621679375618"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375614"><span class="annot"><span class="annottext">Editor t n
</span><a href="#local-6989586621679375614"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Editor t n -&gt; EventM n (Editor t n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Editor t n
</span><a href="#local-6989586621679375614"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FormFieldState :: forall b s a e n.
b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldState :: Editor Text n
</span><a href="Brick.Forms.html#formFieldState"><span class="hs-identifier hs-var">formFieldState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Editor Text n
</span><a href="#local-6989586621679375631"><span class="hs-identifier hs-var">initVal</span></a></span><span>
</span><span id="line-525"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFields :: [FormField a (Editor Text n) e n]
</span><a href="Brick.Forms.html#formFields"><span class="hs-identifier hs-var">formFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">n
-&gt; (Editor Text n -&gt; Maybe a)
-&gt; Bool
-&gt; (Bool -&gt; Editor Text n -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; Editor Text n -&gt; EventM n (Editor Text n))
-&gt; FormField a (Editor Text n) e n
forall a b e n.
n
-&gt; (b -&gt; Maybe a)
-&gt; Bool
-&gt; (Bool -&gt; b -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; b -&gt; EventM n b)
-&gt; FormField a b e n
</span><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-var">FormField</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375638"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-526"></span><span>                                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Maybe a
</span><a href="#local-6989586621679375635"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Maybe a)
-&gt; (Editor Text n -&gt; [Text]) -&gt; Editor Text n -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Editor Text n -&gt; [Text]
forall t n. Monoid t =&gt; Editor t n -&gt; [t]
</span><a href="Brick.Widgets.Edit.html#getEditContents"><span class="hs-identifier hs-var">getEditContents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>                                                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-528"></span><span>                                                 </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679375612"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375612"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679375611"><span class="annot"><span class="annottext">Editor Text n
</span><a href="#local-6989586621679375611"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375633"><span class="hs-identifier hs-var">wrapEditor</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Widget n) -&gt; Bool -&gt; Editor Text n -&gt; Widget n
forall n t.
(Ord n, Show n, Monoid t, TextWidth t, GenericTextZipper t) =&gt;
([t] -&gt; Widget n) -&gt; Bool -&gt; Editor t n -&gt; Widget n
</span><a href="Brick.Widgets.Edit.html#renderEditor"><span class="hs-identifier hs-var">renderEditor</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Widget n
</span><a href="#local-6989586621679375634"><span class="hs-identifier hs-var">renderText</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375612"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Editor Text n
</span><a href="#local-6989586621679375611"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>                                                 </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; Editor Text n -&gt; EventM n (Editor Text n)
forall t n e n.
(DecodeUtf8 t, Eq t, Monoid t) =&gt;
BrickEvent n e -&gt; Editor t n -&gt; EventM n (Editor t n)
</span><a href="#local-6989586621679375618"><span class="hs-identifier hs-var">handleEvent</span></a></span><span>
</span><span id="line-530"></span><span>                                     </span><span class="hs-special">]</span><span>
</span><span id="line-531"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldLens :: Lens' s a
</span><a href="Brick.Forms.html#formFieldLens"><span class="hs-identifier hs-var">formFieldLens</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375639"><span class="hs-identifier hs-var">stLens</span></a></span><span>
</span><span id="line-532"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldUpdate :: a -&gt; Editor Text n -&gt; Editor Text n
</span><a href="Brick.Forms.html#formFieldUpdate"><span class="hs-identifier hs-var">formFieldUpdate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679375609"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375609"><span class="hs-identifier hs-var">newVal</span></a></span></span><span> </span><span id="local-6989586621679375608"><span class="annot"><span class="annottext">Editor Text n
</span><a href="#local-6989586621679375608"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-533"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375607"><span class="annot"><span class="annottext">newTxt :: Text
</span><a href="#local-6989586621679375607"><span class="hs-identifier hs-var hs-var">newTxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
</span><a href="#local-6989586621679375636"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375609"><span class="hs-identifier hs-var">newVal</span></a></span><span>
</span><span id="line-534"></span><span>                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375607"><span class="hs-identifier hs-var">newTxt</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unlines</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Editor Text n -&gt; [Text]
forall t n. Monoid t =&gt; Editor t n -&gt; [t]
</span><a href="Brick.Widgets.Edit.html#getEditContents"><span class="hs-identifier hs-var">getEditContents</span></a></span><span> </span><span class="annot"><span class="annottext">Editor Text n
</span><a href="#local-6989586621679375608"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Editor Text n
</span><a href="#local-6989586621679375608"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-536"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(TextZipper Text -&gt; TextZipper Text)
-&gt; Editor Text n -&gt; Editor Text n
forall t n.
(TextZipper t -&gt; TextZipper t) -&gt; Editor t n -&gt; Editor t n
</span><a href="Brick.Widgets.Edit.html#applyEdit"><span class="hs-identifier hs-var">applyEdit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; TextZipper Text -&gt; TextZipper Text
forall a. Monoid a =&gt; a -&gt; TextZipper a -&gt; TextZipper a
</span><span class="hs-identifier hs-var">Z.insertMany</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679375607"><span class="hs-identifier hs-var">newTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(TextZipper Text -&gt; TextZipper Text)
-&gt; (TextZipper Text -&gt; TextZipper Text)
-&gt; TextZipper Text
-&gt; TextZipper Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TextZipper Text -&gt; TextZipper Text
forall a. Monoid a =&gt; TextZipper a -&gt; TextZipper a
</span><span class="hs-identifier hs-var">Z.clearZipper</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Editor Text n
</span><a href="#local-6989586621679375608"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-537"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldRenderHelper :: Widget n -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldRenderHelper"><span class="hs-identifier hs-var">formFieldRenderHelper</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-538"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formFieldConcat :: [Widget n] -&gt; Widget n
</span><a href="Brick.Forms.html#formFieldConcat"><span class="hs-identifier hs-var">formFieldConcat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
forall n. [Widget n] -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#vBox"><span class="hs-identifier hs-var">vBox</span></a></span><span>
</span><span id="line-539"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">-- | A form field using a single-line editor to edit the 'Show'</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- representation of a state field value of type @a@. This automatically</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- uses its 'Read' instance to validate the input. This field is mostly</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- useful in cases where the user-facing representation of a value</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- matches the 'Show' representation exactly, such as with 'Int'.</span><span>
</span><span id="line-546"></span><span class="hs-comment">--</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- This field responds to all events handled by 'editor', including</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- mouse events.</span><span>
</span><span id="line-549"></span><span id="local-6989586621679375600"><span id="local-6989586621679375601"><span id="local-6989586621679375602"><span id="local-6989586621679375603"><span class="annot"><a href="Brick.Forms.html#editShowableField"><span class="hs-identifier hs-type">editShowableField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375603"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375603"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679375602"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375602"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375601"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375602"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-551"></span><span>                  </span><span class="hs-comment">-- ^ The state lens for this value.</span><span>
</span><span id="line-552"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375603"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-553"></span><span>                  </span><span class="hs-comment">-- ^ The resource name for the input field.</span><span>
</span><span id="line-554"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375601"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-555"></span><span>                  </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-556"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375601"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375600"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375603"><span class="hs-identifier hs-type">n</span></a></span></span></span></span></span><span>
</span><span id="line-557"></span><span id="editShowableField"><span class="annot"><span class="annottext">editShowableField :: Lens' s a -&gt; n -&gt; s -&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#editShowableField"><span class="hs-identifier hs-var hs-var">editShowableField</span></a></span></span><span> </span><span id="local-6989586621679375599"><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375599"><span class="hs-identifier hs-var">stLens</span></a></span></span><span> </span><span id="local-6989586621679375598"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375598"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375597"><span class="annot"><span class="annottext">ini :: a -&gt; Text
</span><a href="#local-6989586621679375597"><span class="hs-identifier hs-var hs-var">ini</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (a -&gt; String) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-559"></span><span>        </span><span id="local-6989586621679375594"><span class="annot"><span class="annottext">val :: [Text] -&gt; Maybe a
</span><a href="#local-6989586621679375594"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. Read a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe a) -&gt; ([Text] -&gt; String) -&gt; [Text] -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; ([Text] -&gt; Text) -&gt; [Text] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-560"></span><span>        </span><span id="local-6989586621679375591"><span class="annot"><span class="annottext">limit :: Maybe Int
</span><a href="#local-6989586621679375591"><span class="hs-identifier hs-var hs-var">limit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-561"></span><span>        </span><span id="local-6989586621679375590"><span class="annot"><span class="annottext">renderText :: [Text] -&gt; Widget n
</span><a href="#local-6989586621679375590"><span class="hs-identifier hs-var hs-var">renderText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Widget n) -&gt; ([Text] -&gt; Text) -&gt; [Text] -&gt; Widget n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unlines</span></span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Lens' s a
-&gt; n
-&gt; Maybe Int
-&gt; (a -&gt; Text)
-&gt; ([Text] -&gt; Maybe a)
-&gt; ([Text] -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n)
-&gt; s
-&gt; FormFieldState s e n
forall n s a e.
(Ord n, Show n) =&gt;
Lens' s a
-&gt; n
-&gt; Maybe Int
-&gt; (a -&gt; Text)
-&gt; ([Text] -&gt; Maybe a)
-&gt; ([Text] -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n)
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#editField"><span class="hs-identifier hs-var">editField</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375599"><span class="hs-identifier hs-var">stLens</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375598"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679375591"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
</span><a href="#local-6989586621679375597"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Maybe a
</span><a href="#local-6989586621679375594"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Widget n
forall n. [Text] -&gt; Widget n
</span><a href="#local-6989586621679375590"><span class="hs-identifier hs-var">renderText</span></a></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="hs-comment">-- | A form field using an editor to edit a text value. Since the value</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- is free-form text, it is always valid.</span><span>
</span><span id="line-566"></span><span class="hs-comment">--</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- This field responds to all events handled by 'editor', including</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- mouse events.</span><span>
</span><span id="line-569"></span><span id="local-6989586621679375587"><span id="local-6989586621679375588"><span id="local-6989586621679375589"><span class="annot"><a href="Brick.Forms.html#editTextField"><span class="hs-identifier hs-type">editTextField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375589"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375589"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375588"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-571"></span><span>              </span><span class="hs-comment">-- ^ The state lens for this value.</span><span>
</span><span id="line-572"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375589"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-573"></span><span>              </span><span class="hs-comment">-- ^ The resource name for the input field.</span><span>
</span><span id="line-574"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-575"></span><span>              </span><span class="hs-comment">-- ^ The optional line limit for the editor (see 'editor').</span><span>
</span><span id="line-576"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375588"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-577"></span><span>              </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-578"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375588"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375587"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375589"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-579"></span><span id="editTextField"><span class="annot"><span class="annottext">editTextField :: Lens' s Text -&gt; n -&gt; Maybe Int -&gt; s -&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#editTextField"><span class="hs-identifier hs-var hs-var">editTextField</span></a></span></span><span> </span><span id="local-6989586621679375586"><span class="annot"><span class="annottext">Lens' s Text
</span><a href="#local-6989586621679375586"><span class="hs-identifier hs-var">stLens</span></a></span></span><span> </span><span id="local-6989586621679375585"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375585"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679375584"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679375584"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-580"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375583"><span class="annot"><span class="annottext">ini :: a -&gt; a
</span><a href="#local-6989586621679375583"><span class="hs-identifier hs-var hs-var">ini</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-581"></span><span>        </span><span id="local-6989586621679375582"><span class="annot"><span class="annottext">val :: [Text] -&gt; Maybe Text
</span><a href="#local-6989586621679375582"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; ([Text] -&gt; Text) -&gt; [Text] -&gt; Maybe Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-582"></span><span>        </span><span id="local-6989586621679375581"><span class="annot"><span class="annottext">renderText :: [Text] -&gt; Widget n
</span><a href="#local-6989586621679375581"><span class="hs-identifier hs-var hs-var">renderText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Widget n
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Widget n) -&gt; ([Text] -&gt; Text) -&gt; [Text] -&gt; Widget n
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-583"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Lens' s Text
-&gt; n
-&gt; Maybe Int
-&gt; (Text -&gt; Text)
-&gt; ([Text] -&gt; Maybe Text)
-&gt; ([Text] -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n)
-&gt; s
-&gt; FormFieldState s e n
forall n s a e.
(Ord n, Show n) =&gt;
Lens' s a
-&gt; n
-&gt; Maybe Int
-&gt; (a -&gt; Text)
-&gt; ([Text] -&gt; Maybe a)
-&gt; ([Text] -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n)
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#editField"><span class="hs-identifier hs-var">editField</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' s Text
</span><a href="#local-6989586621679375586"><span class="hs-identifier hs-var">stLens</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375585"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679375584"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. a -&gt; a
</span><a href="#local-6989586621679375583"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Maybe Text
</span><a href="#local-6989586621679375582"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Widget n
forall n. [Text] -&gt; Widget n
</span><a href="#local-6989586621679375581"><span class="hs-identifier hs-var">renderText</span></a></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span class="hs-comment">-- | A form field using a single-line editor to edit a free-form text</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- value represented as a password. The value is always considered valid</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- and is always represented with one asterisk per password character.</span><span>
</span><span id="line-588"></span><span class="hs-comment">--</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- This field responds to all events handled by 'editor', including</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- mouse events.</span><span>
</span><span id="line-591"></span><span id="local-6989586621679375578"><span id="local-6989586621679375579"><span id="local-6989586621679375580"><span class="annot"><a href="Brick.Forms.html#editPasswordField"><span class="hs-identifier hs-type">editPasswordField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679375580"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679375580"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679375579"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-593"></span><span>                  </span><span class="hs-comment">-- ^ The state lens for this value.</span><span>
</span><span id="line-594"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375580"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-595"></span><span>                  </span><span class="hs-comment">-- ^ The resource name for the input field.</span><span>
</span><span id="line-596"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375579"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-597"></span><span>                  </span><span class="hs-comment">-- ^ The initial form state.</span><span>
</span><span id="line-598"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375579"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375578"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375580"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-599"></span><span id="editPasswordField"><span class="annot"><span class="annottext">editPasswordField :: Lens' s Text -&gt; n -&gt; s -&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#editPasswordField"><span class="hs-identifier hs-var hs-var">editPasswordField</span></a></span></span><span> </span><span id="local-6989586621679375577"><span class="annot"><span class="annottext">Lens' s Text
</span><a href="#local-6989586621679375577"><span class="hs-identifier hs-var">stLens</span></a></span></span><span> </span><span id="local-6989586621679375576"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375576"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375575"><span class="annot"><span class="annottext">ini :: a -&gt; a
</span><a href="#local-6989586621679375575"><span class="hs-identifier hs-var hs-var">ini</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-601"></span><span>        </span><span id="local-6989586621679375574"><span class="annot"><span class="annottext">val :: [Text] -&gt; Maybe Text
</span><a href="#local-6989586621679375574"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; ([Text] -&gt; Text) -&gt; [Text] -&gt; Maybe Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span>
</span><span id="line-602"></span><span>        </span><span id="local-6989586621679375572"><span class="annot"><span class="annottext">limit :: Maybe Int
</span><a href="#local-6989586621679375572"><span class="hs-identifier hs-var hs-var">limit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-603"></span><span>        </span><span id="local-6989586621679375571"><span class="annot"><span class="annottext">renderText :: [Text] -&gt; Widget a
</span><a href="#local-6989586621679375571"><span class="hs-identifier hs-var hs-var">renderText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Widget a
forall n. [Text] -&gt; Widget n
</span><a href="Brick.Forms.html#toPassword"><span class="hs-identifier hs-var">toPassword</span></a></span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Lens' s Text
-&gt; n
-&gt; Maybe Int
-&gt; (Text -&gt; Text)
-&gt; ([Text] -&gt; Maybe Text)
-&gt; ([Text] -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n)
-&gt; s
-&gt; FormFieldState s e n
forall n s a e.
(Ord n, Show n) =&gt;
Lens' s a
-&gt; n
-&gt; Maybe Int
-&gt; (a -&gt; Text)
-&gt; ([Text] -&gt; Maybe a)
-&gt; ([Text] -&gt; Widget n)
-&gt; (Widget n -&gt; Widget n)
-&gt; s
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#editField"><span class="hs-identifier hs-var">editField</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' s Text
</span><a href="#local-6989586621679375577"><span class="hs-identifier hs-var">stLens</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375576"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679375572"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. a -&gt; a
</span><a href="#local-6989586621679375575"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Maybe Text
</span><a href="#local-6989586621679375574"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Widget n
forall n. [Text] -&gt; Widget n
</span><a href="#local-6989586621679375571"><span class="hs-identifier hs-var">renderText</span></a></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span id="local-6989586621679375569"><span class="annot"><a href="Brick.Forms.html#toPassword"><span class="hs-identifier hs-type">toPassword</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375569"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-607"></span><span id="toPassword"><span class="annot"><span class="annottext">toPassword :: [Text] -&gt; Widget a
</span><a href="Brick.Forms.html#toPassword"><span class="hs-identifier hs-var hs-var">toPassword</span></a></span></span><span> </span><span id="local-6989586621679375568"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679375568"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Widget a
forall n. Text -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#txt"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Widget a) -&gt; Text -&gt; Widget a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Int) -&gt; Text -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679375568"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="hs-comment">-- | The namespace for the other form attributes.</span><span>
</span><span id="line-610"></span><span class="annot"><a href="Brick.Forms.html#formAttr"><span class="hs-identifier hs-type">formAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-611"></span><span id="formAttr"><span class="annot"><span class="annottext">formAttr :: AttrName
</span><a href="Brick.Forms.html#formAttr"><span class="hs-identifier hs-var hs-var">formAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;brickForm&quot;</span></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-comment">-- | The attribute for form input fields with invalid values.</span><span>
</span><span id="line-614"></span><span class="annot"><a href="Brick.Forms.html#invalidFormInputAttr"><span class="hs-identifier hs-type">invalidFormInputAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-615"></span><span id="invalidFormInputAttr"><span class="annot"><span class="annottext">invalidFormInputAttr :: AttrName
</span><a href="Brick.Forms.html#invalidFormInputAttr"><span class="hs-identifier hs-var hs-var">invalidFormInputAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Forms.html#formAttr"><span class="hs-identifier hs-var">formAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;invalidInput&quot;</span></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">-- | The attribute for form input fields that have the focus.</span><span>
</span><span id="line-618"></span><span class="annot"><a href="Brick.Forms.html#focusedFormInputAttr"><span class="hs-identifier hs-type">focusedFormInputAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.AttrMap.html#AttrName"><span class="hs-identifier hs-type">AttrName</span></a></span><span>
</span><span id="line-619"></span><span id="focusedFormInputAttr"><span class="annot"><span class="annottext">focusedFormInputAttr :: AttrName
</span><a href="Brick.Forms.html#focusedFormInputAttr"><span class="hs-identifier hs-var hs-var">focusedFormInputAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Forms.html#formAttr"><span class="hs-identifier hs-var">formAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; AttrName -&gt; AttrName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><span class="hs-string">&quot;focusedInput&quot;</span></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-comment">-- | Returns whether all form fields in the form currently have valid</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- values according to the fields' validation functions. This is useful</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- when we need to decide whether the form state is up to date with</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- respect to the form input fields.</span><span>
</span><span id="line-625"></span><span id="local-6989586621679375564"><span id="local-6989586621679375565"><span id="local-6989586621679375566"><span class="annot"><a href="Brick.Forms.html#allFieldsValid"><span class="hs-identifier hs-type">allFieldsValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375566"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375565"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375564"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-626"></span><span id="allFieldsValid"><span class="annot"><span class="annottext">allFieldsValid :: Form s e n -&gt; Bool
</span><a href="Brick.Forms.html#allFieldsValid"><span class="hs-identifier hs-var hs-var">allFieldsValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([n] -&gt; Bool) -&gt; (Form s e n -&gt; [n]) -&gt; Form s e n -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; [n]
forall s e n. Form s e n -&gt; [n]
</span><a href="Brick.Forms.html#invalidFields"><span class="hs-identifier hs-var">invalidFields</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-comment">-- | Returns the resource names associated with all form input fields</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- that currently have invalid inputs. This is useful when we need to</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- force the user to repair invalid inputs before moving on from a form</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- editing session.</span><span>
</span><span id="line-632"></span><span id="local-6989586621679375915"><span id="local-6989586621679375916"><span id="local-6989586621679375917"><span class="annot"><a href="Brick.Forms.html#invalidFields"><span class="hs-identifier hs-type">invalidFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375917"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375916"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375915"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679375915"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-633"></span><span id="invalidFields"><span class="annot"><span class="annottext">invalidFields :: Form s e n -&gt; [n]
</span><a href="Brick.Forms.html#invalidFields"><span class="hs-identifier hs-var hs-var">invalidFields</span></a></span></span><span> </span><span id="local-6989586621679375563"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375563"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[n]] -&gt; [n]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[n]] -&gt; [n]) -&gt; [[n]] -&gt; [n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n -&gt; [n]
forall s e n. FormFieldState s e n -&gt; [n]
</span><a href="Brick.Forms.html#getInvalidFields"><span class="hs-identifier hs-var">getInvalidFields</span></a></span><span> </span><span class="annot"><span class="annottext">(FormFieldState s e n -&gt; [n]) -&gt; [FormFieldState s e n] -&gt; [[n]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; [FormFieldState s e n]
forall s e n. Form s e n -&gt; [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var hs-var">formFieldStates</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375563"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-comment">-- | Manually indicate that a field has invalid contents. This can be</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- useful in situations where validation beyond the form element's</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- validator needs to be performed and the result of that validation</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- needs to be fed back into the form state.</span><span>
</span><span id="line-639"></span><span id="local-6989586621679375559"><span id="local-6989586621679375560"><span id="local-6989586621679375561"><span class="annot"><a href="Brick.Forms.html#setFieldValid"><span class="hs-identifier hs-type">setFieldValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375561"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-641"></span><span>              </span><span class="hs-comment">-- ^ Whether the field is considered valid.</span><span>
</span><span id="line-642"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375561"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-643"></span><span>              </span><span class="hs-comment">-- ^ The name of the form field to set as (in)valid.</span><span>
</span><span id="line-644"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375560"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375559"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375561"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-645"></span><span>              </span><span class="hs-comment">-- ^ The form to modify.</span><span>
</span><span id="line-646"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375560"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375559"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375561"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-647"></span><span id="setFieldValid"><span class="annot"><span class="annottext">setFieldValid :: Bool -&gt; n -&gt; Form s e n -&gt; Form s e n
</span><a href="Brick.Forms.html#setFieldValid"><span class="hs-identifier hs-var hs-var">setFieldValid</span></a></span></span><span> </span><span id="local-6989586621679375558"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375558"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679375557"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375557"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679375556"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375556"><span class="hs-identifier hs-var">form</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375555"><span class="annot"><span class="annottext">go1 :: [FormFieldState s e n] -&gt; [FormFieldState s e n]
</span><a href="#local-6989586621679375555"><span class="hs-identifier hs-var hs-var">go1</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-649"></span><span>        </span><span class="annot"><a href="#local-6989586621679375555"><span class="hs-identifier hs-var">go1</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375554"><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375554"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679375553"><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375553"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-650"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375552"><span class="annot"><span class="annottext">s' :: FormFieldState s e n
</span><a href="#local-6989586621679375552"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375554"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-651"></span><span>                       </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span id="local-6989586621679375551"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375551"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679375550"><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375550"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679375549"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679375549"><span class="hs-identifier hs-var">upd</span></a></span></span><span> </span><span id="local-6989586621679375548"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375548"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679375547"><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375547"><span class="hs-identifier hs-var">rh</span></a></span></span><span> </span><span id="local-6989586621679375546"><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375546"><span class="hs-identifier hs-var">concatAll</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-652"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375545"><span class="annot"><span class="annottext">go2 :: [FormField a b e n] -&gt; [FormField a b e n]
</span><a href="#local-6989586621679375545"><span class="hs-identifier hs-var hs-var">go2</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-653"></span><span>                               </span><span class="annot"><a href="#local-6989586621679375545"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375544"><span class="annot"><span class="annottext">f :: FormField a b e n
</span><a href="#local-6989586621679375544"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-type">FormField</span></a></span><span> </span><span id="local-6989586621679375543"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375543"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679375542"><span class="annot"><span class="annottext">b -&gt; Maybe a
</span><a href="#local-6989586621679375542"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375541"><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Widget n
</span><a href="#local-6989586621679375541"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679375540"><span class="annot"><span class="annottext">BrickEvent n e -&gt; b -&gt; EventM n b
</span><a href="#local-6989586621679375540"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679375539"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375539"><span class="hs-identifier hs-var">ff</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>                                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375557"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375543"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n
-&gt; (b -&gt; Maybe a)
-&gt; Bool
-&gt; (Bool -&gt; b -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; b -&gt; EventM n b)
-&gt; FormField a b e n
forall a b e n.
n
-&gt; (b -&gt; Maybe a)
-&gt; Bool
-&gt; (Bool -&gt; b -&gt; Widget n)
-&gt; (BrickEvent n e -&gt; b -&gt; EventM n b)
-&gt; FormField a b e n
</span><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-var">FormField</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375543"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe a
</span><a href="#local-6989586621679375542"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375558"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Widget n
</span><a href="#local-6989586621679375541"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; b -&gt; EventM n b
</span><a href="#local-6989586621679375540"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">FormField a b e n -&gt; [FormField a b e n] -&gt; [FormField a b e n]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375539"><span class="hs-identifier hs-var">ff</span></a></span><span>
</span><span id="line-655"></span><span>                                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormField a b e n
</span><a href="#local-6989586621679375544"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FormField a b e n -&gt; [FormField a b e n] -&gt; [FormField a b e n]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n] -&gt; [FormField a b e n]
</span><a href="#local-6989586621679375545"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375539"><span class="hs-identifier hs-var">ff</span></a></span><span>
</span><span id="line-656"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
forall b s a e n.
b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-var">FormFieldState</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375551"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375550"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679375549"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FormField a b e n] -&gt; [FormField a b e n]
</span><a href="#local-6989586621679375545"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375548"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375547"><span class="hs-identifier hs-var">rh</span></a></span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375546"><span class="hs-identifier hs-var">concatAll</span></a></span><span>
</span><span id="line-657"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375552"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
-&gt; [FormFieldState s e n] -&gt; [FormFieldState s e n]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n] -&gt; [FormFieldState s e n]
</span><a href="#local-6989586621679375555"><span class="hs-identifier hs-var">go1</span></a></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375553"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375556"><span class="hs-identifier hs-var">form</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldStates :: [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var">formFieldStates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n] -&gt; [FormFieldState s e n]
</span><a href="#local-6989586621679375555"><span class="hs-identifier hs-var">go1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; [FormFieldState s e n]
forall s e n. Form s e n -&gt; [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var hs-var">formFieldStates</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375556"><span class="hs-identifier hs-var">form</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span id="local-6989586621679375536"><span id="local-6989586621679375537"><span id="local-6989586621679375538"><span class="annot"><a href="Brick.Forms.html#getInvalidFields"><span class="hs-identifier hs-type">getInvalidFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375538"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375537"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375536"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679375536"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-662"></span><span id="getInvalidFields"><span class="annot"><span class="annottext">getInvalidFields :: FormFieldState s e n -&gt; [n]
</span><a href="Brick.Forms.html#getInvalidFields"><span class="hs-identifier hs-var hs-var">getInvalidFields</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span id="local-6989586621679375535"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375535"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375534"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375534"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375533"><span class="annot"><span class="annottext">gather :: FormField a b e n -&gt; [n]
</span><a href="#local-6989586621679375533"><span class="hs-identifier hs-var hs-var">gather</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-type">FormField</span></a></span><span> </span><span id="local-6989586621679375532"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375532"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679375531"><span class="annot"><span class="annottext">b -&gt; Maybe a
</span><a href="#local-6989586621679375531"><span class="hs-identifier hs-var">validate</span></a></span></span><span> </span><span id="local-6989586621679375530"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375530"><span class="hs-identifier hs-var">extValid</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Widget n
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; b -&gt; EventM n b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-664"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375530"><span class="hs-identifier hs-var">extValid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Bool) -&gt; Maybe a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe a
</span><a href="#local-6989586621679375531"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375535"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375532"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[[n]] -&gt; [n]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[n]] -&gt; [n]) -&gt; [[n]] -&gt; [n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FormField a b e n -&gt; [n]
</span><a href="#local-6989586621679375533"><span class="hs-identifier hs-var">gather</span></a></span><span> </span><span class="annot"><span class="annottext">(FormField a b e n -&gt; [n]) -&gt; [FormField a b e n] -&gt; [[n]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375534"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="hs-comment">-- | Render a form.</span><span>
</span><span id="line-668"></span><span class="hs-comment">--</span><span>
</span><span id="line-669"></span><span class="hs-comment">-- For each form field, each input for the field is rendered using</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- the implementation provided by its 'FormField'. The inputs are</span><span>
</span><span id="line-671"></span><span class="hs-comment">-- then concatenated with the field's concatenation function (see</span><span>
</span><span id="line-672"></span><span class="hs-comment">-- 'setFieldConcat') and are then augmented using the form field's</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- rendering augmentation function (see '@@='). Fields with invalid</span><span>
</span><span id="line-674"></span><span class="hs-comment">-- inputs (either due to built-in validator failure or due to external</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- validation failure via 'setFieldValid') will be displayed using the</span><span>
</span><span id="line-676"></span><span class="hs-comment">-- 'invalidFormInputAttr' attribute.</span><span>
</span><span id="line-677"></span><span class="hs-comment">--</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- Finally, all of the resulting field renderings are concatenated with</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- the form's concatenation function (see 'setFormConcat').</span><span>
</span><span id="line-680"></span><span id="local-6989586621679375526"><span id="local-6989586621679375527"><span id="local-6989586621679375528"><span class="annot"><a href="Brick.Forms.html#renderForm"><span class="hs-identifier hs-type">renderForm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375528"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375527"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375526"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375528"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375528"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-681"></span><span id="renderForm"><span class="annot"><span class="annottext">renderForm :: Form s e n -&gt; Widget n
</span><a href="Brick.Forms.html#renderForm"><span class="hs-identifier hs-var hs-var">renderForm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span id="local-6989586621679375525"><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375525"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679375524"><span class="annot"><span class="annottext">FocusRing n
</span><a href="#local-6989586621679375524"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375523"><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375523"><span class="hs-identifier hs-var">concatAll</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375523"><span class="hs-identifier hs-var">concatAll</span></a></span><span> </span><span class="annot"><span class="annottext">([Widget n] -&gt; Widget n) -&gt; [Widget n] -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; FormFieldState s e n -&gt; Widget n
forall n s e.
Eq n =&gt;
FocusRing n -&gt; FormFieldState s e n -&gt; Widget n
</span><a href="Brick.Forms.html#renderFormFieldState"><span class="hs-identifier hs-var">renderFormFieldState</span></a></span><span> </span><span class="annot"><span class="annottext">FocusRing n
</span><a href="#local-6989586621679375524"><span class="hs-identifier hs-var">fr</span></a></span><span> </span><span class="annot"><span class="annottext">(FormFieldState s e n -&gt; Widget n)
-&gt; [FormFieldState s e n] -&gt; [Widget n]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375525"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span class="hs-comment">-- | Render a single form field collection. This is called internally by</span><span>
</span><span id="line-685"></span><span class="hs-comment">-- 'renderForm' but is exposed in cases where a form field state needs</span><span>
</span><span id="line-686"></span><span class="hs-comment">-- to be rendered outside of a 'Form', so 'renderForm' is probably what</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- you want.</span><span>
</span><span id="line-688"></span><span id="local-6989586621679375895"><span id="local-6989586621679375896"><span id="local-6989586621679375897"><span class="annot"><a href="Brick.Forms.html#renderFormFieldState"><span class="hs-identifier hs-type">renderFormFieldState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375897"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Focus.html#FocusRing"><span class="hs-identifier hs-type">FocusRing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375897"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-690"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375896"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375895"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375897"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-691"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#Widget"><span class="hs-identifier hs-type">Widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375897"><span class="hs-identifier hs-type">n</span></a></span></span></span></span><span>
</span><span id="line-692"></span><span id="renderFormFieldState"><span class="annot"><span class="annottext">renderFormFieldState :: FocusRing n -&gt; FormFieldState s e n -&gt; Widget n
</span><a href="Brick.Forms.html#renderFormFieldState"><span class="hs-identifier hs-var hs-var">renderFormFieldState</span></a></span></span><span> </span><span id="local-6989586621679375522"><span class="annot"><span class="annottext">FocusRing n
</span><a href="#local-6989586621679375522"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span id="local-6989586621679375521"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375521"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375520"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375520"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679375519"><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375519"><span class="hs-identifier hs-var">helper</span></a></span></span><span> </span><span id="local-6989586621679375518"><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375518"><span class="hs-identifier hs-var">concatFields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-693"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375517"><span class="annot"><span class="annottext">renderFields :: [FormField a b e n] -&gt; [Widget n]
</span><a href="#local-6989586621679375517"><span class="hs-identifier hs-var hs-var">renderFields</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-694"></span><span>        </span><span class="annot"><a href="#local-6989586621679375517"><span class="hs-identifier hs-var">renderFields</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-type">FormField</span></a></span><span> </span><span id="local-6989586621679375516"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375516"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679375515"><span class="annot"><span class="annottext">b -&gt; Maybe a
</span><a href="#local-6989586621679375515"><span class="hs-identifier hs-var">validate</span></a></span></span><span> </span><span id="local-6989586621679375514"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375514"><span class="hs-identifier hs-var">extValid</span></a></span></span><span> </span><span id="local-6989586621679375513"><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Widget n
</span><a href="#local-6989586621679375513"><span class="hs-identifier hs-var">renderField</span></a></span></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; b -&gt; EventM n b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679375512"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375512"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-695"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375511"><span class="annot"><span class="annottext">maybeInvalid :: Widget n -&gt; Widget n
</span><a href="#local-6989586621679375511"><span class="hs-identifier hs-var hs-var">maybeInvalid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Bool) -&gt; Maybe a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe a
</span><a href="#local-6989586621679375515"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375521"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375514"><span class="hs-identifier hs-var">extValid</span></a></span><span>
</span><span id="line-696"></span><span>                               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-697"></span><span>                               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">AttrName -&gt; Widget n -&gt; Widget n
forall n. AttrName -&gt; Widget n -&gt; Widget n
</span><a href="Brick.Widgets.Core.html#forceAttr"><span class="hs-identifier hs-var">forceAttr</span></a></span><span> </span><span class="annot"><span class="annottext">AttrName
</span><a href="Brick.Forms.html#invalidFormInputAttr"><span class="hs-identifier hs-var">invalidFormInputAttr</span></a></span><span>
</span><span id="line-698"></span><span>                </span><span id="local-6989586621679375508"><span class="annot"><span class="annottext">foc :: Bool
</span><a href="#local-6989586621679375508"><span class="hs-identifier hs-var hs-var">foc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Maybe n
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375516"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe n -&gt; Maybe n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; Maybe n
forall n. FocusRing n -&gt; Maybe n
</span><a href="Brick.Focus.html#focusGetCurrent"><span class="hs-identifier hs-var">focusGetCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">FocusRing n
</span><a href="#local-6989586621679375522"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-699"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375511"><span class="hs-identifier hs-var">maybeInvalid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Widget n
</span><a href="#local-6989586621679375513"><span class="hs-identifier hs-var">renderField</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679375508"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375521"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; [Widget n] -&gt; [Widget n]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n] -&gt; [Widget n]
</span><a href="#local-6989586621679375517"><span class="hs-identifier hs-var">renderFields</span></a></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375512"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375519"><span class="hs-identifier hs-var">helper</span></a></span><span> </span><span class="annot"><span class="annottext">(Widget n -&gt; Widget n) -&gt; Widget n -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375518"><span class="hs-identifier hs-var">concatFields</span></a></span><span> </span><span class="annot"><span class="annottext">([Widget n] -&gt; Widget n) -&gt; [Widget n] -&gt; Widget n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n] -&gt; [Widget n]
</span><a href="#local-6989586621679375517"><span class="hs-identifier hs-var">renderFields</span></a></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375520"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="hs-comment">-- | Dispatch an event to the appropriate form field and return a new</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- form. This handles the following events in this order:</span><span>
</span><span id="line-704"></span><span class="hs-comment">--</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- * On @Tab@ keypresses, this changes the focus to the next field in</span><span>
</span><span id="line-706"></span><span class="hs-comment">--   the form.</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- * On @Shift-Tab@ keypresses, this changes the focus to the previous</span><span>
</span><span id="line-708"></span><span class="hs-comment">--   field in the form.</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- * On mouse button presses (regardless of button or modifier), the</span><span>
</span><span id="line-710"></span><span class="hs-comment">--   focus is changed to the clicked form field and the event is</span><span>
</span><span id="line-711"></span><span class="hs-comment">--   forwarded to the event handler for the clicked form field.</span><span>
</span><span id="line-712"></span><span class="hs-comment">-- * On @Left@ or @Up@, if the currently-focused field is part of a</span><span>
</span><span id="line-713"></span><span class="hs-comment">--   collection (e.g. radio buttons), the previous entry in the</span><span>
</span><span id="line-714"></span><span class="hs-comment">--   collection is focused.</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- * On @Right@ or @Down@, if the currently-focused field is part of a</span><span>
</span><span id="line-716"></span><span class="hs-comment">--   collection (e.g. radio buttons), the next entry in the collection</span><span>
</span><span id="line-717"></span><span class="hs-comment">--   is focused.</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- * All other events are forwarded to the currently focused form field.</span><span>
</span><span id="line-719"></span><span class="hs-comment">--</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- In all cases where an event is forwarded to a form field, validation</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- of the field's input state is performed immediately after the</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- event has been handled. If the form field's input state succeeds</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- validation using the field's validator function, its value is</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- immediately stored in the form state using the form field's state</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- lens. The external validation flag is ignored during this step to</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- ensure that external validators have a chance to get the intermediate</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- validated value.</span><span>
</span><span id="line-728"></span><span id="local-6989586621679375504"><span id="local-6989586621679375505"><span id="local-6989586621679375506"><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-type">handleFormEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375506"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Types.Internal.html#BrickEvent"><span class="hs-identifier hs-type">BrickEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375506"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375505"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375504"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375505"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375506"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375506"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375504"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375505"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375506"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-729"></span><span id="handleFormEvent"><span class="annot"><span class="annottext">handleFormEvent :: BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var hs-var">handleFormEvent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375503"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375503"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-730"></span><span>    </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375503"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; FocusRing n
forall n. FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusNext"><span class="hs-identifier hs-var">focusNext</span></a></span><span> </span><span class="annot"><span class="annottext">(FocusRing n -&gt; FocusRing n) -&gt; FocusRing n -&gt; FocusRing n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375503"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-731"></span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var">handleFormEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KBackTab</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375500"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375500"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-732"></span><span>    </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375500"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; FocusRing n
forall n. FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusPrev"><span class="hs-identifier hs-var">focusPrev</span></a></span><span> </span><span class="annot"><span class="annottext">(FocusRing n -&gt; FocusRing n) -&gt; FocusRing n -&gt; FocusRing n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375500"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-733"></span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var">handleFormEvent</span></a></span><span> </span><span id="local-6989586621679375498"><span class="annot"><span class="annottext">e :: BrickEvent n e
</span><a href="#local-6989586621679375498"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#MouseDown"><span class="hs-identifier hs-type">MouseDown</span></a></span><span> </span><span id="local-6989586621679375497"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375497"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Button
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Modifier]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Location
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375496"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375496"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-734"></span><span>    </span><span class="annot"><span class="annottext">n -&gt; BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
forall n e s.
Eq n =&gt;
n -&gt; BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#handleFormFieldEvent"><span class="hs-identifier hs-var">handleFormFieldEvent</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375497"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375498"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375496"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; FocusRing n -&gt; FocusRing n
forall n. Eq n =&gt; n -&gt; FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusSetCurrent"><span class="hs-identifier hs-var">focusSetCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375497"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375496"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-735"></span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var">handleFormEvent</span></a></span><span> </span><span id="local-6989586621679375494"><span class="annot"><span class="annottext">e :: BrickEvent n e
</span><a href="#local-6989586621679375494"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#MouseUp"><span class="hs-identifier hs-type">MouseUp</span></a></span><span> </span><span id="local-6989586621679375492"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375492"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Button
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Location
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375491"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375491"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-736"></span><span>    </span><span class="annot"><span class="annottext">n -&gt; BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
forall n e s.
Eq n =&gt;
n -&gt; BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#handleFormFieldEvent"><span class="hs-identifier hs-var">handleFormFieldEvent</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375492"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375494"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375491"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; FocusRing n -&gt; FocusRing n
forall n. Eq n =&gt; n -&gt; FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusSetCurrent"><span class="hs-identifier hs-var">focusSetCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375492"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375491"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-737"></span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var">handleFormEvent</span></a></span><span> </span><span id="local-6989586621679375490"><span class="annot"><span class="annottext">e :: BrickEvent n e
</span><a href="#local-6989586621679375490"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KUp</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375488"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375488"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-738"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; Maybe n
forall n. FocusRing n -&gt; Maybe n
</span><a href="Brick.Focus.html#focusGetCurrent"><span class="hs-identifier hs-var">focusGetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375488"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-739"></span><span>        </span><span class="annot"><span class="annottext">Maybe n
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375488"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-740"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375487"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375487"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-741"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; n -&gt; Maybe [n]
forall n s e. Eq n =&gt; Form s e n -&gt; n -&gt; Maybe [n]
</span><a href="Brick.Forms.html#getFocusGrouping"><span class="hs-identifier hs-var">getFocusGrouping</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375488"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375487"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-742"></span><span>                </span><span class="annot"><span class="annottext">Maybe [n]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
forall n e s.
Eq n =&gt;
BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#forwardToCurrent"><span class="hs-identifier hs-var">forwardToCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375490"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375488"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-743"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375484"><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375484"><span class="hs-identifier hs-var">grp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375488"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; FocusRing n -&gt; FocusRing n
forall n. Eq n =&gt; n -&gt; FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusSetCurrent"><span class="hs-identifier hs-var">focusSetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[n] -&gt; n -&gt; n
forall a. Eq a =&gt; [a] -&gt; a -&gt; a
</span><a href="Brick.Forms.html#entryBefore"><span class="hs-identifier hs-var">entryBefore</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375484"><span class="hs-identifier hs-var">grp</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375487"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375488"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-744"></span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var">handleFormEvent</span></a></span><span> </span><span id="local-6989586621679375482"><span class="annot"><span class="annottext">e :: BrickEvent n e
</span><a href="#local-6989586621679375482"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KDown</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375480"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375480"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-745"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; Maybe n
forall n. FocusRing n -&gt; Maybe n
</span><a href="Brick.Focus.html#focusGetCurrent"><span class="hs-identifier hs-var">focusGetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375480"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-746"></span><span>        </span><span class="annot"><span class="annottext">Maybe n
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375480"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-747"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375479"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375479"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-748"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; n -&gt; Maybe [n]
forall n s e. Eq n =&gt; Form s e n -&gt; n -&gt; Maybe [n]
</span><a href="Brick.Forms.html#getFocusGrouping"><span class="hs-identifier hs-var">getFocusGrouping</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375480"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375479"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-749"></span><span>                </span><span class="annot"><span class="annottext">Maybe [n]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
forall n e s.
Eq n =&gt;
BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#forwardToCurrent"><span class="hs-identifier hs-var">forwardToCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375482"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375480"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-750"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375478"><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375478"><span class="hs-identifier hs-var">grp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375480"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; FocusRing n -&gt; FocusRing n
forall n. Eq n =&gt; n -&gt; FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusSetCurrent"><span class="hs-identifier hs-var">focusSetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[n] -&gt; n -&gt; n
forall a. Eq a =&gt; [a] -&gt; a -&gt; a
</span><a href="Brick.Forms.html#entryAfter"><span class="hs-identifier hs-var">entryAfter</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375478"><span class="hs-identifier hs-var">grp</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375479"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375480"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-751"></span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var">handleFormEvent</span></a></span><span> </span><span id="local-6989586621679375476"><span class="annot"><span class="annottext">e :: BrickEvent n e
</span><a href="#local-6989586621679375476"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KLeft</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375474"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375474"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-752"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; Maybe n
forall n. FocusRing n -&gt; Maybe n
</span><a href="Brick.Focus.html#focusGetCurrent"><span class="hs-identifier hs-var">focusGetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375474"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-753"></span><span>        </span><span class="annot"><span class="annottext">Maybe n
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375474"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-754"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375473"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375473"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-755"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; n -&gt; Maybe [n]
forall n s e. Eq n =&gt; Form s e n -&gt; n -&gt; Maybe [n]
</span><a href="Brick.Forms.html#getFocusGrouping"><span class="hs-identifier hs-var">getFocusGrouping</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375474"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375473"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-756"></span><span>                </span><span class="annot"><span class="annottext">Maybe [n]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
forall n e s.
Eq n =&gt;
BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#forwardToCurrent"><span class="hs-identifier hs-var">forwardToCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375476"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375474"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-757"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375472"><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375472"><span class="hs-identifier hs-var">grp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375474"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; FocusRing n -&gt; FocusRing n
forall n. Eq n =&gt; n -&gt; FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusSetCurrent"><span class="hs-identifier hs-var">focusSetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[n] -&gt; n -&gt; n
forall a. Eq a =&gt; [a] -&gt; a -&gt; a
</span><a href="Brick.Forms.html#entryBefore"><span class="hs-identifier hs-var">entryBefore</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375472"><span class="hs-identifier hs-var">grp</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375473"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375474"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-758"></span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var">handleFormEvent</span></a></span><span> </span><span id="local-6989586621679375471"><span class="annot"><span class="annottext">e :: BrickEvent n e
</span><a href="#local-6989586621679375471"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Brick.Types.Internal.html#VtyEvent"><span class="hs-identifier hs-type">VtyEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EvKey</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier hs-var">KRight</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679375469"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375469"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-759"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; Maybe n
forall n. FocusRing n -&gt; Maybe n
</span><a href="Brick.Focus.html#focusGetCurrent"><span class="hs-identifier hs-var">focusGetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375469"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-760"></span><span>        </span><span class="annot"><span class="annottext">Maybe n
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375469"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-761"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375468"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375468"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-762"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; n -&gt; Maybe [n]
forall n s e. Eq n =&gt; Form s e n -&gt; n -&gt; Maybe [n]
</span><a href="Brick.Forms.html#getFocusGrouping"><span class="hs-identifier hs-var">getFocusGrouping</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375469"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375468"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-763"></span><span>                </span><span class="annot"><span class="annottext">Maybe [n]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
forall n e s.
Eq n =&gt;
BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#forwardToCurrent"><span class="hs-identifier hs-var">forwardToCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375471"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375469"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-764"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375467"><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375467"><span class="hs-identifier hs-var">grp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375469"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFocus :: FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var">formFocus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; FocusRing n -&gt; FocusRing n
forall n. Eq n =&gt; n -&gt; FocusRing n -&gt; FocusRing n
</span><a href="Brick.Focus.html#focusSetCurrent"><span class="hs-identifier hs-var">focusSetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[n] -&gt; n -&gt; n
forall a. Eq a =&gt; [a] -&gt; a -&gt; a
</span><a href="Brick.Forms.html#entryAfter"><span class="hs-identifier hs-var">entryAfter</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375467"><span class="hs-identifier hs-var">grp</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375468"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375469"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-765"></span><span class="annot"><a href="Brick.Forms.html#handleFormEvent"><span class="hs-identifier hs-var">handleFormEvent</span></a></span><span> </span><span id="local-6989586621679375466"><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375466"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679375465"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375465"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
forall n e s.
Eq n =&gt;
BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#forwardToCurrent"><span class="hs-identifier hs-var">forwardToCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375466"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375465"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-766"></span><span>
</span><span id="line-767"></span><span id="local-6989586621679375879"><span id="local-6989586621679375880"><span id="local-6989586621679375881"><span class="annot"><a href="Brick.Forms.html#getFocusGrouping"><span class="hs-identifier hs-type">getFocusGrouping</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375881"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375880"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375879"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375881"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375881"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679375881"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-768"></span><span id="getFocusGrouping"><span class="annot"><span class="annottext">getFocusGrouping :: Form s e n -&gt; n -&gt; Maybe [n]
</span><a href="Brick.Forms.html#getFocusGrouping"><span class="hs-identifier hs-var hs-var">getFocusGrouping</span></a></span></span><span> </span><span id="local-6989586621679375464"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375464"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679375463"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375463"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n] -&gt; Maybe [n]
</span><a href="#local-6989586621679375462"><span class="hs-identifier hs-var">findGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; [FormFieldState s e n]
forall s e n. Form s e n -&gt; [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var hs-var">formFieldStates</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375464"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-770"></span><span>        </span><span id="local-6989586621679375462"><span class="annot"><span class="annottext">findGroup :: [FormFieldState s e n] -&gt; Maybe [n]
</span><a href="#local-6989586621679375462"><span class="hs-identifier hs-var hs-var">findGroup</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [n]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-771"></span><span>        </span><span class="annot"><a href="#local-6989586621679375462"><span class="hs-identifier hs-var">findGroup</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375461"><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375461"><span class="hs-identifier hs-var">e</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679375460"><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375460"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-772"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375459"><span class="annot"><span class="annottext">ns :: [n]
</span><a href="#local-6989586621679375459"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n -&gt; [n]
forall s e n. FormFieldState s e n -&gt; [n]
</span><a href="Brick.Forms.html#formFieldNames"><span class="hs-identifier hs-var">formFieldNames</span></a></span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375461"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-773"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375463"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; [n] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375459"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[n] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375459"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-774"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; Maybe [n]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679375459"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-775"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n] -&gt; Maybe [n]
</span><a href="#local-6989586621679375462"><span class="hs-identifier hs-var">findGroup</span></a></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375460"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span id="local-6989586621679375456"><span class="annot"><a href="Brick.Forms.html#entryAfter"><span class="hs-identifier hs-type">entryAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679375456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375456"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375456"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-778"></span><span id="entryAfter"><span class="annot"><span class="annottext">entryAfter :: [a] -&gt; a -&gt; a
</span><a href="Brick.Forms.html#entryAfter"><span class="hs-identifier hs-var hs-var">entryAfter</span></a></span></span><span> </span><span id="local-6989586621679375455"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679375455"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679375454"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375454"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-779"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375453"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375453"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375454"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679375455"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-780"></span><span>        </span><span id="local-6989586621679375452"><span class="annot"><span class="annottext">i' :: Int
</span><a href="#local-6989586621679375452"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375453"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679375455"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375453"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-781"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679375455"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int -&gt; a
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375452"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span id="local-6989586621679375875"><span class="annot"><a href="Brick.Forms.html#entryBefore"><span class="hs-identifier hs-type">entryBefore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679375875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375875"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375875"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-784"></span><span id="entryBefore"><span class="annot"><span class="annottext">entryBefore :: [a] -&gt; a -&gt; a
</span><a href="Brick.Forms.html#entryBefore"><span class="hs-identifier hs-var hs-var">entryBefore</span></a></span></span><span> </span><span id="local-6989586621679375449"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679375449"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679375448"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375448"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-785"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375447"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375447"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375448"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679375449"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-786"></span><span>        </span><span id="local-6989586621679375446"><span class="annot"><span class="annottext">i' :: Int
</span><a href="#local-6989586621679375446"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375447"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679375449"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375447"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-787"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679375449"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int -&gt; a
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679375446"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span id="local-6989586621679375876"><span id="local-6989586621679375877"><span id="local-6989586621679375878"><span class="annot"><a href="Brick.Forms.html#forwardToCurrent"><span class="hs-identifier hs-type">forwardToCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375878"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Brick.Types.Internal.html#BrickEvent"><span class="hs-identifier hs-type">BrickEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375878"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375877"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375876"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375877"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375878"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375878"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375876"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375877"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375878"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-790"></span><span id="forwardToCurrent"><span class="annot"><span class="annottext">forwardToCurrent :: BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#forwardToCurrent"><span class="hs-identifier hs-var hs-var">forwardToCurrent</span></a></span></span><span> </span><span id="local-6989586621679375445"><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375445"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679375444"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375444"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-791"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FocusRing n -&gt; Maybe n
forall n. FocusRing n -&gt; Maybe n
</span><a href="Brick.Focus.html#focusGetCurrent"><span class="hs-identifier hs-var">focusGetCurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; FocusRing n
forall s e n. Form s e n -&gt; FocusRing n
</span><a href="Brick.Forms.html#formFocus"><span class="hs-identifier hs-var hs-var">formFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375444"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-792"></span><span>        </span><span class="annot"><span class="annottext">Maybe n
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375444"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-793"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375443"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375443"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">n -&gt; BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
forall n e s.
Eq n =&gt;
n -&gt; BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#handleFormFieldEvent"><span class="hs-identifier hs-var">handleFormFieldEvent</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375443"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375445"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375444"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span id="local-6989586621679375882"><span id="local-6989586621679375883"><span id="local-6989586621679375884"><span class="annot"><a href="Brick.Forms.html#handleFormFieldEvent"><span class="hs-identifier hs-type">handleFormFieldEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679375884"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679375884"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.Internal.html#BrickEvent"><span class="hs-identifier hs-type">BrickEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375884"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375883"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375883"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375884"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Brick.Types.html#EventM"><span class="hs-identifier hs-type">EventM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375884"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Brick.Forms.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375883"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679375884"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-796"></span><span id="handleFormFieldEvent"><span class="annot"><span class="annottext">handleFormFieldEvent :: n -&gt; BrickEvent n e -&gt; Form s e n -&gt; EventM n (Form s e n)
</span><a href="Brick.Forms.html#handleFormFieldEvent"><span class="hs-identifier hs-var hs-var">handleFormFieldEvent</span></a></span></span><span> </span><span id="local-6989586621679375442"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375442"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679375441"><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375441"><span class="hs-identifier hs-var">ev</span></a></span></span><span> </span><span id="local-6989586621679375440"><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375440"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
-&gt; [FormFieldState s e n] -&gt; EventM n (Form s e n)
</span><a href="#local-6989586621679375439"><span class="hs-identifier hs-var">findFieldState</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form s e n -&gt; [FormFieldState s e n]
forall s e n. Form s e n -&gt; [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var hs-var">formFieldStates</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375440"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-798"></span><span>        </span><span id="local-6989586621679375439"><span class="annot"><span class="annottext">findFieldState :: [FormFieldState s e n]
-&gt; [FormFieldState s e n] -&gt; EventM n (Form s e n)
</span><a href="#local-6989586621679375439"><span class="hs-identifier hs-var hs-var">findFieldState</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375440"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-799"></span><span>        </span><span class="annot"><a href="#local-6989586621679375439"><span class="hs-identifier hs-var">findFieldState</span></a></span><span> </span><span id="local-6989586621679375438"><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375438"><span class="hs-identifier hs-var">prev</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375437"><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375437"><span class="hs-identifier hs-var">e</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679375436"><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375436"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-800"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375437"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-801"></span><span>                </span><span class="annot"><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-type">FormFieldState</span></a></span><span> </span><span id="local-6989586621679375435"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375435"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679375434"><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375434"><span class="hs-identifier hs-var">stLens</span></a></span></span><span> </span><span id="local-6989586621679375433"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679375433"><span class="hs-identifier hs-var">upd</span></a></span></span><span> </span><span id="local-6989586621679375432"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375432"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679375431"><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375431"><span class="hs-identifier hs-var">helper</span></a></span></span><span> </span><span id="local-6989586621679375430"><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375430"><span class="hs-identifier hs-var">concatAll</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-802"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375429"><span class="annot"><span class="annottext">findField :: [FormField a b e n] -&gt; EventM n (Maybe (b, Maybe a))
</span><a href="#local-6989586621679375429"><span class="hs-identifier hs-var hs-var">findField</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (b, Maybe a) -&gt; EventM n (Maybe (b, Maybe a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (b, Maybe a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-803"></span><span>                        </span><span class="annot"><a href="#local-6989586621679375429"><span class="hs-identifier hs-var">findField</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375428"><span class="annot"><span class="annottext">FormField a b e n
</span><a href="#local-6989586621679375428"><span class="hs-identifier hs-var">field</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679375427"><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375427"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-804"></span><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FormField a b e n
</span><a href="#local-6989586621679375428"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-805"></span><span>                                </span><span class="annot"><a href="Brick.Forms.html#FormField"><span class="hs-identifier hs-type">FormField</span></a></span><span> </span><span id="local-6989586621679375426"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375426"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679375425"><span class="annot"><span class="annottext">b -&gt; Maybe a
</span><a href="#local-6989586621679375425"><span class="hs-identifier hs-var">validate</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Widget n
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679375424"><span class="annot"><span class="annottext">BrickEvent n e -&gt; b -&gt; EventM n b
</span><a href="#local-6989586621679375424"><span class="hs-identifier hs-var">handleFunc</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375442"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679375426"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-806"></span><span>                                    </span><span id="local-6989586621679375423"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375423"><span class="hs-identifier hs-var">nextSt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BrickEvent n e -&gt; b -&gt; EventM n b
</span><a href="#local-6989586621679375424"><span class="hs-identifier hs-var">handleFunc</span></a></span><span> </span><span class="annot"><span class="annottext">BrickEvent n e
</span><a href="#local-6989586621679375441"><span class="hs-identifier hs-var">ev</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375435"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-807"></span><span>                                    </span><span class="hs-comment">-- If the new state validates, go ahead and update</span><span>
</span><span id="line-808"></span><span>                                    </span><span class="hs-comment">-- the form state with it.</span><span>
</span><span id="line-809"></span><span>                                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe a
</span><a href="#local-6989586621679375425"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375423"><span class="hs-identifier hs-var">nextSt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-810"></span><span>                                        </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (b, Maybe a) -&gt; EventM n (Maybe (b, Maybe a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (b, Maybe a) -&gt; EventM n (Maybe (b, Maybe a)))
-&gt; Maybe (b, Maybe a) -&gt; EventM n (Maybe (b, Maybe a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(b, Maybe a) -&gt; Maybe (b, Maybe a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375423"><span class="hs-identifier hs-var">nextSt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-811"></span><span>                                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375422"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375422"><span class="hs-identifier hs-var">newSt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (b, Maybe a) -&gt; EventM n (Maybe (b, Maybe a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (b, Maybe a) -&gt; EventM n (Maybe (b, Maybe a)))
-&gt; Maybe (b, Maybe a) -&gt; EventM n (Maybe (b, Maybe a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(b, Maybe a) -&gt; Maybe (b, Maybe a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375423"><span class="hs-identifier hs-var">nextSt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375422"><span class="hs-identifier hs-var">newSt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>                                </span><span class="annot"><span class="annottext">FormField a b e n
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FormField a b e n] -&gt; EventM n (Maybe (b, Maybe a))
</span><a href="#local-6989586621679375429"><span class="hs-identifier hs-var">findField</span></a></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375427"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span>                    </span><span id="local-6989586621679375421"><span class="annot"><span class="annottext">Maybe (b, Maybe a)
</span><a href="#local-6989586621679375421"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FormField a b e n] -&gt; EventM n (Maybe (b, Maybe a))
</span><a href="#local-6989586621679375429"><span class="hs-identifier hs-var">findField</span></a></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375432"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-815"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (b, Maybe a)
</span><a href="#local-6989586621679375421"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-816"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (b, Maybe a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
-&gt; [FormFieldState s e n] -&gt; EventM n (Form s e n)
</span><a href="#local-6989586621679375439"><span class="hs-identifier hs-var">findFieldState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375438"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
-&gt; [FormFieldState s e n] -&gt; [FormFieldState s e n]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375437"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375436"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-817"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679375420"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375420"><span class="hs-identifier hs-var">newSt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679375419"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679375419"><span class="hs-identifier hs-var">maybeSt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-818"></span><span>                            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679375418"><span class="annot"><span class="annottext">newFieldState :: FormFieldState s e n
</span><a href="#local-6989586621679375418"><span class="hs-identifier hs-var hs-var">newFieldState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
forall b s a e n.
b
-&gt; Lens' s a
-&gt; (a -&gt; b -&gt; b)
-&gt; [FormField a b e n]
-&gt; (Widget n -&gt; Widget n)
-&gt; ([Widget n] -&gt; Widget n)
-&gt; FormFieldState s e n
</span><a href="Brick.Forms.html#FormFieldState"><span class="hs-identifier hs-var">FormFieldState</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679375420"><span class="hs-identifier hs-var">newSt</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' s a
</span><a href="#local-6989586621679375434"><span class="hs-identifier hs-var">stLens</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679375433"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="annot"><span class="annottext">[FormField a b e n]
</span><a href="#local-6989586621679375432"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">Widget n -&gt; Widget n
</span><a href="#local-6989586621679375431"><span class="hs-identifier hs-var">helper</span></a></span><span> </span><span class="annot"><span class="annottext">[Widget n] -&gt; Widget n
</span><a href="#local-6989586621679375430"><span class="hs-identifier hs-var">concatAll</span></a></span><span>
</span><span id="line-819"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; EventM n (Form s e n)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Form s e n -&gt; EventM n (Form s e n))
-&gt; Form s e n -&gt; EventM n (Form s e n)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">formFieldStates :: [FormFieldState s e n]
</span><a href="Brick.Forms.html#formFieldStates"><span class="hs-identifier hs-var">formFieldStates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375438"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
-&gt; [FormFieldState s e n] -&gt; [FormFieldState s e n]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FormFieldState s e n
</span><a href="#local-6989586621679375418"><span class="hs-identifier hs-var">newFieldState</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
-&gt; [FormFieldState s e n] -&gt; [FormFieldState s e n]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FormFieldState s e n]
</span><a href="#local-6989586621679375436"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-820"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">formState :: s
</span><a href="Brick.Forms.html#formState"><span class="hs-identifier hs-var">formState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679375419"><span class="hs-identifier hs-var">maybeSt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-821"></span><span>                                              </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; s
forall s e n. Form s e n -&gt; s
</span><a href="Brick.Forms.html#formState"><span class="hs-identifier hs-var hs-var">formState</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375440"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-822"></span><span>                                              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679375417"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375417"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form s e n -&gt; s
forall s e n. Form s e n -&gt; s
</span><a href="Brick.Forms.html#formState"><span class="hs-identifier hs-var hs-var">formState</span></a></span><span> </span><span class="annot"><span class="annottext">Form s e n
</span><a href="#local-6989586621679375440"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; (s -&gt; s) -&gt; s
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Identity a) -&gt; s -&gt; Identity s
Lens' s a
</span><a href="#local-6989586621679375434"><span class="hs-identifier hs-var">stLens</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Identity a) -&gt; s -&gt; Identity s) -&gt; a -&gt; s -&gt; s
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679375417"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-823"></span><span>                                          </span><span class="hs-special">}</span><span>
</span><span id="line-824"></span></pre></body></html>